var e,t=Object.defineProperty,s=(e,s,a)=>((e,s,a)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a)(e,"symbol"!=typeof s?s+"":s,a);import{j as a,H as i,T as r,G as n,W as l,E as c,m as o,C as d,I as x,a as m,b as h,c as u,X as p,M as b,P as f,d as g,e as j,f as N,g as v,S as y,A as w,F as k,Z as S,h as C,i as _,k as T,U as z,l as A,n as M,o as B,p as F,q as P,L as I,r as E,s as $,B as D,t as L,u as R,v as Z,w as W,x as O,y as q,z as U,D as H,J as Q,K as G,N as Y,O as V,Q as J,R as X,V as K,Y as ee,_ as te,$ as se,a0 as ae,a1 as ie,a2 as re,a3 as ne,a4 as le,a5 as ce}from"./ui-BrYeodSK.js";import{a as oe,u as de,N as xe,b as me,r as he,g as ue,R as pe,O as be,L as fe,c as ge,d as je,e as Ne,f as ve,h as ye,B as we}from"./vendor-DOY1bdJT.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ke={},Se=oe;ke.createRoot=Se.createRoot,ke.hydrateRoot=Se.hydrateRoot;const Ce=new class{constructor(){var e;this.tg=null==(e=window.Telegram)?void 0:e.WebApp,this.isAvailable=!!this.tg}get webApp(){return this.tg}get initData(){var e;return(null==(e=this.tg)?void 0:e.initData)||""}get initDataUnsafe(){var e;return(null==(e=this.tg)?void 0:e.initDataUnsafe)||{}}get user(){return this.initDataUnsafe.user||null}get startParam(){return this.initDataUnsafe.start_param||null}get colorScheme(){var e;return(null==(e=this.tg)?void 0:e.colorScheme)||"dark"}get themeParams(){var e;return(null==(e=this.tg)?void 0:e.themeParams)||{}}get platform(){var e;return(null==(e=this.tg)?void 0:e.platform)||"unknown"}get version(){var e;return(null==(e=this.tg)?void 0:e.version)||"6.0"}get viewportHeight(){var e;return(null==(e=this.tg)?void 0:e.viewportHeight)||window.innerHeight}get viewportStableHeight(){var e;return(null==(e=this.tg)?void 0:e.viewportStableHeight)||window.innerHeight}get isExpanded(){var e;return(null==(e=this.tg)?void 0:e.isExpanded)||!1}ready(){var e;null==(e=this.tg)||e.ready()}expand(){var e;null==(e=this.tg)||e.expand()}close(){var e;null==(e=this.tg)||e.close()}showMainButton(e,t,s={}){var a;if(!(null==(a=this.tg)?void 0:a.MainButton))return;const i=this.tg.MainButton;i.setText(e),s.color&&i.setParams({color:s.color}),s.textColor&&i.setParams({text_color:s.textColor}),i.offClick(t),i.onClick(t),!1!==s.isActive?i.enable():i.disable(),s.isLoading?i.showProgress():i.hideProgress(),i.show()}hideMainButton(){var e,t;null==(t=null==(e=this.tg)?void 0:e.MainButton)||t.hide()}setMainButtonLoading(e){var t,s,a,i;e?null==(s=null==(t=this.tg)?void 0:t.MainButton)||s.showProgress():null==(i=null==(a=this.tg)?void 0:a.MainButton)||i.hideProgress()}showBackButton(e){var t;(null==(t=this.tg)?void 0:t.BackButton)&&(this.tg.BackButton.onClick(e),this.tg.BackButton.show())}hideBackButton(){var e,t;null==(t=null==(e=this.tg)?void 0:e.BackButton)||t.hide()}hapticImpact(e="medium"){var t,s;null==(s=null==(t=this.tg)?void 0:t.HapticFeedback)||s.impactOccurred(e)}hapticNotification(e="success"){var t,s;null==(s=null==(t=this.tg)?void 0:t.HapticFeedback)||s.notificationOccurred(e)}hapticSelection(){var e,t;null==(t=null==(e=this.tg)?void 0:e.HapticFeedback)||t.selectionChanged()}showAlert(e,t){var s;(null==(s=this.tg)?void 0:s.showAlert)?this.tg.showAlert(e,t):(alert(e),null==t||t())}showConfirm(e,t){var s;if(null==(s=this.tg)?void 0:s.showConfirm)this.tg.showConfirm(e,t);else{const s=confirm(e);null==t||t(s)}}showPopup(e,t){var s;(null==(s=this.tg)?void 0:s.showPopup)&&this.tg.showPopup(e,t)}openLink(e,t={}){var s;(null==(s=this.tg)?void 0:s.openLink)?this.tg.openLink(e,t):window.open(e,"_blank")}openTelegramLink(e){var t;(null==(t=this.tg)?void 0:t.openTelegramLink)?this.tg.openTelegramLink(e):window.open(e,"_blank")}shareUrl(e,t=""){const s=`https://t.me/share/url?url=${encodeURIComponent(e)}&text=${encodeURIComponent(t)}`;this.openTelegramLink(s)}async readClipboard(){var e;return(null==(e=this.tg)?void 0:e.readTextFromClipboard)?new Promise(e=>{this.tg.readTextFromClipboard(e)}):navigator.clipboard.readText()}async writeClipboard(e){return navigator.clipboard.writeText(e)}showQRScanner(e,t){var s;(null==(s=this.tg)?void 0:s.showScanQrPopup)&&this.tg.showScanQrPopup({text:e},t)}closeQRScanner(){var e;null==(e=this.tg)||e.closeScanQrPopup()}setHeaderColor(e){var t;null==(t=this.tg)||t.setHeaderColor(e)}setBackgroundColor(e){var t;null==(t=this.tg)||t.setBackgroundColor(e)}async getStorageItem(e){var t;return(null==(t=this.tg)?void 0:t.CloudStorage)?new Promise(t=>{this.tg.CloudStorage.getItem(e,(e,s)=>{t(e?null:s)})}):null}async setStorageItem(e,t){var s;return!!(null==(s=this.tg)?void 0:s.CloudStorage)&&new Promise(s=>{this.tg.CloudStorage.setItem(e,t,e=>{s(!e)})})}async removeStorageItem(e){var t;return!!(null==(t=this.tg)?void 0:t.CloudStorage)&&new Promise(t=>{this.tg.CloudStorage.removeItem(e,e=>{t(!e)})})}get isBiometricAvailable(){var e,t,s,a;return(null==(t=null==(e=this.tg)?void 0:e.BiometricManager)?void 0:t.isInited)&&(null==(a=null==(s=this.tg)?void 0:s.BiometricManager)?void 0:a.isBiometricAvailable)}async requestBiometric(){var e;return!!(null==(e=this.tg)?void 0:e.BiometricManager)&&new Promise(e=>{this.tg.BiometricManager.authenticate({reason:"Confirm your identity"},t=>{e(t)})})}onEvent(e,t){var s;null==(s=this.tg)||s.onEvent(e,t)}offEvent(e,t){var s;null==(s=this.tg)||s.offEvent(e,t)}openInvoice(e,t){var s;(null==(s=this.tg)?void 0:s.openInvoice)&&this.tg.openInvoice(e,t)}showSettingsButton(e){var t;(null==(t=this.tg)?void 0:t.SettingsButton)&&(this.tg.SettingsButton.onClick(e),this.tg.SettingsButton.show())}hideSettingsButton(){var e,t;null==(t=null==(e=this.tg)?void 0:e.SettingsButton)||t.hide()}},_e=[{id:"home",path:"/",icon:i,label:"Home"},{id:"predict",path:"/predict",icon:r,label:"Predict"},{id:"earn",path:"/earn",icon:n,label:"Earn"},{id:"wallet",path:"/wallet",icon:l,label:"Wallet"},{id:"more",path:"/more",icon:c,label:"More"}];function Te(){const e=de(),t=()=>{Ce.hapticSelection()};return a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-dark-900/95 backdrop-blur-lg border-t border-white/5 z-50",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:a.jsx("div",{className:"flex items-center justify-around h-16 max-w-lg mx-auto px-2",children:_e.map(s=>{const i="/"===(r=s.path)?"/"===e.pathname:e.pathname.startsWith(r);var r;const n=s.icon;return a.jsxs(xe,{to:s.path,onClick:t,className:"relative flex flex-col items-center justify-center w-16 h-full",children:[i&&a.jsx(o.div,{layoutId:"navIndicator",className:"absolute -top-0.5 w-8 h-1 bg-mint-gradient rounded-full",transition:{type:"spring",stiffness:500,damping:30}}),a.jsx(o.div,{animate:{scale:i?1.1:1,y:i?-2:0},transition:{type:"spring",stiffness:400,damping:25},children:a.jsx(n,{size:22,className:"transition-colors duration-200 "+(i?"text-white":"text-dark-400"),strokeWidth:i?2.5:2})}),a.jsx("span",{className:"text-2xs mt-1 font-medium transition-colors duration-200 "+(i?"text-white":"text-dark-400"),children:s.label})]},s.id)})})})}function ze({title:e,showBack:t=!0,rightAction:s,className:i=""}){const r=me();return a.jsx("header",{className:`fixed top-0 left-0 right-0 z-40 bg-dark-950/95 backdrop-blur-lg border-b border-white/5 safe-top ${i}`,children:a.jsxs("div",{className:"flex items-center justify-between h-14 px-4",children:[a.jsx("div",{className:"w-10",children:t&&a.jsx(o.button,{whileTap:{scale:.9},onClick:()=>{Ce.hapticImpact("light"),r(-1)},className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-white/5 transition-colors",children:a.jsx(d,{size:24,className:"text-white"})})}),a.jsx(o.h1,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-lg font-semibold text-white",children:e}),a.jsx("div",{className:"w-10 flex justify-end",children:s})]})})}const Ae={},Me=e=>{let t;const s=new Set,a=(e,a)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=a?a:"object"!=typeof i||null===i)?i:Object.assign({},t,i),s.forEach(s=>s(t,e))}},i=()=>t,r={setState:a,getState:i,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{"production"!==(Ae?"production":void 0)&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},n=t=e(a,i,r);return r};var Be={exports:{}},Fe={},Pe={exports:{}},Ie={},Ee=he;var $e="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},De=Ee.useState,Le=Ee.useEffect,Re=Ee.useLayoutEffect,Ze=Ee.useDebugValue;function We(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!$e(e,s)}catch(a){return!0}}var Oe="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=De({inst:{value:s,getSnapshot:t}}),i=a[0].inst,r=a[1];return Re(function(){i.value=s,i.getSnapshot=t,We(i)&&r({inst:i})},[e,s,t]),Le(function(){return We(i)&&r({inst:i}),e(function(){We(i)&&r({inst:i})})},[e]),Ze(s),s};Ie.useSyncExternalStore=void 0!==Ee.useSyncExternalStore?Ee.useSyncExternalStore:Oe,Pe.exports=Ie;var qe=Pe.exports,Ue=he,He=qe;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qe="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Ge=He.useSyncExternalStore,Ye=Ue.useRef,Ve=Ue.useEffect,Je=Ue.useMemo,Xe=Ue.useDebugValue;Fe.useSyncExternalStoreWithSelector=function(e,t,s,a,i){var r=Ye(null);if(null===r.current){var n={hasValue:!1,value:null};r.current=n}else n=r.current;r=Je(function(){function e(e){if(!c){if(c=!0,r=e,e=a(e),void 0!==i&&n.hasValue){var t=n.value;if(i(t,e))return l=t}return l=e}if(t=l,Qe(r,e))return t;var s=a(e);return void 0!==i&&i(t,s)?(r=e,t):(r=e,l=s)}var r,l,c=!1,o=void 0===s?null:s;return[function(){return e(t())},null===o?void 0:function(){return e(o())}]},[t,s,a,i]);var l=Ge(e,r[0],r[1]);return Ve(function(){n.hasValue=!0,n.value=l},[l]),Xe(l),l},Be.exports=Fe;const Ke=ue(Be.exports),et={},{useDebugValue:tt}=pe,{useSyncExternalStoreWithSelector:st}=Ke;let at=!1;const it=e=>e;const rt=e=>{"production"!==(et?"production":void 0)&&"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?Me(e):Me)(e):e,s=(e,s)=>function(e,t=it,s){"production"!==(et?"production":void 0)&&s&&!at&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),at=!0);const a=st(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return tt(a),a}(t,e,s);return Object.assign(s,t),s},nt=e=>e?rt(e):rt,lt=nt((e,t)=>({modal:{isOpen:!1,type:null,props:{}},toasts:[],isGlobalLoading:!1,bottomSheet:{isOpen:!1,content:null},isTabBarVisible:!0,openModal:(t,s={})=>{e({modal:{isOpen:!0,type:t,props:s}})},closeModal:()=>{e({modal:{isOpen:!1,type:null,props:{}}})},showToast:(s,a="info",i=3e3)=>{const r=Date.now(),n={id:r,message:s,type:a,duration:i};return e({toasts:[...t().toasts,n]}),i>0&&setTimeout(()=>{t().removeToast(r)},i),r},removeToast:s=>{e({toasts:t().toasts.filter(e=>e.id!==s)})},clearToasts:()=>{e({toasts:[]})},setGlobalLoading:t=>{e({isGlobalLoading:t})},openBottomSheet:t=>{e({bottomSheet:{isOpen:!0,content:t}})},closeBottomSheet:()=>{e({bottomSheet:{isOpen:!1,content:null}})},setTabBarVisible:t=>{e({isTabBarVisible:t})},celebration:null,showCelebration:(t,s={})=>{e({celebration:{type:t,data:s}}),setTimeout(()=>{e({celebration:null})},3e3)},clearCelebration:()=>{e({celebration:null})}})),ct={success:u,error:h,warning:m,info:x},ot={success:"bg-success/20 border-success/30 text-success",error:"bg-danger/20 border-danger/30 text-danger",warning:"bg-warning/20 border-warning/30 text-warning",info:"bg-mint-500/20 border-mint-500/30 text-mint-400"};function dt({toast:e}){const{removeToast:t}=lt(),s=ct[e.type]||ct.info,i=ot[e.type]||ot.info;return a.jsxs(o.div,{initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.95},className:`\n        pointer-events-auto flex items-center gap-3 px-4 py-3 \n        rounded-xl border backdrop-blur-lg\n        ${i}\n      `,children:[a.jsx(s,{size:20,className:"flex-shrink-0"}),a.jsx("p",{className:"flex-1 text-sm font-medium text-white",children:e.message}),a.jsx("button",{onClick:()=>t(e.id),className:"flex-shrink-0 p-1 hover:bg-white/10 rounded-full transition-colors",children:a.jsx(p,{size:16})})]})}const xt=new class{constructor(){this.baseUrl="https://api.mintiq.world",this.token=null}setToken(e){this.token=e}clearToken(){this.token=null}async request(e,t={}){const s=`${this.baseUrl}${e}`,a={"Content-Type":"application/json",...t.headers};this.token&&(a.Authorization=`Bearer ${this.token}`);try{const e=await fetch(s,{...t,headers:a}),i=e.headers.get("content-type");if(!i||!i.includes("application/json")){if(!e.ok)throw new Error("HTTP "+e.status+": "+e.statusText);return null}const r=await e.json();if(!e.ok)throw new Error(r.error||r.message||"HTTP "+e.status);return r}catch(i){throw console.error("API Error ["+e+"]:",i),i}}get(e,t={}){const s=new URLSearchParams(t).toString(),a=s?`${e}?${s}`:e;return this.request(a,{method:"GET"})}post(e,t={}){return this.request(e,{method:"POST",body:JSON.stringify(t)})}put(e,t={}){return this.request(e,{method:"PUT",body:JSON.stringify(t)})}delete(e){return this.request(e,{method:"DELETE"})}async authenticate(e){return this.post("/api/miniapp/auth",{initData:e})}async getProfile(){return this.get("/api/miniapp/user/profile")}async getBalance(){return this.get("/api/miniapp/user/balance")}async getStats(){return this.get("/api/miniapp/user/stats")}async updateSettings(e){return this.put("/api/miniapp/user/settings",e)}async getTransactions(e={}){return this.get("/api/miniapp/user/transactions",e)}async getQuests(e={}){return this.get("/api/miniapp/quests",e)}async getQuestById(e){return this.get(`/api/miniapp/quests/${e}`)}async placeBet(e,t){return this.post(`/api/miniapp/quests/${e}/bet`,t)}async getMyPredictions(e={}){return this.get("/api/miniapp/predictions",e)}async getDailyReward(){return this.get("/api/miniapp/earn/daily")}async claimDailyReward(){return this.post("/api/miniapp/earn/daily/claim")}async spinWheel(){return this.post("/api/miniapp/earn/spin")}async getTasks(){return this.get("/api/miniapp/earn/tasks")}async startTask(e){return this.post(`/api/miniapp/earn/tasks/${e}/start`)}async verifyTask(e,t={}){return this.post(`/api/miniapp/earn/tasks/${e}/verify`,t)}async watchAd(){return this.post("/api/miniapp/earn/watch-ad")}async getFriends(){return this.get("/api/miniapp/friends")}async getFriendRequests(){return this.get("/api/miniapp/friends/requests")}async addFriend(e){return this.post("/api/miniapp/friends/add",{username:e})}async acceptFriend(e){return this.post(`/api/miniapp/friends/${e}/accept`)}async declineFriend(e){return this.post(`/api/miniapp/friends/${e}/decline`)}async removeFriend(e){return this.delete(`/api/miniapp/friends/${e}`)}async getChallenges(e={}){return this.get("/api/miniapp/challenges",e)}async createChallenge(e){return this.post("/api/miniapp/challenges",e)}async acceptChallenge(e){return this.post(`/api/miniapp/challenges/${e}/accept`)}async declineChallenge(e){return this.post(`/api/miniapp/challenges/${e}/decline`)}async getGroups(){return this.get("/api/miniapp/groups")}async createGroup(e){return this.post("/api/miniapp/groups",e)}async getGroupById(e){return this.get(`/api/miniapp/groups/${e}`)}async joinGroup(e){return this.post("/api/miniapp/groups/join",{inviteCode:e})}async leaveGroup(e){return this.post(`/api/miniapp/groups/${e}/leave`)}async getGroupQuests(e){return this.get(`/api/miniapp/groups/${e}/quests`)}async createGroupQuest(e,t){return this.post(`/api/miniapp/groups/${e}/quests`,t)}async resolveGroupQuest(e,t,s){return this.post(`/api/miniapp/groups/${e}/quests/${t}/resolve`,s)}async getVaultStatus(){return this.get("/api/miniapp/vault")}async getRedemptionInfo(){return this.get("/api/redemption/info")}async requestRedemption(e){return this.post("/api/redemption/request",e)}async getLeaderboard(e="global",t={}){return this.get(`/api/miniapp/leaderboard/${e}`,t)}async getShopItems(){return this.get("/api/miniapp/shop/items")}async purchaseItem(e){return this.post(`/api/miniapp/shop/purchase/${e}`)}async getBoosters(){return this.get("/api/miniapp/shop/boosters")}async activateBooster(e){return this.post(`/api/miniapp/shop/boosters/${e}/activate`)}};function mt(e){return e?{...e,tier:e.status_tier||e.tier||"novice",satz_balance:Number(e.satz_balance)||0,total_earned:Number(e.total_earned)||0,total_spent:Number(e.total_spent)||0,total_won:Number(e.total_won)||0,predictions_made:Number(e.predictions_made)||0,predictions_won:Number(e.predictions_won)||0,win_rate:Number(e.win_rate)||0,current_streak:Number(e.current_streak)||0,best_streak:Number(e.best_streak)||0,tier_points:Number(e.tier_points)||0,referral_count:Number(e.referral_count)||0}:null}const ht=nt((e,t)=>({user:null,isLoading:!1,error:null,lastFetch:null,get balance(){var e;return(null==(e=t().user)?void 0:e.satz_balance)||0},fetchUser:async(s=!1)=>{const a=t().lastFetch;if(!s&&a&&Date.now()-a<3e4)return t().user;e({isLoading:!0,error:null});try{0;const t=await xt.getProfile(),s=mt(t.user||t);return e({user:s,isLoading:!1,lastFetch:Date.now()}),s}catch(i){throw console.error("Fetch user error:",i),e({error:i.message,isLoading:!1}),i}},updateBalance:s=>{const a=t().user;a&&e({user:{...a,satz_balance:Number(s)||0}})},addBalance:s=>{const a=t().user;a&&e({user:{...a,satz_balance:(Number(a.satz_balance)||0)+(Number(s)||0),total_earned:(Number(a.total_earned)||0)+(Number(s)||0)}})},deductBalance:s=>{const a=t().user;a&&e({user:{...a,satz_balance:Math.max(0,(Number(a.satz_balance)||0)-(Number(s)||0)),total_spent:(Number(a.total_spent)||0)+(Number(s)||0)}})},updateStreak:s=>{const a=t().user;a&&e({user:{...a,current_streak:Number(s)||0,best_streak:Math.max(Number(a.best_streak)||0,Number(s)||0)}})},updateUser:s=>{const a=t().user;a&&e({user:mt({...a,...s})})},clearUser:()=>e({user:null,lastFetch:null}),clearError:()=>e({error:null}),refreshUser:async()=>t().fetchUser(!0)})),ut=(new Date(Date.now()+1728e5).toISOString(),new Date(Date.now()+2592e5).toISOString(),new Date(Date.now()+72e6).toISOString(),new Date(Date.now()+864e5).toISOString(),new Date(Date.now()+288e5).toISOString(),new Date(Date.now()+432e5).toISOString(),nt((e,t)=>({quests:[],currentQuest:null,myPredictions:[],isLoading:!1,error:null,filters:{category:"all",status:"active",sort:"deadline"},fetchQuests:async(s={})=>{e({isLoading:!0,error:null});try{const a={...t().filters,...s};0;const i=await xt.getQuests(a);return e({quests:i.quests||i,isLoading:!1}),i.quests||i}catch(a){throw console.error("Fetch quests error:",a),e({error:a.message,isLoading:!1}),a}},fetchQuestById:async t=>{e({isLoading:!0,error:null});try{0;const s=await xt.getQuestById(t);return e({currentQuest:s.quest||s,isLoading:!1}),s.quest||s}catch(s){throw console.error("Fetch quest error:",s),e({error:s.message,isLoading:!1}),s}},placeBet:async(s,a,i)=>{e({isLoading:!0,error:null});try{const r=await xt.placeBet(s,{option:a,amount:i}),n=t().quests.map(e=>e.id===s?{...e,[`pool_${a}`]:e[`pool_${a}`]+i,total_pool:e.total_pool+i,participant_count:e.participant_count+1}:e);return e({quests:n,isLoading:!1}),r}catch(r){throw console.error("Place bet error:",r),e({error:r.message,isLoading:!1}),r}},fetchMyPredictions:async(t={})=>{e({isLoading:!0,error:null});try{const s=await xt.getMyPredictions(t);return e({myPredictions:s.predictions||s,isLoading:!1}),s.predictions||s}catch(s){throw console.error("Fetch predictions error:",s),e({error:s.message,isLoading:!1}),s}},setFilters:s=>{e({filters:{...t().filters,...s}})},clearCurrentQuest:()=>{e({currentQuest:null})},clearError:()=>{e({error:null})}})));function pt(e,t=0){return null==e||isNaN(e)?"0":Number(e).toLocaleString("en-US",{minimumFractionDigits:t,maximumFractionDigits:t})}function bt(e){return null==e||isNaN(e)?"0":pt(e)}function ft(e){if(null==e||isNaN(e))return"0";const t=Math.abs(e);return t>=1e9?(e/1e9).toFixed(1)+"B":t>=1e6?(e/1e6).toFixed(1)+"M":t>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}let gt=1e5;function jt(e){e&&!isNaN(e)&&e>0&&(gt=e)}function Nt(e,t=gt){if(!e||isNaN(e))return 0;return e/1e8*t}function vt(e){return null==e||isNaN(e)?"$0.00":e<.01?`$${e.toFixed(4)}`:e<1?`$${e.toFixed(3)}`:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}function yt(e,t=gt){if(!e||isNaN(e))return"0 SATZ ($0.00)";const s=Nt(e,t);return`${pt(e)} SATZ (${vt(s)})`}function wt(e,t=gt){return vt(Nt(e,t))}const kt=5e4;function St(e){const t=Number(e)||0,s=Math.min(100,t/kt*100),a=Math.max(0,kt-t);return{current:t,target:kt,percentage:s,remaining:a,canWithdraw:t>=kt,remainingUsd:Nt(a)}}function Ct(e){const t=Number(e)||0,s=[{satz:1e3,label:"$1"},{satz:5e3,label:"$5"},{satz:1e4,label:"$10"},{satz:25e3,label:"$25"},{satz:5e4,label:"withdrawal"}];for(const a of s)if(t<a.satz){return`${pt(a.satz-t)} SATZ to ${a.label}!`}return"Ready to withdraw!"}function _t(e){if(!e)return"N/A";const t=new Date(e).getTime()-Date.now();if(t<=0)return"Ended";const s=Math.floor(t/864e5),a=Math.floor(t%864e5/36e5),i=Math.floor(t%36e5/6e4);return s>0?`${s}d ${a}h`:a>0?`${a}h ${i}m`:`${i}m`}function Tt(e){if(!e)return"N/A";const t=Date.now()-new Date(e).getTime(),s=Math.floor(t/1e3),a=Math.floor(s/60),i=Math.floor(a/60),r=Math.floor(i/24);return s<60?"Just now":a<60?`${a}m ago`:i<24?`${i}h ago`:r<7?`${r}d ago`:new Date(e).toLocaleDateString()}function zt(e,t){const s=Number(e)||0,a=Number(t)||0,i=s+a;return 0===i?{a:50,b:50}:{a:Math.round(s/i*100),b:Math.round(a/i*100)}}function At(e,t,s=.1){const a=Number(e)||0,i=Number(t)||0;if(0===a)return 1;const r=(a+i)*(1-s)/a;return isNaN(r)||!isFinite(r)?1:Math.min(r,1e3)}function Mt(e,t,s,a=.1){const i=Number(e)||0,r=Number(t)||0,n=Number(s)||0;if(0===i)return 0;const l=Math.floor((r+i+n)*(1-a)*(i/(r+i)));return isNaN(l)?i:l}const Bt={newcomer:{name:"Newcomer",color:"#9CA3AF",emoji:"üå±",points:0,multiplier:1},stacker:{name:"Stacker",color:"#22C55E",emoji:"üì¶",points:1e3,multiplier:1.1},hodler:{name:"Hodler",color:"#3B82F6",emoji:"üíé",points:5e3,multiplier:1.2},whale:{name:"Whale",color:"#8B5CF6",emoji:"üêã",points:15e3,multiplier:1.3},satoshi:{name:"Satoshi",color:"#F59E0B",emoji:"‚ö°",points:5e4,multiplier:1.5},nakamoto:{name:"Nakamoto",color:"#EF4444",emoji:"üëë",points:15e4,multiplier:2}};function Ft(e){if(!e)return Bt.newcomer;const t=e.toLowerCase();return Bt[t]||Bt.newcomer}function Pt(e){return!!e&&[/^1[a-km-zA-HJ-NP-Z1-9]{25,34}$/,/^3[a-km-zA-HJ-NP-Z1-9]{25,34}$/,/^bc1[a-zA-HJ-NP-Z0-9]{39,59}$/].some(t=>t.test(e))}async function It(e){try{return await navigator.clipboard.writeText(e),!0}catch{return!1}}function Et(e){return{crypto:"ü™ô",sports:"‚öΩ",politics:"üèõÔ∏è",entertainment:"üé¨",finance:"üìà"}[e]||"üéØ"}const $t=10,Dt=5e4,Lt=50,Rt=[100,500,1e3,5e3];const Zt={bet:function({quest:e,option:t,onClose:s}){const{user:i,deductBalance:r}=ht(),{placeBet:n}=ut(),{showToast:l,showCelebration:c}=lt(),[d,x]=he.useState(100),[m,h]=he.useState(!1),u=(null==i?void 0:i.satz_balance)||0,p=Math.max(0,u-Lt),j=(null==e?void 0:e.pool_a)||0,N=(null==e?void 0:e.pool_b)||0,v=Mt(d,"a"===t?j:N,"a"===t?N:j),y=v>0?(v/d).toFixed(2):"0.00",w=zt(j,N),k="a"===t?w.a:w.b,S="a"===t?null==e?void 0:e.option_a:null==e?void 0:e.option_b,C=e=>{Ce.hapticSelection();const t=Math.max($t,Math.min(p,e));x(t)},_=e=>{C(d+e)};return a.jsxs("div",{className:"p-6 pt-8",children:[a.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:"Place Your Bet"}),a.jsx("p",{className:"text-dark-400 text-sm mb-6 line-clamp-2",children:null==e?void 0:e.title}),a.jsx("div",{className:"p-4 rounded-xl mb-6 "+("a"===t?"bg-mint-500/20 border border-mint-500/30":"bg-danger/20 border border-danger/30"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-dark-400 text-xs mb-1",children:"Your prediction"}),a.jsx("p",{className:"text-white font-semibold",children:S})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-dark-400 text-xs mb-1",children:"Current odds"}),a.jsxs("p",{className:"font-bold "+("a"===t?"text-mint-400":"text-danger"),children:[k,"%"]})]})]})}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-dark-400 text-sm",children:"Bet amount"}),a.jsxs("button",{onClick:()=>{Ce.hapticImpact("medium"),C(p)},className:"text-mint-400 text-sm font-medium",children:["Max: ",bt(p)]})]}),a.jsxs("div",{className:"flex items-center gap-3 bg-dark-800 rounded-xl p-2",children:[a.jsx(o.button,{whileTap:{scale:.9},onClick:()=>_(-100),disabled:d<=$t,className:"w-10 h-10 flex items-center justify-center rounded-lg bg-dark-700 disabled:opacity-50",children:a.jsx(b,{size:18,className:"text-white"})}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx("span",{className:"text-2xl font-bold text-white",children:bt(d)}),a.jsx("span",{className:"text-dark-400 ml-1",children:"SATZ"})]}),a.jsx(o.button,{whileTap:{scale:.9},onClick:()=>_(100),disabled:d>=p,className:"w-10 h-10 flex items-center justify-center rounded-lg bg-dark-700 disabled:opacity-50",children:a.jsx(f,{size:18,className:"text-white"})})]})]}),a.jsx("div",{className:"flex gap-2 mb-6",children:Rt.map(e=>a.jsx("button",{onClick:()=>(e=>{Ce.hapticImpact("light"),C(e)})(e),disabled:e>p,className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all "+(d===e?"bg-mint-500 text-white":"bg-dark-700 text-dark-300 hover:bg-dark-600 disabled:opacity-50"),children:bt(e)},e))}),a.jsx("div",{className:"bg-dark-800 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(g,{size:18,className:"text-success"}),a.jsx("span",{className:"text-dark-400",children:"Potential win"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-xl font-bold text-success",children:[bt(v)," SATZ"]}),a.jsxs("p",{className:"text-dark-400 text-sm",children:[y,"x multiplier"]})]})]})}),a.jsx(o.button,{whileTap:{scale:.97},onClick:async()=>{if(d<$t)l(`Minimum bet is ${$t} SATZ`,"error");else if(d>p)l("Insufficient balance","error");else{h(!0),Ce.hapticImpact("medium");try{await n(e.id,t,d),r(d),Ce.hapticNotification("success"),l("Bet placed! Good luck! üçÄ","success"),s()}catch(a){Ce.hapticNotification("error"),l(a.message||"Failed to place bet","error")}finally{h(!1)}}},disabled:m||d<$t||d>p,className:"btn-primary w-full",children:m?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(o.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full"}),"Placing bet..."]}):`Bet ${bt(d)} SATZ`}),a.jsxs("p",{className:"text-center text-dark-400 text-sm mt-3",children:["Balance after bet: ",bt(u-d)," SATZ"]})]})},confirm:function({title:e="Confirm",message:t,confirmText:s="Confirm",cancelText:i="Cancel",confirmVariant:r="primary",onConfirm:n,onClose:l,icon:c}){return a.jsxs("div",{className:"p-6 pt-12",children:[a.jsx("div",{className:"flex justify-center mb-4",children:c||a.jsx("div",{className:"w-16 h-16 rounded-full bg-warning/20 flex items-center justify-center",children:a.jsx(j,{size:32,className:"text-warning"})})}),a.jsx("h3",{className:"text-xl font-bold text-white text-center mb-2",children:e}),a.jsx("p",{className:"text-dark-400 text-center mb-6",children:t}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:l,className:"btn-secondary flex-1",children:i}),a.jsx(o.button,{whileTap:{scale:.97},onClick:()=>{null==n||n(),l()},className:`${{primary:"btn-primary",danger:"btn-danger",gold:"btn-gold"}[r]} flex-1`,children:s})]})]})},result:function({isWin:e,amount:t,questTitle:s,option:i,onClose:r,onShare:n}){return a.jsxs("div",{className:"p-6 pt-8 text-center",children:[a.jsx(o.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:10,stiffness:200},className:"w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center "+(e?"bg-success/20":"bg-danger/20"),children:e?a.jsx(N,{size:40,className:"text-success"}):a.jsx(v,{size:40,className:"text-danger"})}),a.jsx(o.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-2xl font-bold mb-2 "+(e?"text-success":"text-danger"),children:e?"You Won! üéâ":"Better Luck Next Time"}),a.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-4",children:a.jsxs("p",{className:"text-3xl font-bold "+(e?"text-gradient-gold":"text-dark-400"),children:[e?"+":"-",bt(t)," SATZ"]})}),a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-dark-800 rounded-xl p-4 mb-6",children:[a.jsx("p",{className:"text-dark-400 text-sm mb-1",children:"Prediction"}),a.jsx("p",{className:"text-white font-medium line-clamp-2",children:s}),a.jsxs("p",{className:"text-dark-400 text-sm mt-2",children:["Your answer: ",i]})]}),a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"flex gap-3",children:[a.jsx("button",{onClick:r,className:"btn-secondary flex-1",children:"Close"}),a.jsxs("button",{onClick:()=>{if(Ce.hapticImpact("light"),n)n();else{const a=e?`üéâ I just won ${bt(t)} SATZ on MintIQ!\n\nPrediction: "${s}"\n\nJoin and earn real Bitcoin! üöÄ`:"üò§ Just lost a prediction on MintIQ. Time for revenge!\n\nJoin me and let's stack SATZ together! üí™";Ce.shareUrl("https://t.me/MintIQBot",a)}r()},className:"btn-primary flex-1",children:[a.jsx(y,{size:18}),"Share"]})]})]})}};function Wt({type:e,props:t}){const{closeModal:s}=lt(),i=()=>{Ce.hapticImpact("light"),s()},r=Zt[e];return r?a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e=>{e.target===e.currentTarget&&i()},className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm",children:a.jsxs(o.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"relative w-full max-w-lg bg-dark-850 rounded-t-3xl sm:rounded-3xl border border-white/10 max-h-[90vh] overflow-hidden",children:[a.jsx("button",{onClick:i,className:"absolute top-4 right-4 z-10 w-8 h-8 flex items-center justify-center rounded-full bg-white/5 hover:bg-white/10 transition-colors",children:a.jsx(p,{size:18,className:"text-dark-400"})}),a.jsx(r,{...t,onClose:i})]})}):(console.warn(`Unknown modal type: ${e}`),null)}var Ot={};!function e(t,s,a,i){var r=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),n="function"==typeof Path2D&&"function"==typeof DOMMatrix;function l(){}function c(e){var a=s.exports.Promise,i=void 0!==a?a:t.Promise;return"function"==typeof i?new i(e):(e(l,l),null)}var o,d,x,m,h,u,p=function(e,t){return{transform:function(s){if(e)return s;if(t.has(s))return t.get(s);var a=new OffscreenCanvas(s.width,s.height);return a.getContext("2d").drawImage(s,0,0),t.set(s,a),a},clear:function(){t.clear()}}}(function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),s=e.getContext("2d");s.fillRect(0,0,1,1);var a=e.transferToImageBitmap();s.createPattern(a,"no-repeat")}catch(i){return!1}return!0}(),new Map),b=(x=Math.floor(1e3/60),m={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(o=function(e){var t=Math.random();return m[t]=requestAnimationFrame(function s(a){h===a||h+x-1<a?(h=a,delete m[t],e()):m[t]=requestAnimationFrame(s)}),t},d=function(e){m[e]&&cancelAnimationFrame(m[e])}):(o=function(e){return setTimeout(e,x)},d=function(e){return clearTimeout(e)}),{frame:o,cancel:d}),f=function(){var t,s,i={};return function(){if(t)return t;if(!a&&r){var n=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([n])))}catch(l){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("üéä Could not load worker",l),null}!function(e){function t(t,s){e.postMessage({options:t||{},callback:s})}e.init=function(t){var s=t.transferControlToOffscreen();e.postMessage({canvas:s},[s])},e.fire=function(a,r,n){if(s)return t(a,null),s;var l=Math.random().toString(36).slice(2);return s=c(function(r){function c(t){t.data.callback===l&&(delete i[l],e.removeEventListener("message",c),s=null,p.clear(),n(),r())}e.addEventListener("message",c),t(a,l),i[l]=c.bind(null,{data:{callback:l}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),i)i[t](),delete i[t]}}(t)}return t}}(),g={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function j(e,t,s){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:g[t],s)}function N(e){return e<0?0:Math.floor(e)}function v(e,t){return Math.floor(Math.random()*(t-e))+e}function y(e){return parseInt(e,16)}function w(e){return e.map(k)}function k(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:y(t.substring(0,2)),g:y(t.substring(2,4)),b:y(t.substring(4,6))}}function S(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function C(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function _(e){var t=e.angle*(Math.PI/180),s=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*s-Math.random()*s),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function T(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var s=t.tick++/t.totalTicks,a=t.x+t.random*t.tiltCos,i=t.y+t.random*t.tiltSin,r=t.wobbleX+t.random*t.tiltCos,l=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-s)+")",e.beginPath(),n&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,s,a,i,r,n){var l=new Path2D(e),c=new Path2D;c.addPath(l,new DOMMatrix(t));var o=new Path2D;return o.addPath(c,new DOMMatrix([Math.cos(n)*i,Math.sin(n)*i,-Math.sin(n)*r,Math.cos(n)*r,s,a])),o}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(r-a),.1*Math.abs(l-i),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var c=Math.PI/10*t.wobble,o=.1*Math.abs(r-a),d=.1*Math.abs(l-i),x=t.shape.bitmap.width*t.scalar,m=t.shape.bitmap.height*t.scalar,h=new DOMMatrix([Math.cos(c)*o,Math.sin(c)*o,-Math.sin(c)*d,Math.cos(c)*d,t.x,t.y]);h.multiplySelf(new DOMMatrix(t.shape.matrix));var u=e.createPattern(p.transform(t.shape.bitmap),"no-repeat");u.setTransform(h),e.globalAlpha=1-s,e.fillStyle=u,e.fillRect(t.x-x/2,t.y-m/2,x,m),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(r-a)*t.ovalScalar,Math.abs(l-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,s,a,i,r,n,l,c){e.save(),e.translate(t,s),e.rotate(r),e.scale(a,i),e.arc(0,0,1,n,l,c),e.restore()}(e,t.x,t.y,Math.abs(r-a)*t.ovalScalar,Math.abs(l-i)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var b=Math.PI/2*3,f=4*t.scalar,g=8*t.scalar,j=t.x,N=t.y,v=5,y=Math.PI/v;v--;)j=t.x+Math.cos(b)*g,N=t.y+Math.sin(b)*g,e.lineTo(j,N),b+=y,j=t.x+Math.cos(b)*f,N=t.y+Math.sin(b)*f,e.lineTo(j,N),b+=y;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(i)),e.lineTo(Math.floor(r),Math.floor(l)),e.lineTo(Math.floor(a),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function z(e,s){var n,l=!e,o=!!j(s||{},"resize"),d=!1,x=j(s,"disableForReducedMotion",Boolean),m=r&&!!j(s||{},"useWorker")?f():null,h=l?S:C,u=!(!e||!m)&&!!e.__confetti_initialized,g="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function y(t,s,r){for(var l=j(t,"particleCount",N),o=j(t,"angle",Number),d=j(t,"spread",Number),x=j(t,"startVelocity",Number),m=j(t,"decay",Number),u=j(t,"gravity",Number),f=j(t,"drift",Number),g=j(t,"colors",w),y=j(t,"ticks",Number),k=j(t,"shapes"),S=j(t,"scalar"),C=!!j(t,"flat"),z=function(e){var t=j(e,"origin",Object);return t.x=j(t,"x",Number),t.y=j(t,"y",Number),t}(t),A=l,M=[],B=e.width*z.x,F=e.height*z.y;A--;)M.push(_({x:B,y:F,angle:o,spread:d,startVelocity:x,color:g[A%g.length],shape:k[v(0,k.length)],ticks:y,decay:m,gravity:u,drift:f,scalar:S,flat:C}));return n?n.addFettis(M):(n=function(e,t,s,r,n){var l,o,d=t.slice(),x=e.getContext("2d"),m=c(function(t){function c(){l=o=null,x.clearRect(0,0,r.width,r.height),p.clear(),n(),t()}l=b.frame(function t(){!a||r.width===i.width&&r.height===i.height||(r.width=e.width=i.width,r.height=e.height=i.height),r.width||r.height||(s(e),r.width=e.width,r.height=e.height),x.clearRect(0,0,r.width,r.height),(d=d.filter(function(e){return T(x,e)})).length?l=b.frame(t):c()}),o=c});return{addFettis:function(e){return d=d.concat(e),m},canvas:e,promise:m,reset:function(){l&&b.cancel(l),o&&o()}}}(e,M,h,s,r),n.promise)}function k(s){var a=x||j(s,"disableForReducedMotion",Boolean),i=j(s,"zIndex",Number);if(a&&g)return c(function(e){e()});l&&n?e=n.canvas:l&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(i),document.body.appendChild(e)),o&&!u&&h(e);var r={width:e.width,height:e.height};function p(){if(m){var t={getBoundingClientRect:function(){if(!l)return e.getBoundingClientRect()}};return h(t),void m.postMessage({resize:{width:t.width,height:t.height}})}r.width=r.height=null}function b(){n=null,o&&(d=!1,t.removeEventListener("resize",p)),l&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,u=!1)}return m&&!u&&m.init(e),u=!0,m&&(e.__confetti_initialized=!0),o&&!d&&(d=!0,t.addEventListener("resize",p,!1)),m?m.fire(s,r,b):y(s,r,b)}return k.reset=function(){m&&m.reset(),n&&n.reset()},k}function A(){return u||(u=z(null,{useWorker:!0,resize:!0})),u}s.exports=function(){return A().apply(this,arguments)},s.exports.reset=function(){A().reset()},s.exports.create=z,s.exports.shapeFromPath=function(e){if(!n)throw new Error("path confetti are not supported in this browser");var t,s;"string"==typeof e?t=e:(t=e.path,s=e.matrix);var a=new Path2D(t),i=document.createElement("canvas").getContext("2d");if(!s){for(var r,l,c=1e3,o=c,d=c,x=0,m=0,h=0;h<c;h+=2)for(var u=0;u<c;u+=2)i.isPointInPath(a,h,u,"nonzero")&&(o=Math.min(o,h),d=Math.min(d,u),x=Math.max(x,h),m=Math.max(m,u));r=x-o,l=m-d;var p=Math.min(10/r,10/l);s=[p,0,0,p,-Math.round(r/2+o)*p,-Math.round(l/2+d)*p]}return{type:"path",path:t,matrix:s}},s.exports.shapeFromText=function(e){var t,s=1,a="#000000",i='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,s="scalar"in e?e.scalar:s,i="fontFamily"in e?e.fontFamily:i,a="color"in e?e.color:a);var r=10*s,n=r+"px "+i,l=new OffscreenCanvas(r,r),c=l.getContext("2d");c.font=n;var o=c.measureText(t),d=Math.ceil(o.actualBoundingBoxRight+o.actualBoundingBoxLeft),x=Math.ceil(o.actualBoundingBoxAscent+o.actualBoundingBoxDescent),m=o.actualBoundingBoxLeft+2,h=o.actualBoundingBoxAscent+2;d+=4,x+=4,(c=(l=new OffscreenCanvas(d,x)).getContext("2d")).font=n,c.fillStyle=a,c.fillText(t,m,h);var u=1/s;return{type:"bitmap",bitmap:l.transferToImageBitmap(),matrix:[u,0,0,u,-d*u/2,-x*u/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),Ot,!1);const qt=Ot.exports;function Ut({type:e,data:t}){he.useEffect(()=>{switch(Ce.hapticNotification("success"),e){case"win":case"daily":case"streak":default:s();break;case"tier_up":i();break;case"mystery_box":r();break;case"spin":n()}},[e]);const s=()=>{qt({particleCount:100,spread:70,origin:{y:.6},colors:["#FFD700","#0066FF","#22C55E","#8B5CF6"]})},i=()=>{const e=Date.now()+2e3,t=()=>{qt({particleCount:3,angle:60,spread:55,origin:{x:0},colors:["#FFD700","#FFA500","#FF6B00"]}),qt({particleCount:3,angle:120,spread:55,origin:{x:1},colors:["#FFD700","#FFA500","#FF6B00"]}),Date.now()<e&&requestAnimationFrame(t)};t()},r=()=>{qt({particleCount:150,spread:180,origin:{y:.5},colors:["#FFD700","#8B5CF6","#EC4899","#22C55E"],shapes:["star","circle"]})},n=()=>{qt({particleCount:50,spread:60,origin:{y:.7},colors:["#FFD700","#0066FF"]})};return a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/80 backdrop-blur-sm",children:a.jsx(o.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.5,opacity:0},transition:{type:"spring",damping:15,stiffness:300},className:"text-center p-8",children:(()=>{switch(e){case"win":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üéâ"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"You Won!"}),(null==t?void 0:t.amount)&&a.jsxs("p",{className:"text-3xl font-bold text-gradient-gold",children:["+",bt(t.amount)," SATZ"]})]});case"daily":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üéÅ"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Daily Reward!"}),(null==t?void 0:t.amount)&&a.jsxs("p",{className:"text-3xl font-bold text-gradient-gold",children:["+",bt(t.amount)," SATZ"]}),(null==t?void 0:t.streak)&&a.jsxs("p",{className:"text-dark-400 mt-2",children:["üî• ",t.streak," day streak!"]})]});case"streak":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üî•"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Streak Bonus!"}),a.jsxs("p",{className:"text-3xl font-bold text-gradient",children:[null==t?void 0:t.streak," Days"]}),(null==t?void 0:t.amount)&&a.jsxs("p",{className:"text-xl text-gold-400 mt-2",children:["+",bt(t.amount)," SATZ"]})]});case"tier_up":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"‚¨ÜÔ∏è"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Tier Up!"}),a.jsx("p",{className:"text-3xl font-bold",style:{color:null==t?void 0:t.tierColor},children:null==t?void 0:t.tierName}),a.jsxs("p",{className:"text-dark-400 mt-2",children:[null==t?void 0:t.multiplier,"x rewards multiplier"]})]});case"mystery_box":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üì¶‚ú®"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Mystery Box!"}),(null==t?void 0:t.amount)&&a.jsxs("p",{className:"text-3xl font-bold text-gradient-gold",children:["+",bt(t.amount)," SATZ"]})]});case"spin":return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üé∞"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Spin Win!"}),(null==t?void 0:t.amount)&&a.jsxs("p",{className:"text-3xl font-bold text-gradient-gold",children:["+",bt(t.amount)," SATZ"]})]});default:return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-6xl mb-4",children:"üéâ"}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Congratulations!"})]})}})()})})}function Ht(){const e=de(),{isTabBarVisible:t,toasts:s,modal:i,celebration:r}=lt(),n=!["/","/more"].includes(e.pathname);return a.jsxs("div",{className:"fixed inset-0 bg-dark-950 flex flex-col overflow-hidden",children:[n&&a.jsx(ze,{title:e.pathname.startsWith("/predict/")?"Quest":e.pathname.startsWith("/groups/")?"Group":{"/predict":"Predictions","/earn":"Earn","/earn/tasks":"Tasks","/wallet":"Wallet","/wallet/transactions":"Transactions","/wallet/redeem":"Redeem","/friends":"Friends","/challenges":"Challenges","/groups":"Groups","/leaderboard":"Leaderboard","/vault":"BTC Vault","/shop":"Shop","/boosters":"Boosters","/stats":"My Stats","/settings":"Settings"}[e.pathname]||""}),a.jsx("main",{className:"flex-1 overflow-y-auto overflow-x-hidden "+(n?"pt-14":""),style:{paddingBottom:t?"calc(4.5rem + env(safe-area-inset-bottom, 0px))":"0"},children:a.jsx(w,{mode:"wait",children:a.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:a.jsx(be,{})},e.pathname)})}),t&&a.jsx(Te,{}),a.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 flex flex-col gap-2 pointer-events-none",children:a.jsx(w,{children:s.map(e=>a.jsx(dt,{toast:e},e.id))})}),a.jsx(w,{children:i.isOpen&&a.jsx(Wt,{type:i.type,props:i.props})}),a.jsx(w,{children:r&&a.jsx(Ut,{type:r.type,data:r.data})})]})}Ot.exports.create;const Qt=nt((e,t)=>({dailyReward:null,streakInfo:null,tasks:[],spinResult:null,isLoading:!1,error:null,adsWatchedToday:0,maxAdsPerDay:5,fetchDailyReward:async()=>{e({isLoading:!0,error:null});try{0;const t=await xt.getDailyReward();return e({dailyReward:t,streakInfo:t.streakInfo,isLoading:!1}),t}catch(t){throw console.error("Fetch daily reward error:",t),e({error:t.message,isLoading:!1}),t}},claimDailyReward:async()=>{e({isLoading:!0,error:null});try{const s=await xt.claimDailyReward();return e({dailyReward:{...t().dailyReward,canClaim:!1,lastClaimed:(new Date).toISOString()},isLoading:!1}),s}catch(s){throw console.error("Claim daily reward error:",s),e({error:s.message,isLoading:!1}),s}},spinWheel:async()=>{e({isLoading:!0,error:null,spinResult:null});try{0;const t=await xt.spinWheel();return e({spinResult:t,isLoading:!1}),t}catch(t){throw console.error("Spin wheel error:",t),e({error:t.message,isLoading:!1}),t}},fetchTasks:async()=>{e({isLoading:!0,error:null});try{0;const t=await xt.getTasks();return e({tasks:t.tasks||t,isLoading:!1}),t.tasks||t}catch(t){throw console.error("Fetch tasks error:",t),e({error:t.message,isLoading:!1}),t}},startTask:async e=>{try{return await xt.startTask(e)}catch(t){throw console.error("Start task error:",t),t}},verifyTask:async(s,a={})=>{e({isLoading:!0,error:null});try{const i=await xt.verifyTask(s,a),r=t().tasks.map(e=>e.id===s?{...e,completed:!0}:e);return e({tasks:r,isLoading:!1}),i}catch(i){throw console.error("Verify task error:",i),e({error:i.message,isLoading:!1}),i}},watchAd:async()=>{const{adsWatchedToday:s,maxAdsPerDay:a}=t();if(s>=a)throw new Error("Daily ad limit reached");e({isLoading:!0,error:null});try{const t=await xt.watchAd();return e({adsWatchedToday:s+1,isLoading:!1}),t}catch(i){throw console.error("Watch ad error:",i),e({error:i.message,isLoading:!1}),i}},clearSpinResult:()=>{e({spinResult:null})},clearError:()=>{e({error:null})}}));function Gt(){var e;const t=me(),{user:s,fetchUser:i}=ht(),{quests:l,fetchQuests:c}=ut(),{dailyReward:d,fetchDailyReward:x,claimDailyReward:m}=Qt(),{showToast:h,showCelebration:u}=lt(),[p,b]=he.useState(null),[f,j]=he.useState(null),[v,y]=he.useState([]),[w,M]=he.useState(1e5),[B,F]=he.useState(!0);he.useEffect(()=>{(async()=>{F(!0);try{await Promise.all([i(),c({limit:5}),x(),P()])}catch(e){console.error("Home data load error:",e)}finally{F(!1)}})()},[]),he.useEffect(()=>{if((null==l?void 0:l.length)>0){const e=[...l].sort((e,t)=>{const s=(Number(e.pool_a)||0)+(Number(e.pool_b)||0);return(Number(t.pool_a)||0)+(Number(t.pool_b)||0)-s});b(e[0])}},[l]);const P=async()=>{try{const e=await xt.get("/api/miniapp/public/stats");e&&(j(e),e.btcPrice&&(jt(e.btcPrice),M(e.btcPrice)),e.recentWinners&&y(e.recentWinners.map(e=>({type:"win",name:e.name||"Anonymous",action:"won",amount:e.amount,time:e.time}))))}catch(e){console.error("Live stats error:",e)}},I=(e,s)=>{Ce.hapticSelection(),t(`/predict/${e}?option=${s}`)},E=Ft((null==s?void 0:s.tier)||(null==s?void 0:s.status_tier)||"newcomer"),$=Number(null==s?void 0:s.satz_balance)||0,D=wt($,w),L=St($),R=Number(null==s?void 0:s.current_streak)||0,Z=(W=R)>=30?1.5:W>=14?1.3:W>=7?1.2:W>=3?1.1:1;var W;const O=!(null==s?void 0:s.first_prediction_bonus_claimed)&&0===((null==s?void 0:s.predictions_made)||0);return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-20",children:[a.jsxs("div",{className:"bg-gradient-to-b from-dark-850 via-dark-900 to-dark-950 px-4 pt-5 pb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-11 h-11 rounded-full flex items-center justify-center text-lg font-bold",style:{backgroundColor:E.color+"33",color:E.color},children:(null==(e=null==s?void 0:s.first_name)?void 0:e[0])||"üë§"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-base font-bold text-white",children:(null==s?void 0:s.first_name)||"Predictor"}),a.jsxs("div",{className:"flex items-center gap-1.5 text-xs",children:[a.jsx("span",{style:{color:E.color},children:E.emoji}),a.jsx("span",{className:"text-dark-400",children:E.name})]})]})]}),a.jsxs(fe,{to:"/wallet",className:"text-right",children:[a.jsx("p",{className:"text-xl font-bold text-gradient-gold",children:bt($)}),a.jsxs("p",{className:"text-xs text-dark-400",children:["SATZ ",a.jsxs("span",{className:"text-dark-500",children:["(",D,")"]})]})]})]}),R>0&&a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-1.5 bg-orange-500/10 border border-orange-500/20 rounded-full px-3 py-1.5",children:[a.jsx(k,{size:14,className:"text-orange-500"}),a.jsxs("span",{className:"text-sm font-semibold text-orange-400",children:[R," day streak"]})]}),Z>1&&a.jsxs("div",{className:"flex items-center gap-1 bg-mint-500/10 border border-mint-500/20 rounded-full px-2 py-1",children:[a.jsx(S,{size:12,className:"text-mint-400"}),a.jsxs("span",{className:"text-xs font-semibold text-mint-400",children:[Z,"x bonus"]})]})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs text-dark-400",children:"Progress to Withdrawal"}),a.jsxs("span",{className:"text-xs font-medium text-white",children:[L.percentage.toFixed(0),"%"]})]}),a.jsx("div",{className:"h-2 bg-dark-700 rounded-full overflow-hidden mb-1.5",children:a.jsx(o.div,{className:"h-full rounded-full "+(L.canWithdraw?"bg-gradient-to-r from-green-500 to-emerald-400":"bg-gradient-to-r from-mint-500 to-cyan-400"),initial:{width:0},animate:{width:`${L.percentage}%`},transition:{duration:.8,ease:"easeOut"}})}),a.jsx("p",{className:"text-xs text-center text-dark-400",children:L.canWithdraw?a.jsx("span",{className:"text-green-400",children:"üéâ Ready to withdraw BTC!"}):Ct($)})]})]}),a.jsxs("div",{className:"px-4 space-y-4",children:[(null==d?void 0:d.canClaim)&&a.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-gold-500/20 to-orange-500/20 border border-gold-500/30 rounded-xl p-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gold-gradient rounded-xl flex items-center justify-center animate-pulse",children:a.jsx(n,{size:20,className:"text-dark-900"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-white text-sm",children:"Daily Reward Ready!"}),a.jsxs("p",{className:"text-xs text-gold-400",children:["+",yt(d.streakReward,w)]})]})]}),a.jsx(o.button,{whileTap:{scale:.95},onClick:async()=>{if(null==d?void 0:d.canClaim){Ce.hapticImpact("medium");try{const e=await m();u("daily",{amount:(null==e?void 0:e.reward)||d.streakReward,streak:d.currentStreak+1}),i(!0)}catch(e){h(e.message||"Failed to claim reward","error")}}},className:"px-4 py-2 bg-gold-gradient rounded-xl font-semibold text-sm text-dark-900",children:"Claim"})]})}),O&&a.jsx(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-gradient-to-r from-mint-500/10 to-cyan-500/10 border border-mint-500/30 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-mint-500/20 rounded-xl flex items-center justify-center",children:a.jsx(C,{size:24,className:"text-mint-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-bold text-white",children:"First Prediction Bonus!"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Make your first prediction to earn"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-mint-400 text-lg",children:["+",100]}),a.jsx("p",{className:"text-xs text-dark-400",children:"SATZ"})]})]})}),p&&a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h2",{className:"text-base font-bold text-white flex items-center gap-2",children:[a.jsx(r,{size:18,className:"text-mint-400"}),"Today's Top Prediction"]}),a.jsxs(fe,{to:"/predict",className:"text-mint-400 text-xs flex items-center",children:["View all ",a.jsx(_,{size:14})]})]}),a.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-dark-800 to-dark-900 border border-white/10",children:[a.jsx("div",{className:"absolute top-3 right-3 px-2 py-1 bg-red-500/20 border border-red-500/30 rounded-full z-10",children:a.jsxs("span",{className:"text-xs font-semibold text-red-400 flex items-center gap-1",children:[a.jsx(S,{size:10})," HOT"]})}),a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("span",{className:"px-2 py-0.5 bg-mint-500/20 text-mint-400 rounded-full text-xs font-medium capitalize",children:p.category||"crypto"}),a.jsxs("span",{className:"text-xs text-dark-400 flex items-center gap-1",children:[a.jsx(T,{size:10}),_t(p.betting_deadline)]})]}),a.jsx("h3",{className:"text-lg font-bold text-white mb-4 leading-tight pr-16",children:p.title}),(()=>{const e=Number(p.pool_a)||0,t=Number(p.pool_b)||0,s=e+t,i=s>0?Math.round(e/s*100):50,r=100-i;return a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>I(p.id,"a"),className:"relative p-4 rounded-xl bg-mint-500/10 border-2 border-mint-500/30 hover:border-mint-500 active:bg-mint-500/20 transition-all",children:[a.jsxs("div",{className:"absolute top-2 right-2 px-1.5 py-0.5 bg-mint-500 rounded text-xs font-bold text-dark-900",children:[i,"%"]}),a.jsx("p",{className:"text-white font-semibold text-sm mb-1 text-left",children:p.option_a||"Yes"}),a.jsxs("p",{className:"text-xs text-dark-400 text-left",children:[bt(e)," SATZ"]})]}),a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>I(p.id,"b"),className:"relative p-4 rounded-xl bg-red-500/10 border-2 border-red-500/30 hover:border-red-500 active:bg-red-500/20 transition-all",children:[a.jsxs("div",{className:"absolute top-2 right-2 px-1.5 py-0.5 bg-red-500 rounded text-xs font-bold text-white",children:[r,"%"]}),a.jsx("p",{className:"text-white font-semibold text-sm mb-1 text-left",children:p.option_b||"No"}),a.jsxs("p",{className:"text-xs text-dark-400 text-left",children:[bt(t)," SATZ"]})]})]})})(),a.jsxs("div",{className:"flex items-center justify-between text-xs text-dark-400 pt-3 border-t border-white/5",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(g,{size:12,className:"text-gold-400"}),bt((Number(p.pool_a)||0)+(Number(p.pool_b)||0))," pool"]}),a.jsxs("span",{children:["üë• ",p.participant_count||0," players"]})]})]})]})]}),a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"grid grid-cols-3 gap-2",children:[a.jsxs(fe,{to:"/earn",className:"flex flex-col items-center gap-1.5 p-3 bg-dark-800 rounded-xl hover:bg-dark-750 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center",children:a.jsx(n,{size:20,className:"text-green-400"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:"Earn"})]}),a.jsxs(fe,{to:"/friends",className:"flex flex-col items-center gap-1.5 p-3 bg-dark-800 rounded-xl hover:bg-dark-750 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center",children:a.jsx(z,{size:20,className:"text-blue-400"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:"Friends"})]}),a.jsxs(fe,{to:"/leaderboard",className:"flex flex-col items-center gap-1.5 p-3 bg-dark-800 rounded-xl hover:bg-dark-750 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-yellow-500/20 flex items-center justify-center",children:a.jsx(N,{size:20,className:"text-yellow-400"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:"Ranks"})]})]}),v.length>0&&a.jsxs(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"overflow-hidden py-2",children:[a.jsx("p",{className:"text-xs text-dark-500 mb-2 px-1",children:"Live Activity"}),a.jsx("div",{className:"overflow-hidden",children:a.jsx(o.div,{className:"flex gap-3",animate:{x:[0,-500]},transition:{duration:15,repeat:1/0,ease:"linear"},children:[...v,...v].map((e,t)=>a.jsxs("div",{className:"flex items-center gap-2 bg-dark-800/50 rounded-full px-3 py-1.5 whitespace-nowrap",children:[a.jsx("span",{className:"text-sm",children:"üèÜ"}),a.jsxs("span",{className:"text-xs text-dark-300",children:[a.jsx("span",{className:"text-white font-medium",children:e.name})," won ",a.jsxs("span",{className:"text-gold-400 font-semibold",children:["+",bt(e.amount)]})]})]},t))})})]}),a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:(null==s?void 0:s.predictions_won)||0}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Wins"})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsxs("p",{className:"text-lg font-bold text-white",children:[((null==s?void 0:s.win_rate)||0).toFixed(0),"%"]}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Win Rate"})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:ft((null==s?void 0:s.total_won)||0)}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Total Won"})]})]}),a.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:a.jsx(fe,{to:"/friends",children:a.jsx("div",{className:"bg-gradient-to-r from-mint-500/20 to-cyan-500/20 border border-mint-500/30 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-white mb-0.5",children:"Invite & Earn 7%"}),a.jsx("p",{className:"text-xs text-dark-300",children:"Get 100 SATZ + lifetime commission on friend earnings"})]}),a.jsx("div",{className:"w-10 h-10 bg-mint-500/20 rounded-full flex items-center justify-center",children:a.jsx(A,{size:18,className:"text-mint-400"})})]})})})}),(null==f?void 0:f.vault)&&a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-center py-3",children:a.jsxs("p",{className:"text-xs text-dark-500",children:["üîí BTC Vault: ",a.jsxs("span",{className:"text-dark-400 font-medium",children:[f.vault.balance," BTC"]})," ","‚Ä¢ Backing 100% of SATZ"]})})]})]})}const Yt=[{id:"active",label:"Active",icon:k},{id:"mybets",label:"My Bets",icon:N},{id:"resolved",label:"History",icon:T}],Vt=[{id:"all",name:"All",emoji:"üî•"},{id:"crypto",name:"Crypto",emoji:"ü™ô"},{id:"sports",name:"Sports",emoji:"‚öΩ"},{id:"politics",name:"Politics",emoji:"üèõÔ∏è"},{id:"entertainment",name:"Entertainment",emoji:"üé¨"}];function Jt(){const e=me();ge();const{user:t}=ht(),[s,i]=he.useState("active"),[r,n]=he.useState([]),[l,c]=he.useState([]),[d,x]=he.useState(!0),[m,h]=he.useState(""),[u,b]=he.useState("all"),[f,j]=he.useState(null);he.useEffect(()=>{"mybets"===s?y():v()},[s]);const v=async()=>{x(!0);try{const e="resolved"===s?"resolved":"active",t=(await xt.get(`/api/miniapp/quests?status=${e}&limit=50`)).quests||[];if(n(t),"active"===s&&t.length>0){const e=[...t].sort((e,t)=>{const s=(Number(e.pool_a)||0)+(Number(e.pool_b)||0);return(Number(t.pool_a)||0)+(Number(t.pool_b)||0)-s});j(e[0])}}catch(e){console.error("Failed to fetch quests:",e),n([])}finally{x(!1)}},y=async()=>{x(!0);try{const e=await xt.get("/api/miniapp/predictions");c(e.predictions||[])}catch(e){console.error("Failed to fetch predictions:",e),c([])}finally{x(!1)}},w=t=>{Ce.hapticSelection(),e(`/predict/${t}`)},C=he.useMemo(()=>r.filter(e=>{var t;if(f&&e.id===f.id&&"active"===s)return!1;const a=!m||(null==(t=e.title)?void 0:t.toLowerCase().includes(m.toLowerCase())),i="all"===u||e.category===u;return a&&i}),[r,m,u,f,s]),_=e=>new Date(e)<=new Date;return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-dark-900 border-b border-white/5 px-4 py-4 sticky top-0 z-20",children:[a.jsx("h1",{className:"text-xl font-bold text-white mb-4",children:"Predictions"}),a.jsx("div",{className:"flex bg-dark-800 rounded-xl p-1 mb-4",children:Yt.map(e=>a.jsxs("button",{onClick:()=>{return t=e.id,Ce.hapticSelection(),void i(t);var t},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-1.5 "+(s===e.id?"bg-mint-500 text-white":"text-dark-400 hover:text-dark-300"),children:[a.jsx(e.icon,{size:14}),e.label]},e.id))}),"mybets"!==s&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative mb-3",children:[a.jsx(M,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-dark-400"}),a.jsx("input",{type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"Search predictions...",className:"w-full bg-dark-800 rounded-xl pl-9 pr-4 py-2.5 text-sm text-white placeholder-dark-500 focus:outline-none focus:ring-1 focus:ring-mint-500/50"}),m&&a.jsx("button",{onClick:()=>h(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-dark-400 hover:text-white",children:a.jsx(p,{size:14})})]}),a.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-4 px-4 scrollbar-hide",children:Vt.map(e=>a.jsxs("button",{onClick:()=>{Ce.hapticSelection(),b(e.id)},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all "+(u===e.id?"bg-mint-500 text-white":"bg-dark-800 text-dark-400 hover:text-white"),children:[a.jsx("span",{children:e.emoji}),e.name]},e.id))})]})]}),a.jsx("div",{className:"p-4 space-y-3",children:d?[...Array(4)].map((e,t)=>a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 animate-pulse",children:[a.jsx("div",{className:"h-4 bg-dark-700 rounded w-1/4 mb-2"}),a.jsx("div",{className:"h-5 bg-dark-700 rounded w-3/4 mb-3"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"flex-1 h-14 bg-dark-700 rounded-lg"}),a.jsx("div",{className:"flex-1 h-14 bg-dark-700 rounded-lg"})]})]},t)):"mybets"===s?0===l.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(N,{size:48,className:"mx-auto mb-4 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No predictions yet"}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"Make your first prediction!"}),a.jsx("button",{onClick:()=>i("active"),className:"mt-4 px-6 py-2 bg-mint-500 text-white rounded-xl font-medium",children:"Browse Predictions"})]}):l.map(e=>{const t=_(e.betting_deadline),s=!0===e.is_winner,i=!1===e.is_winner&&"resolved"===e.quest_status,r=t&&!s&&!i;return a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>w(e.quest_id),className:"bg-dark-800 rounded-xl p-4 border border-white/5 cursor-pointer active:scale-[0.98] transition-transform",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("span",{className:"text-xs text-dark-400 capitalize flex items-center gap-1",children:[Et(e.category)," ",e.category||"crypto"]}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium "+(s?"bg-green-500/20 text-green-400":i?"bg-red-500/20 text-red-400":r?"bg-yellow-500/20 text-yellow-400":"bg-mint-500/20 text-mint-400"),children:s?"üèÜ Won!":i?"Lost":r?"‚è≥ Pending":"üéØ Active"})]}),a.jsx("h3",{className:"font-medium text-white mb-3 line-clamp-2",children:e.title}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-dark-400",children:"Your pick: "}),a.jsx("span",{className:"font-medium "+("a"===e.chosen_option?"text-mint-400":"text-red-400"),children:"a"===e.chosen_option?e.option_a:e.option_b})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:"text-dark-400",children:"Bet: "}),a.jsx("span",{className:"text-gold-400 font-medium",children:bt(e.amount)})]})]}),s&&e.payout>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-dark-400",children:"Winnings"}),a.jsxs("span",{className:"text-green-400 font-bold",children:["+",yt(e.payout)]})]})]},e.id)}):a.jsxs(a.Fragment,{children:["active"===s&&f&&a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(S,{size:14,className:"text-gold-400"}),a.jsx("span",{className:"text-xs font-semibold text-gold-400 uppercase tracking-wide",children:"Today's Pick"})]}),a.jsxs("div",{onClick:()=>w(f.id),className:"bg-gradient-to-br from-dark-800 to-dark-850 rounded-xl p-4 border border-gold-500/20 cursor-pointer active:scale-[0.99] transition-transform",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("span",{className:"px-2 py-0.5 bg-mint-500/20 text-mint-400 rounded-full text-xs font-medium capitalize",children:f.category||"crypto"}),a.jsxs("span",{className:"text-xs text-dark-400 flex items-center gap-1",children:[a.jsx(T,{size:10}),_t(f.betting_deadline)]})]}),a.jsx("h3",{className:"font-bold text-white text-lg mb-4",children:f.title}),(()=>{const e=Number(f.pool_a)||0,t=Number(f.pool_b)||0,s=e+t,i=s>0?Math.round(e/s*100):50,r=100-i;return a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[a.jsxs("div",{className:"p-3 rounded-xl bg-mint-500/10 border border-mint-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-white font-medium text-sm truncate",children:f.option_a}),a.jsxs("span",{className:"text-mint-400 font-bold",children:[i,"%"]})]}),a.jsxs("p",{className:"text-xs text-dark-400",children:[bt(e)," SATZ"]})]}),a.jsxs("div",{className:"p-3 rounded-xl bg-red-500/10 border border-red-500/20",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-white font-medium text-sm truncate",children:f.option_b}),a.jsxs("span",{className:"text-red-400 font-bold",children:[r,"%"]})]}),a.jsxs("p",{className:"text-xs text-dark-400",children:[bt(t)," SATZ"]})]})]})})(),a.jsxs("div",{className:"flex items-center justify-between text-xs text-dark-400",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(g,{size:12,className:"text-gold-400"}),bt((Number(f.pool_a)||0)+(Number(f.pool_b)||0))," pool"]}),a.jsxs("span",{children:["üë• ",f.participant_count||0," players"]})]})]})]}),0===C.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(M,{size:48,className:"mx-auto mb-4 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No predictions found"}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:m?"Try a different search":"Check back soon!"})]}):C.map((e,t)=>{const s=Number(e.pool_a)||0,i=s+(Number(e.pool_b)||0),r=i>0?Math.round(s/i*100):50,n=100-r,l=_(e.betting_deadline),c=(e.participant_count||0)>5||i>1e3;return a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.03*t},onClick:()=>w(e.id),className:"bg-dark-800 rounded-xl p-4 border border-white/5 cursor-pointer active:scale-[0.98] transition-transform",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"px-2 py-0.5 bg-dark-700 text-dark-300 rounded-full text-xs capitalize flex items-center gap-1",children:[Et(e.category)," ",e.category||"crypto"]}),c&&!l&&a.jsxs("span",{className:"px-1.5 py-0.5 bg-red-500/20 text-red-400 rounded-full text-xs flex items-center gap-0.5",children:[a.jsx(k,{size:10})," Hot"]})]}),a.jsxs("span",{className:"text-xs flex items-center gap-1 "+(l?"text-red-400":"text-dark-400"),children:[a.jsx(T,{size:10}),l?"Ended":_t(e.betting_deadline)]})]}),a.jsx("h3",{className:"font-medium text-white mb-3 line-clamp-2",children:e.title}),a.jsxs("div",{className:"flex gap-2 mb-3",children:[a.jsx("div",{className:"flex-1 p-2.5 rounded-lg "+(l?"bg-dark-700":"bg-mint-500/10 border border-mint-500/20"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-white font-medium truncate pr-2",children:e.option_a||"Yes"}),a.jsxs("span",{className:"font-bold "+(l?"text-dark-400":"text-mint-400"),children:[r,"%"]})]})}),a.jsx("div",{className:"flex-1 p-2.5 rounded-lg "+(l?"bg-dark-700":"bg-red-500/10 border border-red-500/20"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-white font-medium truncate pr-2",children:e.option_b||"No"}),a.jsxs("span",{className:"font-bold "+(l?"text-dark-400":"text-red-400"),children:[n,"%"]})]})})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-dark-400",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(g,{size:12})," ",bt(i)," SATZ"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(z,{size:12})," ",e.participant_count||0]})]})]},e.id)})]})})]})}const Xt=[25,50,100,250,500];function Kt(){var e,t;const{questId:s}=je(),[i]=ge(),r=me(),{user:n,fetchUser:l}=ht(),{showToast:c,showCelebration:d}=lt(),[x,m]=he.useState(null),[h,u]=he.useState(!0),[p,b]=he.useState(null),[f,j]=he.useState(50),[N,v]=he.useState(!1),[k,S]=he.useState(!1),[_,A]=he.useState(1e5);he.useEffect(()=>{M(),E();const e=i.get("option");"a"!==e&&"b"!==e||b(e)},[s]);const M=async()=>{u(!0);try{const e=await xt.get(`/api/miniapp/quests/${s}`);m(e.quest)}catch(e){c("Quest not found","error"),r("/predict")}finally{u(!1)}},E=async()=>{try{const e=await xt.get("/api/miniapp/public/stats");(null==e?void 0:e.btcPrice)&&A(e.btcPrice)}catch(e){}},$=()=>{Ce.hapticSelection(),Ce.shareUrl(`https://t.me/MintIQBot?start=quest_${s}`,`üéØ ${null==x?void 0:x.title}\n\nPredict now on MintIQ!`)},D=e=>{q&&(Ce.hapticSelection(),b(e))},L=he.useMemo(()=>x?zt(x.pool_a,x.pool_b):{a:50,b:50},[x]),R=he.useMemo(()=>x?(Number(x.pool_a)||0)+(Number(x.pool_b)||0):0,[x]),Z=!!x&&new Date(x.betting_deadline)<=new Date,W="resolved"===(null==x?void 0:x.status),O=null!==(null==x?void 0:x.userBet),q=!Z&&!W&&!O,U=!(null==n?void 0:n.first_prediction_bonus_claimed)&&0===((null==n?void 0:n.predictions_made)||0),H=he.useMemo(()=>x?At(Number(x.pool_a)||0,Number(x.pool_b)||0):1,[x]),Q=he.useMemo(()=>x?At(Number(x.pool_b)||0,Number(x.pool_a)||0):1,[x]),G=he.useMemo(()=>{if(!x||!p)return 0;const e="a"===p?Number(x.pool_a)||0:Number(x.pool_b)||0,t="a"===p?Number(x.pool_b)||0:Number(x.pool_a)||0;return Mt(f,e,t)},[x,p,f]);return h?a.jsx("div",{className:"min-h-screen bg-dark-950 p-4",children:a.jsxs("div",{className:"animate-pulse space-y-4",children:[a.jsx("div",{className:"h-8 bg-dark-800 rounded w-1/4"}),a.jsx("div",{className:"h-6 bg-dark-800 rounded w-3/4"}),a.jsx("div",{className:"h-40 bg-dark-800 rounded-xl"})]})}):x?a.jsxs("div",{className:"min-h-screen bg-dark-950",children:[a.jsxs("div",{className:"bg-dark-900 border-b border-white/5 px-4 py-3 flex items-center gap-3 sticky top-0 z-20",children:[a.jsx("button",{onClick:()=>r(-1),className:"p-2 -ml-2 text-dark-400 hover:text-white transition-colors",children:a.jsx(B,{size:20})}),a.jsx("div",{className:"flex-1",children:a.jsx("h1",{className:"text-lg font-bold text-white",children:"Prediction"})}),a.jsx("button",{onClick:$,className:"p-2 text-dark-400 hover:text-white transition-colors",children:a.jsx(y,{size:18})})]}),a.jsxs("div",{className:"p-4 pb-44 space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:"px-2.5 py-1 bg-dark-800 text-dark-300 rounded-full text-xs capitalize flex items-center gap-1",children:[Et(x.category)," ",x.category||"crypto"]}),Z&&!W&&a.jsxs("span",{className:"px-2.5 py-1 bg-yellow-500/20 text-yellow-400 rounded-full text-xs flex items-center gap-1",children:[a.jsx(T,{size:10})," Pending Result"]}),W&&a.jsx("span",{className:"px-2.5 py-1 bg-blue-500/20 text-blue-400 rounded-full text-xs",children:"‚úì Resolved"}),O&&a.jsxs("span",{className:"px-2.5 py-1 bg-mint-500/20 text-mint-400 rounded-full text-xs",children:["üéØ You predicted: ","a"===x.userBet.chosen_option?x.option_a:x.option_b]})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:x.title}),x.description&&a.jsx("p",{className:"text-sm text-dark-400",children:x.description})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-dark-400",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(T,{size:14}),Z?"Ended":_t(x.betting_deadline)]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(z,{size:14}),x.participant_count||0," players"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(g,{size:14,className:"text-gold-400"}),yt(R,_)," pool"]})]}),U&&q&&a.jsx(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-mint-500/10 to-cyan-500/10 border border-mint-500/30 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-mint-500/20 rounded-xl flex items-center justify-center",children:a.jsx(C,{size:20,className:"text-mint-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-white text-sm",children:"First Prediction Bonus!"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Earn extra SATZ on your first bet"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-mint-400",children:["+",100]}),a.jsx("p",{className:"text-xs text-dark-500",children:"SATZ"})]})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-medium text-white",children:"Choose your prediction"}),a.jsxs(o.button,{whileTap:q?{scale:.98}:{},onClick:()=>D("a"),disabled:!q,className:`w-full p-5 rounded-2xl border-2 transition-all text-left ${"a"===p?"bg-mint-500/20 border-mint-500":O&&"a"===(null==(e=x.userBet)?void 0:e.chosen_option)?"bg-mint-500/10 border-mint-500/50":"bg-dark-800 border-transparent hover:border-dark-600"} ${!q&&"opacity-60 cursor-not-allowed"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"font-semibold text-white text-lg",children:x.option_a||"Yes"}),a.jsxs("span",{className:"text-3xl font-black text-mint-400",children:[L.a,"%"]})]}),a.jsx("div",{className:"h-2.5 bg-dark-700 rounded-full overflow-hidden mb-3",children:a.jsx(o.div,{className:"h-full bg-gradient-to-r from-mint-500 to-mint-400 rounded-full",initial:{width:0},animate:{width:`${L.a}%`},transition:{duration:.5}})}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-dark-400",children:[bt(Number(x.pool_a)||0)," SATZ"]}),a.jsxs("span",{className:"text-mint-400 font-medium",children:[H.toFixed(2),"x potential"]})]})]}),a.jsxs(o.button,{whileTap:q?{scale:.98}:{},onClick:()=>D("b"),disabled:!q,className:`w-full p-5 rounded-2xl border-2 transition-all text-left ${"b"===p?"bg-red-500/20 border-red-500":O&&"b"===(null==(t=x.userBet)?void 0:t.chosen_option)?"bg-red-500/10 border-red-500/50":"bg-dark-800 border-transparent hover:border-dark-600"} ${!q&&"opacity-60 cursor-not-allowed"}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:"font-semibold text-white text-lg",children:x.option_b||"No"}),a.jsxs("span",{className:"text-3xl font-black text-red-400",children:[L.b,"%"]})]}),a.jsx("div",{className:"h-2.5 bg-dark-700 rounded-full overflow-hidden mb-3",children:a.jsx(o.div,{className:"h-full bg-gradient-to-r from-red-500 to-red-400 rounded-full",initial:{width:0},animate:{width:`${L.b}%`},transition:{duration:.5}})}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsxs("span",{className:"text-dark-400",children:[bt(Number(x.pool_b)||0)," SATZ"]}),a.jsxs("span",{className:"text-red-400 font-medium",children:[Q.toFixed(2),"x potential"]})]})]})]}),a.jsx(w,{children:q&&p&&a.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-4",children:[a.jsx("h3",{className:"font-medium text-white",children:"Bet Amount"}),a.jsx("div",{className:"flex gap-2",children:Xt.map(e=>a.jsx("button",{onClick:()=>{Ce.hapticSelection(),j(e)},className:"flex-1 py-2.5 rounded-xl text-sm font-medium transition-colors "+(f===e?"bg-mint-500 text-white":"bg-dark-800 text-dark-400 hover:text-white"),children:e},e))}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"number",value:f,onChange:e=>j(Math.max(10,parseInt(e.target.value)||10)),className:"w-full bg-dark-800 rounded-xl px-4 py-3.5 text-white text-center text-lg font-semibold focus:outline-none focus:ring-2 focus:ring-mint-500/50",min:10}),a.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-dark-400 text-sm",children:"SATZ"})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-dark-400",children:"Your balance:"}),a.jsx("span",{className:"text-white font-medium",children:yt((null==n?void 0:n.satz_balance)||0,_)})]}),a.jsxs("div",{className:"bg-gradient-to-r from-gold-500/10 to-orange-500/10 border border-gold-500/20 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"Potential Win"}),a.jsxs("p",{className:"text-2xl font-bold text-gold-400",children:[bt(G)," ",a.jsx("span",{className:"text-lg",children:"SATZ"})]}),a.jsx("p",{className:"text-sm text-dark-500",children:wt(G,_)})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-xs text-dark-500",children:"Multiplier"}),a.jsxs("p",{className:"text-xl font-bold text-white",children:[(G/f).toFixed(2),"x"]})]})]}),U&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-gold-500/20 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-mint-400",children:"+ First Prediction Bonus"}),a.jsxs("span",{className:"text-sm font-bold text-mint-400",children:["+",100," SATZ"]})]})]})]})}),O&&a.jsxs("div",{className:"bg-mint-500/10 border border-mint-500/30 rounded-xl p-4",children:[a.jsx("h3",{className:"font-medium text-mint-400 mb-3",children:"Your Prediction"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Option:"}),a.jsx("span",{className:"text-white font-medium",children:"a"===x.userBet.chosen_option?x.option_a:x.option_b})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Amount:"}),a.jsx("span",{className:"text-white font-medium",children:yt(x.userBet.amount,_)})]}),x.userBet.potential_payout&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Potential Win:"}),a.jsx("span",{className:"text-gold-400 font-medium",children:yt(x.userBet.potential_payout,_)})]})]})]}),a.jsxs("button",{onClick:()=>S(!k),className:"w-full flex items-center justify-between bg-dark-800 rounded-xl p-4",children:[a.jsx("span",{className:"font-medium text-white",children:"Quest Details"}),k?a.jsx(F,{size:18,className:"text-dark-400"}):a.jsx(P,{size:18,className:"text-dark-400"})]}),a.jsx(w,{children:k&&a.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-dark-800 rounded-xl p-4 space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Total Pool"}),a.jsx("span",{className:"text-white",children:yt(R,_)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Participants"}),a.jsx("span",{className:"text-white",children:x.participant_count||0})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Status"}),a.jsx("span",{className:Z?"text-yellow-400":"text-mint-400",children:W?"Resolved":Z?"Awaiting Result":"Active"})]}),W&&x.winning_option&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Winner"}),a.jsx("span",{className:"text-gold-400 font-medium",children:"a"===x.winning_option?x.option_a:x.option_b})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Deadline"}),a.jsx("span",{className:"text-white",children:new Date(x.betting_deadline).toLocaleString()})]})]})})]}),a.jsx("div",{className:"fixed bottom-16 left-0 right-0 bg-dark-900/95 backdrop-blur-lg border-t border-white/5 p-4 z-50",children:a.jsxs("div",{className:"flex gap-3 max-w-lg mx-auto",children:[a.jsxs("button",{onClick:$,className:"px-5 py-3.5 bg-dark-800 text-white rounded-xl font-medium flex items-center gap-2 hover:bg-dark-750 transition-colors",children:[a.jsx(y,{size:18})," Share"]}),q?a.jsx(o.button,{whileTap:{scale:.98},onClick:async()=>{if(!p||f<10)c("Select an option and amount","error");else if(((null==n?void 0:n.satz_balance)||0)<f)c("Insufficient balance","error");else{Ce.hapticImpact("medium"),v(!0);try{await xt.post(`/api/miniapp/quests/${s}/bet`,{option:p,amount:f});Ce.hapticNotification("success"),d("bet",{amount:f,option:"a"===p?x.option_a:x.option_b,potentialWin:G,isFirstPrediction:U}),l(!0),M()}catch(e){c(e.message||"Failed to place bet","error"),Ce.hapticNotification("error")}finally{v(!1)}}},disabled:!p||N||((null==n?void 0:n.satz_balance)||0)<f,className:"flex-1 py-3.5 font-bold rounded-xl transition-all "+(p&&((null==n?void 0:n.satz_balance)||0)>=f?"bg-gradient-to-r from-mint-500 to-cyan-500 text-white":"bg-dark-700 text-dark-500 cursor-not-allowed"),children:N?"Placing...":p?`Predict ${bt(f)} SATZ`:"Select an Option"}):a.jsx("div",{className:"flex-1 py-3.5 bg-dark-800 text-dark-400 font-medium rounded-xl text-center flex items-center justify-center gap-2",children:W?"‚úì Resolved":O?"‚úì Prediction Placed":a.jsxs(a.Fragment,{children:[a.jsx(I,{size:16})," Betting Closed"]})})]})})]}):null}const es={1:10,2:15,3:25,4:35,5:50,6:75,7:150},ts=[{value:1,color:"#06B6D4"},{value:5,color:"#8B5CF6"},{value:2,color:"#EC4899"},{value:10,color:"#F59E0B"},{value:3,color:"#3B82F6"},{value:25,color:"#10B981"},{value:7,color:"#EF4444"},{value:50,color:"#FFD700"}];function ss({onSpin:e,isSpinning:t,result:s,canSpin:i}){const[r,n]=he.useState(0),[l,c]=he.useState(!1),d=360/ts.length;he.useEffect(()=>{if(s&&t){const e=ts.findIndex(e=>e.value===s.amount);n(360-((e>=0?e:0)*d+d/2)+1800),setTimeout(()=>c(!0),3500)}},[s,t]);const x=ts.map((e,t)=>`${e.color} ${t*d}deg ${(t+1)*d}deg`).join(", ");return a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"relative z-10 mb-[-10px]",children:a.jsx("div",{className:"w-0 h-0",style:{borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderTop:"20px solid #FBBF24"}})}),a.jsxs("div",{className:"relative w-56 h-56",children:[a.jsx("div",{className:"absolute inset-[-4px] rounded-full bg-yellow-500/20 blur-md"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-yellow-500/50"}),a.jsx(o.div,{className:"w-full h-full rounded-full relative overflow-hidden",animate:{rotate:r},transition:{duration:3.5,ease:[.2,.8,.2,1]},style:{background:`conic-gradient(${x})`},children:ts.map((e,t)=>{const s=(t*d+d/2-90)*(Math.PI/180),i=50+35*Math.cos(s),r=50+35*Math.sin(s);return a.jsx("div",{className:"absolute text-white font-bold text-sm drop-shadow",style:{left:`${i}%`,top:`${r}%`,transform:"translate(-50%, -50%)"},children:e.value},t)})}),a.jsx("button",{onClick:()=>{i&&!t&&(c(!1),e())},disabled:!i||t,className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 rounded-full z-20 flex items-center justify-center font-bold text-sm",style:{background:i&&!t?"linear-gradient(135deg, #FFD700 0%, #F59E0B 100%)":"#374151",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:t?a.jsx(C,{size:20,className:"text-white animate-spin"}):i?a.jsx("span",{className:"text-gray-900",children:"SPIN"}):a.jsx($,{size:20,className:"text-gray-400"})})]}),a.jsx(w,{children:l&&s&&a.jsxs(o.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0},className:"mt-4 bg-yellow-500/20 border border-yellow-500/30 rounded-xl p-4 text-center w-full",children:[a.jsxs("p",{className:"text-2xl font-bold text-yellow-400",children:["üéâ +",s.amount," SATZ"]}),a.jsx("p",{className:"text-sm text-dark-400 mt-1",children:"Added to balance!"})]})})]})}function as(){const{user:e,fetchUser:t}=ht(),{dailyReward:s,fetchDailyReward:i,claimDailyReward:r,tasks:l,fetchTasks:c}=Qt(),{showToast:o}=lt(),[d,x]=he.useState(!1),[m,h]=he.useState(!1),[u,p]=he.useState(!0),[b,f]=he.useState(null);he.useEffect(()=>{i(),c(),g()},[]);const g=async()=>{try{const e=await xt.get("/api/miniapp/earn/spin/status");p(!1!==(null==e?void 0:e.canSpin))}catch(e){p(!0)}},j=Number(null==s?void 0:s.currentStreak)||0,N=(null==s?void 0:s.streakReward)||es[Math.min(j+1,7)]||10,v=(l||[]).filter(e=>!e.completed);return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-dark-900 border-b border-white/5 px-4 py-4",children:[a.jsx("h1",{className:"text-xl font-bold text-white",children:"Earn SATZ"}),a.jsx("p",{className:"text-sm text-dark-400",children:"Spin, claim & complete tasks"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-6",children:[a.jsxs("div",{className:"bg-dark-800 rounded-2xl p-5 border border-white/5",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsxs("h2",{className:"text-lg font-bold text-white flex items-center justify-center gap-2",children:[a.jsx(E,{className:"text-yellow-400",size:20}),"Daily Spin"]}),a.jsx("p",{className:"text-sm text-dark-400",children:u?"Spin to win up to 50 SATZ!":"Come back tomorrow!"})]}),a.jsx(ss,{onSpin:async()=>{if(u&&!m){Ce.hapticImpact("medium"),h(!0),f(null);try{const e=await xt.post("/api/miniapp/earn/spin"),s=(null==e?void 0:e.reward)||(null==e?void 0:e.amount)||ts[Math.floor(Math.random()*ts.length)].value;f({amount:s}),setTimeout(()=>{p(!1),h(!1),t(!0),Ce.hapticNotification("success")},4e3)}catch(e){o(e.message||"Spin failed","error"),h(!1)}}},isSpinning:m,result:b,canSpin:u&&!m})]}),a.jsxs("div",{className:"rounded-2xl p-4 "+((null==s?void 0:s.canClaim)?"bg-orange-500/20 border border-orange-500/30":"bg-dark-800 border border-white/5"),children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+((null==s?void 0:s.canClaim)?"bg-orange-500":"bg-dark-700"),children:a.jsx(n,{size:24,className:(null==s?void 0:s.canClaim)?"text-white":"text-dark-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-base font-bold text-white",children:"Daily Streak"}),a.jsx("p",{className:"text-sm text-dark-400",children:(null==s?void 0:s.canClaim)?`Claim ${N} SATZ!`:"Come back tomorrow!"})]}),a.jsx("button",{onClick:async()=>{if((null==s?void 0:s.canClaim)&&!d){Ce.hapticImpact("medium"),x(!0);try{const e=await r();Ce.hapticNotification("success"),o(`üéâ Claimed ${(null==e?void 0:e.reward)||N} SATZ!`,"success"),t(!0),i()}catch(e){o(e.message||"Failed to claim","error")}finally{x(!1)}}},disabled:!(null==s?void 0:s.canClaim)||d,className:"px-4 py-2 rounded-xl font-semibold "+((null==s?void 0:s.canClaim)?"bg-orange-500 text-white":"bg-dark-700 text-dark-400"),children:d?"...":(null==s?void 0:s.canClaim)?"Claim":"Done ‚úì"})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(k,{size:14,className:"text-orange-500"}),a.jsxs("span",{className:"text-sm text-white font-medium",children:[j," Day Streak"]})]}),a.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6,7].map(e=>a.jsx("div",{className:"flex-1 h-2 rounded-full "+(e<=j?"bg-orange-500":e===j+1&&(null==s?void 0:s.canClaim)?"bg-orange-500/30 animate-pulse":"bg-dark-700")},e))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(fe,{to:"/friends",className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(z,{size:20,className:"text-blue-400 mb-2"}),a.jsx("h3",{className:"font-semibold text-white text-sm",children:"Invite Friends"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Earn 7% forever"})]}),a.jsxs(fe,{to:"/boosters",className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(S,{size:20,className:"text-purple-400 mb-2"}),a.jsx("h3",{className:"font-semibold text-white text-sm",children:"Boosters"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Multiply rewards"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-base font-bold text-white",children:"Tasks"}),a.jsxs(fe,{to:"/earn/tasks",className:"text-mint-400 text-xs flex items-center",children:["View all ",a.jsx(_,{size:14})]})]}),a.jsx("div",{className:"space-y-2",children:0===v.length?a.jsxs("div",{className:"text-center py-8 bg-dark-800 rounded-xl",children:[a.jsx(C,{size:32,className:"mx-auto mb-2 text-dark-600"}),a.jsx("p",{className:"text-dark-400 text-sm",children:"All tasks completed!"})]}):v.slice(0,3).map(e=>a.jsxs("div",{onClick:()=>(async e=>{Ce.hapticSelection(),"channel_join"===e.task_type&&e.target_channel?Ce.openTelegramLink(e.target_channel):e.target_url&&Ce.openLink(e.target_url)})(e),className:"bg-dark-800 rounded-xl p-4 border border-white/5 flex items-center gap-3 cursor-pointer active:scale-98",children:[a.jsx("div",{className:"w-10 h-10 bg-mint-500/20 rounded-xl flex items-center justify-center text-lg",children:"channel_join"===e.task_type?"üì¢":"üåê"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-white text-sm truncate",children:e.name}),a.jsx("p",{className:"text-xs text-dark-400 truncate",children:e.description})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-mint-400",children:["+",bt(e.user_reward_satz||e.reward_satz||0)]}),a.jsx("p",{className:"text-xs text-dark-500",children:"SATZ"})]})]},e.id))})]})]})]})}function is(){var e;const t=me(),{user:s,refreshUser:i}=ht(),[r,l]=he.useState(!1),[c,d]=he.useState(null),[x,m]=he.useState(!1),[h,u]=he.useState(!1),p=[{icon:D,title:"600 SATZ Weekly",desc:"~2,400 SATZ/month ($2.50 value)",highlight:!0},{icon:S,title:"2x Daily Bonus",desc:"10 SATZ vs 5 SATZ daily login"},{icon:W,title:"Ad-Free Experience",desc:"No interruptions, pure predictions"},{icon:E,title:"Exclusive Predictions",desc:"Premium-only high-stakes quests"},{icon:n,title:"Extra Spin",desc:"2 daily spins vs 1 for free users"},{icon:g,title:"Priority Withdrawals",desc:"Faster BTC withdrawals"}],b=async()=>{if(null==c?void 0:c.payAddress){await It(c.payAddress)&&(m(!0),Ce.hapticNotification("success"),setTimeout(()=>m(!1),2e3))}},f=async()=>{if(null==c?void 0:c.orderId){u(!0);try{const e=await xt.get(`/api/miniapp/premium/payment/${c.orderId}`);"completed"===e.status||e.isPremium?(Ce.hapticNotification("success"),i(),t("/earn")):(Ce.hapticNotification("warning"),alert("Payment not yet confirmed. Please wait a few minutes and try again."))}catch(e){alert("Failed to check payment status")}finally{u(!1)}}};return c?a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-40",children:[a.jsxs("div",{className:"sticky top-0 bg-dark-950/95 backdrop-blur-sm z-10 px-4 py-3 flex items-center gap-3 border-b border-white/5",children:[a.jsx("button",{onClick:()=>d(null),className:"p-2 -ml-2 text-dark-400 hover:text-white",children:a.jsx(B,{size:20})}),a.jsx("h1",{className:"text-lg font-bold text-white",children:"Complete Payment"})]}),a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-orange-500/20 to-yellow-500/10 border border-orange-500/30 rounded-2xl p-6 text-center",children:[a.jsx(D,{size:48,className:"text-orange-400 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Send USDT (BEP20)"}),a.jsx("p",{className:"text-dark-300 text-sm mb-4",children:"Send exactly the amount below to activate Premium"}),a.jsxs("div",{className:"bg-black/30 rounded-xl p-4 mb-4",children:[a.jsx("p",{className:"text-dark-400 text-xs mb-1",children:"Amount to send"}),a.jsxs("p",{className:"text-2xl font-bold text-orange-400",children:[c.payAmount," ",null==(e=c.payCurrency)?void 0:e.toUpperCase()]}),a.jsx("p",{className:"text-dark-500 text-sm",children:"‚âà $4.99 USD"})]}),a.jsxs("div",{className:"bg-black/30 rounded-xl p-4 mb-4",children:[a.jsx("p",{className:"text-dark-400 text-xs mb-2",children:"Send to this address"}),a.jsx("p",{className:"text-white text-sm font-mono break-all mb-3",children:c.payAddress}),a.jsxs("button",{onClick:b,className:"w-full py-2 bg-orange-500/20 text-orange-400 rounded-lg font-medium flex items-center justify-center gap-2",children:[x?a.jsx($,{size:18}):a.jsx(L,{size:18}),x?"Copied!":"Copy Address"]})]}),a.jsxs("div",{className:"text-dark-400 text-xs mb-4",children:[a.jsx("p",{children:"‚è±Ô∏è Payment expires in ~20 minutes"}),a.jsx("p",{className:"mt-1",children:"Confirmations required: 1"})]}),a.jsx("button",{onClick:f,disabled:h,className:"w-full py-4 bg-green-500 text-white rounded-xl font-bold flex items-center justify-center gap-2",children:h?a.jsx(R,{size:20,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx($,{size:20}),"I've Sent the Payment"]})})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4",children:[a.jsx("h3",{className:"font-medium text-white mb-2",children:"üí° How it works"}),a.jsxs("ol",{className:"text-dark-400 text-sm space-y-2",children:[a.jsx("li",{children:"1. Copy the USDT BEP20 address above"}),a.jsxs("li",{children:["2. Send exactly ",c.payAmount," USDT from your wallet"]}),a.jsx("li",{children:"3. Wait for 1 network confirmation (~10 min)"}),a.jsx("li",{children:'4. Click "I\'ve Sent the Payment" to check status'})]})]})]})]}):a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-40",children:[a.jsxs("div",{className:"sticky top-0 bg-dark-950/95 backdrop-blur-sm z-10 px-4 py-3 flex items-center gap-3 border-b border-white/5",children:[a.jsx("button",{onClick:()=>t(-1),className:"p-2 -ml-2 text-dark-400 hover:text-white",children:a.jsx(B,{size:20})}),a.jsx("h1",{className:"text-lg font-bold text-white",children:"Premium Membership"})]}),a.jsx("div",{className:"p-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-yellow-500/30 to-orange-500/20 border border-yellow-500/30 rounded-2xl p-6 text-center",children:[a.jsx("div",{className:"w-20 h-20 bg-yellow-500/30 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Z,{size:40,className:"text-yellow-400"})}),a.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Go Premium"}),a.jsx("p",{className:"text-dark-300 mb-4",children:"Stack more SATZ, enjoy premium perks"}),a.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[a.jsx("span",{className:"text-4xl font-bold text-white",children:"$4.99"}),a.jsx("span",{className:"text-dark-400",children:"/month"})]}),a.jsx("p",{className:"text-yellow-400 text-sm",children:"Get ~2,850 SATZ/month ($3+ value) for just $4.99!"})]})}),a.jsxs("div",{className:"px-4 space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-dark-400 uppercase tracking-wide",children:"What you get"}),p.map((e,t)=>a.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-center gap-4 p-4 rounded-xl border "+(e.highlight?"bg-yellow-500/10 border-yellow-500/30":"bg-dark-800 border-white/5"),children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+(e.highlight?"bg-yellow-500/20":"bg-dark-700"),children:a.jsx(e.icon,{size:24,className:e.highlight?"text-yellow-400":"text-dark-300"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-white",children:e.title}),a.jsx("p",{className:"text-sm text-dark-400",children:e.desc})]}),a.jsx($,{size:20,className:"text-green-400"})]},e.title))]}),a.jsxs("div",{className:"px-4 mt-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-dark-400 uppercase tracking-wide mb-3",children:"Payment"}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 flex items-center gap-3",children:[a.jsx(D,{size:24,className:"text-orange-400"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-white font-medium",children:"Pay with USDT (BEP20)"}),a.jsx("p",{className:"text-dark-400 text-sm",children:"Secure crypto payment via NOWPayments"})]})]})]}),a.jsxs("div",{className:"fixed bottom-16 left-0 right-0 p-4 bg-gradient-to-t from-dark-950 via-dark-950 to-transparent",children:[a.jsx("button",{onClick:async()=>{l(!0);try{Ce.hapticImpact("medium");const e=await xt.post("/api/miniapp/premium/subscribe",{currency:"usdtbsc"});e.payAddress?(d(e),Ce.hapticNotification("success")):e.success&&(Ce.hapticNotification("success"),i(),t("/earn"))}catch(e){alert(e.message||"Payment failed")}finally{l(!1)}},disabled:r||(null==s?void 0:s.is_premium),className:"w-full py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2 "+((null==s?void 0:s.is_premium)?"bg-dark-700 text-dark-400":"bg-gradient-to-r from-yellow-500 to-orange-500 text-black shadow-lg shadow-yellow-500/25 hover:shadow-yellow-500/40"),children:r?a.jsx(R,{size:24,className:"animate-spin"}):(null==s?void 0:s.is_premium)?"‚úì Already Premium":a.jsxs(a.Fragment,{children:[a.jsx(D,{size:20}),"Subscribe for $4.99/month"]})}),a.jsx("p",{className:"text-center text-dark-500 text-xs mt-3",children:"Secure payment ‚Ä¢ Instant activation after confirmation"})]})]})}const rs=5e4;function ns(){me();const{user:e,fetchUser:t}=ht(),{showToast:s}=lt(),[i,r]=he.useState([]),[l,c]=he.useState(1e5),[d,m]=he.useState(!0),[h,u]=he.useState(null),[p,b]=he.useState(!1);he.useEffect(()=>{f()},[]);const f=async()=>{m(!0);try{await Promise.all([t(!0),j(),v()])}catch(e){console.error("Wallet load error:",e)}finally{m(!1)}},j=async()=>{try{const e=await xt.get("/api/miniapp/user/transactions",{limit:10});r(e.transactions||[])}catch(e){console.error("Transactions fetch error:",e)}},v=async()=>{try{const e=await xt.get("/api/miniapp/public/stats");(null==e?void 0:e.btcPrice)&&(jt(e.btcPrice),c(e.btcPrice))}catch(e){console.error("BTC price fetch error:",e)}},y=Number(null==e?void 0:e.satz_balance)||0,w=wt(y,l),k=St(y);Ft((null==e?void 0:e.tier)||(null==e?void 0:e.status_tier)||"newcomer");return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-gradient-to-b from-dark-800 via-dark-850 to-dark-950 px-4 pt-6 pb-8",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"Your Balance"}),a.jsxs("h1",{className:"text-4xl font-black text-white mb-1",children:[bt(y),a.jsx("span",{className:"text-xl text-dark-400 ml-2",children:"SATZ"})]}),a.jsx("p",{className:"text-lg text-mint-400 font-medium",children:w}),a.jsx("p",{className:"text-xs text-dark-500 mt-1",children:"1 SATZ = 1 Satoshi"})]}),a.jsxs("div",{className:"bg-dark-800/70 rounded-2xl p-4 backdrop-blur-sm border border-white/5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[k.canWithdraw?a.jsx(O,{size:16,className:"text-green-400"}):a.jsx(I,{size:16,className:"text-dark-400"}),a.jsx("span",{className:"text-sm font-medium text-white",children:k.canWithdraw?"Ready to Withdraw!":"Progress to Withdrawal"})]}),a.jsxs("span",{className:"text-sm text-dark-400",children:[bt(y)," / ",bt(rs)]})]}),a.jsx("div",{className:"h-3 bg-dark-700 rounded-full overflow-hidden mb-3",children:a.jsx(o.div,{className:"h-full rounded-full "+(k.canWithdraw?"bg-gradient-to-r from-green-500 to-emerald-400":"bg-gradient-to-r from-mint-500 to-cyan-400"),initial:{width:0},animate:{width:`${k.percentage}%`},transition:{duration:1,ease:"easeOut"}})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs text-dark-400",children:k.canWithdraw?"üéâ You can withdraw now!":Ct(y)}),k.canWithdraw?a.jsx(fe,{to:"/wallet/redeem",className:"px-4 py-1.5 bg-green-500 text-white rounded-lg text-xs font-semibold",children:"Withdraw"}):a.jsxs("span",{className:"text-xs text-dark-500",children:[k.percentage.toFixed(0),"% complete"]})]})]})]}),a.jsxs("div",{className:"px-4 space-y-4 -mt-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(fe,{to:"/wallet/redeem",className:`p-4 rounded-xl border ${k.canWithdraw?"bg-green-500/10 border-green-500/30 hover:border-green-500":"bg-dark-800 border-white/5"} transition-colors`,children:[a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center mb-2 "+(k.canWithdraw?"bg-green-500/20":"bg-dark-700"),children:a.jsx(q,{size:20,className:k.canWithdraw?"text-green-400":"text-dark-400"})}),a.jsx("h3",{className:"font-semibold text-white text-sm",children:"Withdraw"}),a.jsx("p",{className:"text-xs text-dark-400",children:k.canWithdraw?"Ready!":`Min ${bt(rs)}`})]}),a.jsxs(fe,{to:"/wallet/transactions",className:"bg-dark-800 p-4 rounded-xl border border-white/5 hover:border-mint-500/30 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-xl flex items-center justify-center mb-2",children:a.jsx(U,{size:20,className:"text-dark-300"})}),a.jsx("h3",{className:"font-semibold text-white text-sm",children:"History"}),a.jsx("p",{className:"text-xs text-dark-400",children:"View all transactions"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-dark-800 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:ft((null==e?void 0:e.total_earned)||0)}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Total Earned"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:ft((null==e?void 0:e.total_won)||0)}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Prediction Wins"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:(null==e?void 0:e.referral_count)||0}),a.jsx("p",{className:"text-2xs text-dark-400",children:"Referrals"})]})]}),a.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(z,{size:18,className:"text-blue-400"}),a.jsx("span",{className:"font-semibold text-white",children:"Referral Earnings"})]}),a.jsx("span",{className:"text-sm text-blue-400 font-medium",children:"7% lifetime"})]}),a.jsx("p",{className:"text-xs text-dark-400 mb-3",children:"Earn 7% of everything your friends earn, forever!"}),a.jsx(o.button,{whileTap:{scale:.98},onClick:async()=>{(null==e?void 0:e.referral_code)&&(await It(`https://t.me/MintIQBot?start=${e.referral_code}`),b(!0),Ce.hapticNotification("success"),s("Referral link copied!","success"),setTimeout(()=>b(!1),2e3))},className:"w-full flex items-center justify-center gap-2 py-2.5 bg-blue-500/20 hover:bg-blue-500/30 rounded-xl transition-colors",children:p?a.jsxs(a.Fragment,{children:[a.jsx($,{size:16,className:"text-green-400"}),a.jsx("span",{className:"text-sm font-medium text-green-400",children:"Copied!"})]}):a.jsxs(a.Fragment,{children:[a.jsx(L,{size:16,className:"text-blue-400"}),a.jsx("span",{className:"text-sm font-medium text-blue-400",children:"Copy Referral Link"})]})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"font-bold text-white",children:"Recent Activity"}),a.jsxs(fe,{to:"/wallet/transactions",className:"text-mint-400 text-xs flex items-center",children:["View all ",a.jsx(_,{size:14})]})]}),0===i.length?a.jsxs("div",{className:"text-center py-8 bg-dark-800 rounded-xl",children:[a.jsx(U,{size:32,className:"mx-auto mb-2 text-dark-600"}),a.jsx("p",{className:"text-dark-400 text-sm",children:"No transactions yet"})]}):a.jsx("div",{className:"space-y-2",children:i.slice(0,5).map(e=>{const t=(s=e.type,{prediction_win:{icon:N,color:"text-green-400",bgColor:"bg-green-500/20",label:"Prediction Win"},prediction_bet:{icon:q,color:"text-red-400",bgColor:"bg-red-500/20",label:"Prediction"},daily_login:{icon:n,color:"text-gold-400",bgColor:"bg-gold-500/20",label:"Daily Reward"},daily_reward:{icon:n,color:"text-gold-400",bgColor:"bg-gold-500/20",label:"Daily Reward"},referral:{icon:z,color:"text-blue-400",bgColor:"bg-blue-500/20",label:"Referral"},task_reward:{icon:S,color:"text-purple-400",bgColor:"bg-purple-500/20",label:"Task"},spin_reward:{icon:n,color:"text-pink-400",bgColor:"bg-pink-500/20",label:"Spin"},welcome_bonus:{icon:n,color:"text-mint-400",bgColor:"bg-mint-500/20",label:"Welcome"},booster_purchase:{icon:S,color:"text-orange-400",bgColor:"bg-orange-500/20",label:"Booster"},redemption:{icon:q,color:"text-cyan-400",bgColor:"bg-cyan-500/20",label:"Withdrawal"}}[s]||{icon:g,color:"text-dark-400",bgColor:"bg-dark-700",label:s});var s;const i=t.icon,r=Number(e.amount)>0;return a.jsxs("div",{className:"bg-dark-800 rounded-xl p-3 flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${t.bgColor}`,children:a.jsx(i,{size:18,className:t.color})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-white truncate",children:e.description||t.label}),a.jsx("p",{className:"text-xs text-dark-500",children:Tt(e.created_at)})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold "+(r?"text-green-400":"text-red-400"),children:[r?"+":"",bt(e.amount)]}),a.jsx("p",{className:"text-xs text-dark-500",children:wt(Math.abs(e.amount),l)})]})]},e.id)})})]}),a.jsx("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-white/5",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(x,{size:18,className:"text-dark-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-white mb-1",children:"About SATZ"}),a.jsxs("p",{className:"text-xs text-dark-400",children:["1 SATZ = 1 satoshi = 0.00000001 BTC. Your SATZ is always backed 1:1 by real Bitcoin in our vault. Withdraw anytime once you reach ",bt(rs)," SATZ."]})]})]})})]})]})}function ls(){const[e,t]=he.useState(null);he.useEffect(()=>{s()},[]);const s=async()=>{try{const e=await xt.get("/api/miniapp/groups/my-stats");t(e)}catch(e){}};return a.jsx(fe,{to:"/groups",children:a.jsxs(o.div,{whileTap:{scale:.98},className:"bg-gradient-to-br from-purple-500/20 via-pink-500/10 to-orange-500/10 rounded-2xl p-5 border border-purple-500/30 relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-500/10 rounded-full blur-2xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-pink-500/10 rounded-full blur-2xl"}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center",children:a.jsx(z,{size:24,className:"text-purple-400"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-white text-lg",children:"Prediction Groups"}),a.jsx("p",{className:"text-sm text-purple-300/80",children:"Create ‚Ä¢ Compete ‚Ä¢ Earn"})]})]}),a.jsx("span",{className:"bg-purple-500/20 text-purple-400 text-xs font-bold px-2 py-1 rounded-full",children:"HOT üî•"})]}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:a.jsx(Z,{size:16,className:"text-gold-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-white",children:"Be a Group Admin"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Earn 5% from all group predictions"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:a.jsx(r,{size:16,className:"text-mint-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-white",children:"Create Custom Quests"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Set your own prediction topics"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:a.jsx(N,{size:16,className:"text-blue-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-white",children:"Private Leaderboards"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Compete with your community"})]})]})]}),(null==e?void 0:e.totalGroups)>0?a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("div",{className:"flex-1 bg-white/5 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xl font-bold text-white",children:e.groupsOwned||0}),a.jsx("p",{className:"text-xs text-dark-400",children:"Your Groups"})]}),a.jsxs("div",{className:"flex-1 bg-white/5 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-xl font-bold text-mint-400",children:ft(e.totalEarned||0)}),a.jsx("p",{className:"text-xs text-dark-400",children:"SATZ Earned"})]})]}):a.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-xl p-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(f,{size:18,className:"text-purple-400"}),a.jsx("span",{className:"text-sm font-medium text-white",children:"Create Your First Group"})]}),a.jsx(_,{size:18,className:"text-dark-400"})]})]})]})})}function cs(){const[e,t]=he.useState(0);he.useEffect(()=>{s()},[]);const s=async()=>{var e;try{const s=await xt.get("/api/miniapp/challenges/active");t((null==(e=s.challenges)?void 0:e.length)||0)}catch(s){}};return a.jsx(fe,{to:"/challenges",children:a.jsxs(o.div,{whileTap:{scale:.98},className:"bg-gradient-to-br from-orange-500/20 via-red-500/10 to-pink-500/10 rounded-2xl p-5 border border-orange-500/30 relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-orange-500/10 rounded-full blur-2xl"}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-orange-500/20 rounded-xl flex items-center justify-center",children:a.jsx(X,{size:24,className:"text-orange-400"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-white text-lg",children:"Challenges"}),a.jsx("p",{className:"text-sm text-orange-300/80",children:"Compete for big prizes"})]})]}),e>0&&a.jsxs("span",{className:"bg-orange-500 text-white text-xs font-bold px-2 py-1 rounded-full animate-pulse",children:[e," LIVE"]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[a.jsxs("div",{className:"bg-white/5 rounded-xl p-3",children:[a.jsx(S,{size:18,className:"text-orange-400 mb-1"}),a.jsx("p",{className:"text-xs font-medium text-white",children:"Weekly Contests"})]}),a.jsxs("div",{className:"bg-white/5 rounded-xl p-3",children:[a.jsx(n,{size:18,className:"text-pink-400 mb-1"}),a.jsx("p",{className:"text-xs font-medium text-white",children:"Prize Pools"})]})]}),a.jsxs("div",{className:"flex items-center justify-between bg-white/5 rounded-xl p-3",children:[a.jsx("span",{className:"text-sm font-medium text-white",children:"View Active Challenges"}),a.jsx(_,{size:18,className:"text-dark-400"})]})]})]})})}function os(){var e,t;const s=me(),{user:i,logout:r}=ht(),{showToast:n}=lt(),l=Ft((null==i?void 0:i.status_tier)||"newcomer"),c=[{icon:N,label:"Leaderboard",path:"/leaderboard",color:"text-gold-400",bg:"bg-gold-500/20"},{icon:z,label:"Friends",path:"/friends",color:"text-blue-400",bg:"bg-blue-500/20"},{icon:S,label:"Boosters",path:"/boosters",color:"text-purple-400",bg:"bg-purple-500/20"},{icon:Q,label:"My Stats",path:"/stats",color:"text-mint-400",bg:"bg-mint-500/20"}],d=[{icon:G,label:"Notifications",path:"/settings/notifications"},{icon:W,label:"Security",path:"/settings/security"},{icon:Y,label:"Help & Support",path:"/support"},{icon:V,label:"Language",path:"/settings/language"}];return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-gradient-to-b from-dark-800 to-dark-950 px-4 pt-6 pb-8",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-mint-500 to-cyan-500 rounded-2xl flex items-center justify-center text-2xl font-bold text-white",children:(null==(e=null==i?void 0:i.first_name)?void 0:e[0])||(null==(t=null==i?void 0:i.username)?void 0:t[0])||"?"}),l&&a.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center text-xs",style:{backgroundColor:l.color||"#10B981"},children:l.icon||"‚≠ê"})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-lg font-bold text-white",children:(null==i?void 0:i.first_name)||(null==i?void 0:i.username)||"User"}),a.jsx("p",{className:"text-sm text-dark-400 capitalize",children:(null==i?void 0:i.status_tier)||"Newcomer"})]}),a.jsx(fe,{to:"/settings",className:"p-2 bg-dark-800 rounded-xl",children:a.jsx(H,{size:20,className:"text-dark-400"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-6",children:[a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-white",children:(null==i?void 0:i.predictions_made)||0}),a.jsx("p",{className:"text-xs text-dark-400",children:"Predictions"})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsxs("p",{className:"text-lg font-bold text-mint-400",children:[(null==i?void 0:i.win_rate)||0,"%"]}),a.jsx("p",{className:"text-xs text-dark-400",children:"Win Rate"})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-3 text-center",children:[a.jsx("p",{className:"text-lg font-bold text-gold-400",children:(null==i?void 0:i.current_streak)||0}),a.jsx("p",{className:"text-xs text-dark-400",children:"Day Streak"})]})]})]}),a.jsxs("div",{className:"px-4 space-y-4 -mt-2",children:[a.jsx(ls,{}),a.jsx(cs,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-dark-400 mb-3 px-1",children:"Quick Links"}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:c.map(e=>a.jsxs(fe,{to:e.path,className:"bg-dark-800 rounded-xl p-3 text-center border border-white/5 hover:border-mint-500/30 transition-colors",children:[a.jsx("div",{className:`w-10 h-10 ${e.bg} rounded-xl flex items-center justify-center mx-auto mb-2`,children:a.jsx(e.icon,{size:20,className:e.color})}),a.jsx("p",{className:"text-xs text-white font-medium",children:e.label})]},e.path))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-dark-400 mb-3 px-1",children:"Settings"}),a.jsx("div",{className:"bg-dark-800 rounded-xl border border-white/5 divide-y divide-white/5",children:d.map(e=>a.jsxs(fe,{to:e.path,className:"flex items-center gap-3 p-4 hover:bg-dark-750 transition-colors",children:[a.jsx(e.icon,{size:20,className:"text-dark-400"}),a.jsx("span",{className:"flex-1 text-white text-sm",children:e.label}),a.jsx(_,{size:16,className:"text-dark-600"})]},e.path))})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-white/5",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"MintIQ"}),a.jsx("p",{className:"text-xs text-dark-500",children:"Version 1.0.0"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("a",{href:"https://twitter.com/mintiqworld",target:"_blank",className:"w-8 h-8 bg-dark-700 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"ùïè"})}),a.jsx("a",{href:"https://t.me/mintiqcommunity",target:"_blank",className:"w-8 h-8 bg-dark-700 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-sm",children:"üì¢"})})]})]})}),a.jsxs(o.button,{whileTap:{scale:.98},onClick:async()=>{Ce.hapticImpact("medium");try{await r(),s("/"),n("Logged out successfully","success")}catch(e){n("Logout failed","error")}},className:"w-full bg-red-500/10 text-red-400 rounded-xl p-4 font-medium flex items-center justify-center gap-2 border border-red-500/20",children:[a.jsx(J,{size:18}),"Log Out"]})]}),a.jsx("div",{className:"h-4"})]})]})}const ds=[{count:1,bonus:100,label:"First Friend"},{count:5,bonus:500,label:"5 Friends"},{count:10,bonus:1500,label:"10 Friends"},{count:25,bonus:5e3,label:"25 Friends"},{count:50,bonus:15e3,label:"50 Friends"},{count:100,bonus:5e4,label:"100 Friends"}];function xs(){const{user:e,fetchUser:t}=ht(),{showToast:s}=lt(),[i,r]=he.useState(!1),[l,c]=he.useState([]),[d,x]=he.useState(null),[m,h]=he.useState(!0),[u,p]=he.useState("invite");he.useEffect(()=>{b()},[]);const b=async()=>{h(!0);try{await Promise.all([t(!0),f(),g()])}catch(e){console.error("Load error:",e)}finally{h(!1)}},f=async()=>{try{const e=await xt.get("/api/miniapp/referrals");c(e.referrals||[])}catch(e){console.error("Referrals fetch error:",e)}},g=async()=>{try{const e=await xt.get("/api/miniapp/referrals/stats");x(e)}catch(e){console.error("Stats fetch error:",e)}},j=(null==e?void 0:e.referral_count)||l.length||0,N=(null==d?void 0:d.totalEarned)||0,v=`https://t.me/MintIQBot?start=${(null==e?void 0:e.referral_code)||"ref"}`,w=ds.filter(e=>j>=e.count).pop(),k=ds.find(e=>j<e.count),S=k?(j-((null==w?void 0:w.count)||0))/(k.count-((null==w?void 0:w.count)||0))*100:100;return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsx("div",{className:"bg-gradient-to-b from-blue-500/10 to-dark-950 px-4 pt-6 pb-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(z,{size:32,className:"text-blue-400"})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Invite & Earn"}),a.jsxs("p",{className:"text-dark-400",children:["Earn ",a.jsx("span",{className:"text-mint-400 font-bold",children:"7% lifetime"})," from your friends' earnings"]})]})}),a.jsxs("div",{className:"px-4 -mt-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 text-center border border-white/5",children:[a.jsx("p",{className:"text-3xl font-black text-white",children:j}),a.jsx("p",{className:"text-xs text-dark-400",children:"Friends Invited"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 text-center border border-white/5",children:[a.jsx("p",{className:"text-3xl font-black text-mint-400",children:ft(N)}),a.jsx("p",{className:"text-xs text-dark-400",children:"SATZ Earned"})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-purple-500/10 rounded-2xl p-5 border border-blue-500/20",children:[a.jsxs("h2",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[a.jsx(C,{size:18,className:"text-blue-400"}),"How It Works"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:"1"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"Share your link"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Friends join using your unique code"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:"2"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"They get 150 SATZ bonus"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Welcome bonus for new users"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-mint-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0",children:"3"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"You earn 7% forever"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Every time they win, you earn too!"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx("p",{className:"text-xs text-dark-400 mb-2",children:"Your referral link"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"flex-1 bg-dark-700 rounded-lg px-3 py-2.5 text-sm text-dark-300 truncate",children:v}),a.jsxs(o.button,{whileTap:{scale:.95},onClick:async()=>{const t=`https://t.me/MintIQBot?start=${(null==e?void 0:e.referral_code)||"ref"}`;await It(t),r(!0),Ce.hapticNotification("success"),s("Link copied!","success"),setTimeout(()=>r(!1),2e3)},className:"px-4 py-2.5 rounded-lg font-medium flex items-center gap-2 transition-colors "+(i?"bg-green-500 text-white":"bg-mint-500 text-white"),children:[i?a.jsx($,{size:18}):a.jsx(L,{size:18}),i?"Copied":"Copy"]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>{Ce.hapticSelection();const t=`https://t.me/MintIQBot?start=${(null==e?void 0:e.referral_code)||"ref"}`,s=`üéØ Join me on MintIQ!\n\nPredict crypto & earn real Bitcoin.\n\n‚ú® Get 150 SATZ bonus when you join!\n\n${t}`;Ce.shareUrl(t,s)},className:"bg-blue-500 rounded-xl p-4 text-white font-medium flex items-center justify-center gap-2",children:[a.jsx(y,{size:18}),"Share Link"]}),a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>{Ce.hapticSelection();const t=`https://t.me/MintIQBot?start=${(null==e?void 0:e.referral_code)||"ref"}`;Ce.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(t)}&text=${encodeURIComponent("üéØ Join me on MintIQ! Predict crypto & earn Bitcoin. Get 150 SATZ bonus!")}`)},className:"bg-dark-800 rounded-xl p-4 text-white font-medium flex items-center justify-center gap-2 border border-white/5",children:[a.jsx(K,{size:18}),"Invite Contact"]})]})]}),k&&a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Z,{size:16,className:"text-gold-400"}),a.jsx("span",{className:"font-medium text-white text-sm",children:"Next Milestone"})]}),a.jsxs("span",{className:"text-gold-400 font-bold",children:["+",bt(k.bonus)," SATZ"]})]}),a.jsx("div",{className:"h-2 bg-dark-700 rounded-full overflow-hidden mb-2",children:a.jsx(o.div,{className:"h-full bg-gradient-to-r from-gold-500 to-orange-500 rounded-full",initial:{width:0},animate:{width:`${S}%`},transition:{duration:.5}})}),a.jsxs("div",{className:"flex justify-between text-xs text-dark-400",children:[a.jsxs("span",{children:[j," friends"]}),a.jsxs("span",{children:[k.count," friends"]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"font-bold text-white",children:"Your Referrals"}),a.jsxs("span",{className:"text-xs text-dark-400",children:[j," total"]})]}),0===l.length?a.jsxs("div",{className:"text-center py-8 bg-dark-800 rounded-xl",children:[a.jsx(z,{size:40,className:"mx-auto mb-3 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No referrals yet"}),a.jsx("p",{className:"text-dark-500 text-sm mt-1",children:"Share your link to start earning!"})]}):a.jsx("div",{className:"space-y-2",children:l.slice(0,10).map((e,t)=>{var s,i;return a.jsxs("div",{className:"bg-dark-800 rounded-xl p-3 flex items-center gap-3 border border-white/5",children:[a.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-full flex items-center justify-center text-lg",children:(null==(s=e.first_name)?void 0:s[0])||(null==(i=e.username)?void 0:i[0])||"üë§"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-white text-sm truncate",children:e.first_name||e.username||"Anonymous"}),a.jsxs("p",{className:"text-xs text-dark-500",children:["Joined ",new Date(e.created_at).toLocaleDateString()]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-mint-400 font-bold text-sm",children:["+",bt(e.commission_earned||0)]}),a.jsx("p",{className:"text-xs text-dark-500",children:"earned"})]})]},e.id||t)})})]}),a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-white/5",children:[a.jsxs("h3",{className:"font-semibold text-white text-sm mb-3 flex items-center gap-2",children:[a.jsx(n,{size:16,className:"text-gold-400"}),"Milestone Bonuses"]}),a.jsx("div",{className:"space-y-2",children:ds.map(e=>{const t=j>=e.count;return a.jsxs("div",{className:"flex items-center justify-between py-2 "+(t?"opacity-60":""),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs "+(t?"bg-green-500/20 text-green-400":"bg-dark-700 text-dark-400"),children:t?"‚úì":e.count}),a.jsx("span",{className:"text-sm "+(t?"text-dark-400":"text-white"),children:e.label})]}),a.jsxs("span",{className:"font-bold "+(t?"text-dark-500":"text-gold-400"),children:["+",bt(e.bonus)]})]},e.count)})})]})]})]})}function ms(){const{user:e,fetchUser:t}=ht(),{showToast:s}=lt(),[i,r]=he.useState("pending"),[n,l]=he.useState([]),[c,d]=he.useState([]),[x,m]=he.useState(!0),[h,u]=he.useState(!1),[b,g]=he.useState(null),[j,N]=he.useState(""),[v,y]=he.useState(50),[k,S]=he.useState(!1);he.useEffect(()=>{C(),_()},[i]);const C=async()=>{m(!0);try{const e=await xt.get(`/api/miniapp/challenges?status=${i}`);l(e.challenges||[])}catch(e){l([])}finally{m(!1)}},_=async()=>{try{const e=await xt.get("/api/miniapp/friends");d(e.friends||[])}catch(e){d([])}};return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-dark-900 border-b border-white/5 px-4 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h1",{className:"text-xl font-bold text-white flex items-center gap-2",children:[a.jsx(ee,{className:"text-orange-400",size:24}),"Challenges"]}),a.jsxs(o.button,{whileTap:{scale:.95},onClick:()=>u(!0),className:"px-4 py-2 bg-orange-500 text-white rounded-xl font-medium flex items-center gap-2",children:[a.jsx(f,{size:18})," New"]})]}),a.jsx("div",{className:"flex bg-dark-800 rounded-xl p-1",children:[{id:"pending",label:"Pending"},{id:"active",label:"Active"},{id:"completed",label:"History"}].map(e=>a.jsx("button",{onClick:()=>{Ce.hapticSelection(),r(e.id)},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all "+(i===e.id?"bg-orange-500 text-white":"text-dark-400"),children:e.label},e.id))})]}),a.jsx("div",{className:"p-4 space-y-3",children:x?[...Array(3)].map((e,t)=>a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 animate-pulse",children:[a.jsx("div",{className:"h-5 bg-dark-700 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-4 bg-dark-700 rounded w-1/2"})]},t)):0===n.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ee,{size:48,className:"mx-auto mb-4 text-dark-600"}),a.jsxs("p",{className:"text-dark-400 font-medium",children:["No ",i," challenges"]}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"Create a challenge to battle friends!"})]}):n.map(i=>{var r;const n=(null==(r=i.challenger)?void 0:r.id)===(null==e?void 0:e.id)||i.challenger_id===(null==e?void 0:e.id),l=n?i.challenged:i.challenger,c="pending"===i.status&&!n,d=i.winner_id===(null==e?void 0:e.id);return a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-dark-800 rounded-xl p-4 border "+(c?"border-orange-500/50":"border-white/5"),children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-white",children:i.title}),a.jsxs("p",{className:"text-sm text-dark-400 mt-1",children:[n?"You challenged":"Challenged by"," ",a.jsxs("span",{className:"text-mint-400",children:["@",(null==l?void 0:l.username)||(null==l?void 0:l.first_name)||"User"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold text-gold-400",children:bt(i.stake_amount)}),a.jsx("p",{className:"text-xs text-dark-500",children:"SATZ"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-xs text-dark-500 flex items-center gap-1",children:[a.jsx(T,{size:12}),Tt(i.created_at)]}),c?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>(async e=>{Ce.hapticSelection();try{await xt.post(`/api/miniapp/challenges/${e}/decline`),s("Challenge declined","info"),C()}catch(t){s("Failed to decline","error")}})(i.id),className:"px-4 py-1.5 bg-dark-700 text-dark-300 rounded-lg text-sm",children:"Decline"}),a.jsx("button",{onClick:()=>(async e=>{Ce.hapticImpact("medium");try{await xt.post(`/api/miniapp/challenges/${e}/accept`),Ce.hapticNotification("success"),s("Challenge accepted! üî•","success"),C(),t(!0)}catch(a){s(a.message||"Failed to accept","error")}})(i.id),className:"px-4 py-1.5 bg-orange-500 text-white rounded-lg text-sm",children:"Accept"})]}):a.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+("pending"===i.status?"bg-yellow-500/20 text-yellow-400":"active"===i.status||d?"bg-mint-500/20 text-mint-400":"bg-dark-700 text-dark-400"),children:"pending"===i.status&&n?"Waiting...":d?"üèÜ Won!":i.status})]})]},i.id)})}),a.jsx(w,{children:h&&a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/70 backdrop-blur-sm",onClick:()=>u(!1),children:a.jsxs(o.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25},onClick:e=>e.stopPropagation(),className:"absolute bottom-0 left-0 right-0 bg-dark-900 rounded-t-3xl",style:{maxHeight:"75vh"},children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[a.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[a.jsx(ee,{className:"text-orange-400",size:20}),"Create Challenge"]}),a.jsx("button",{onClick:()=>u(!1),className:"p-2 text-dark-400 hover:text-white",children:a.jsx(p,{size:20})})]}),a.jsxs("div",{className:"overflow-y-auto p-4 pb-24",style:{maxHeight:"calc(75vh - 60px)"},children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm text-dark-400 mb-2",children:"Prediction Challenge"}),a.jsx("input",{type:"text",value:j,onChange:e=>N(e.target.value),placeholder:"e.g., BTC hits $100K by Friday",className:"w-full bg-dark-800 rounded-xl px-4 py-3 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50"}),a.jsx("p",{className:"text-xs text-dark-500 mt-1",children:"Write a clear prediction that can be verified"})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm text-dark-400 mb-2",children:"Stake Amount"}),a.jsx("div",{className:"flex gap-2",children:[25,50,100,250,500].map(e=>a.jsx("button",{onClick:()=>y(e),className:"flex-1 py-2.5 rounded-xl text-sm font-medium "+(v===e?"bg-orange-500 text-white":"bg-dark-800 text-dark-400"),children:e},e))}),a.jsxs("div",{className:"flex justify-between mt-2 text-xs",children:[a.jsxs("span",{className:"text-dark-500",children:["Balance: ",a.jsxs("span",{className:"text-mint-400",children:[bt((null==e?void 0:e.satz_balance)||0)," SATZ"]})]}),a.jsxs("span",{className:"text-dark-500",children:["Winner gets: ",a.jsxs("span",{className:"text-yellow-400",children:[bt(2*v)," SATZ"]})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-sm text-dark-400 mb-2",children:"Challenge Friend"}),0===c.length?a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 text-center",children:[a.jsx(z,{size:24,className:"mx-auto mb-2 text-dark-500"}),a.jsx("p",{className:"text-dark-400 text-sm",children:"No friends yet"})]}):a.jsx("div",{className:"space-y-2",children:c.map(e=>{var t;return a.jsxs("button",{onClick:()=>g(e),className:"w-full flex items-center gap-3 p-3 rounded-xl "+((null==b?void 0:b.id)===e.id?"bg-orange-500/20 border border-orange-500/50":"bg-dark-800 border border-transparent"),children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-dark-700 flex items-center justify-center text-white font-medium",children:(null==(t=e.first_name)?void 0:t[0])||"?"}),a.jsxs("div",{className:"flex-1 text-left",children:[a.jsx("p",{className:"font-medium text-white",children:e.first_name||e.username}),e.username&&a.jsxs("p",{className:"text-xs text-dark-400",children:["@",e.username]})]}),(null==b?void 0:b.id)===e.id&&a.jsx($,{size:16,className:"text-orange-400"})]},e.id)})})]}),a.jsx("button",{onClick:async()=>{if(b&&j.trim())if(v<10)s("Minimum stake is 10 SATZ","error");else if(((null==e?void 0:e.satz_balance)||0)<v)s("Insufficient balance","error");else{S(!0),Ce.hapticImpact("medium");try{await xt.post("/api/miniapp/challenges",{title:j.trim(),stake_amount:v,challenged_id:b.id}),Ce.hapticNotification("success"),s("Challenge sent! ‚öîÔ∏è","success"),u(!1),N(""),g(null),y(50),C(),t(!0)}catch(a){s(a.message||"Failed to create challenge","error")}finally{S(!1)}}else s("Please fill all fields","error")},disabled:k||!b||!j.trim()||((null==e?void 0:e.satz_balance)||0)<v,className:"w-full py-3.5 bg-orange-500 disabled:bg-dark-700 disabled:text-dark-500 text-white font-bold rounded-xl mt-4",children:k?"Creating...":`Send Challenge (${v} SATZ)`})]})]})})})]})}function hs({isOpen:e,onClose:t,onCreated:s}){const[i,r]=he.useState(""),[n,l]=he.useState(""),[c,d]=he.useState(!1),[x,m]=he.useState(!1),{showToast:h}=lt();return e?a.jsx(w,{children:a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 z-50 flex items-end justify-center",onClick:t,children:a.jsxs(o.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25},onClick:e=>e.stopPropagation(),className:"bg-dark-900 rounded-t-3xl w-full max-w-lg p-6 pb-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:"Create Group"}),a.jsx("button",{onClick:t,className:"p-2 text-dark-400 hover:text-white",children:a.jsx(p,{size:20})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-dark-400 mb-2 block",children:"Group Name"}),a.jsx("input",{type:"text",value:i,onChange:e=>r(e.target.value),placeholder:"e.g., Crypto Traders Club",className:"w-full bg-dark-800 rounded-xl px-4 py-3 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-mint-500/50",maxLength:50})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm text-dark-400 mb-2 block",children:"Description (optional)"}),a.jsx("textarea",{value:n,onChange:e=>l(e.target.value),placeholder:"What's your group about?",rows:3,className:"w-full bg-dark-800 rounded-xl px-4 py-3 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-mint-500/50 resize-none",maxLength:200})]}),a.jsxs("div",{className:"flex items-center justify-between bg-dark-800 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[c?a.jsx(I,{size:20,className:"text-purple-400"}):a.jsx(V,{size:20,className:"text-mint-400"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:c?"Private Group":"Public Group"}),a.jsx("p",{className:"text-xs text-dark-400",children:c?"Invite only":"Anyone can join"})]})]}),a.jsx("button",{onClick:()=>d(!c),className:"w-12 h-6 rounded-full transition-colors "+(c?"bg-purple-500":"bg-dark-600"),children:a.jsx("div",{className:"w-5 h-5 bg-white rounded-full transition-transform "+(c?"translate-x-6":"translate-x-0.5")})})]}),a.jsxs("div",{className:"bg-gold-500/10 border border-gold-500/30 rounded-xl p-4",children:[a.jsxs("p",{className:"font-medium text-gold-400 text-sm mb-2 flex items-center gap-2",children:[a.jsx(Z,{size:16})," Admin Benefits"]}),a.jsxs("ul",{className:"space-y-1 text-xs text-dark-300",children:[a.jsx("li",{children:"‚Ä¢ Earn 5% from all group predictions"}),a.jsx("li",{children:"‚Ä¢ Create custom prediction topics"}),a.jsx("li",{children:"‚Ä¢ Manage members and settings"}),a.jsx("li",{children:"‚Ä¢ Private leaderboard for your community"})]})]}),a.jsx(o.button,{whileTap:{scale:.98},onClick:async()=>{if(i.trim()){m(!0);try{const e=await xt.post("/api/miniapp/groups/create",{name:i.trim(),description:n.trim(),is_private:c});Ce.hapticNotification("success"),h("Group created!","success"),s(e.group),t()}catch(e){h(e.message||"Failed to create group","error")}finally{m(!1)}}else h("Please enter a group name","error")},disabled:x||!i.trim(),className:"w-full py-4 rounded-xl font-bold text-white transition-all "+(x||!i.trim()?"bg-dark-700 text-dark-400":"bg-gradient-to-r from-mint-500 to-cyan-500"),children:x?"Creating...":"Create Group"})]})]})})}):null}function us(){me();const{user:e}=ht(),{showToast:t}=lt(),[s,i]=he.useState("my"),[n,l]=he.useState([]),[c,d]=he.useState([]),[x,m]=he.useState(null),[h,u]=he.useState(!0),[p,b]=he.useState(!1),[g,j]=he.useState(""),[N,v]=he.useState(null);he.useEffect(()=>{y()},[s]);const y=async()=>{u(!0);try{if("my"===s){const[e,t]=await Promise.all([xt.get("/api/miniapp/groups/my"),xt.get("/api/miniapp/groups/admin-stats")]);l(e.groups||[]),m(t)}else{const e=await xt.get("/api/miniapp/groups/discover",{search:g});d(e.groups||[])}}catch(e){console.error("Groups fetch error:",e)}finally{u(!1)}};return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-gradient-to-b from-purple-500/10 to-dark-950 px-4 pt-4 pb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-white",children:"Prediction Groups"}),a.jsx("p",{className:"text-sm text-dark-400",children:"Create, compete & earn together"})]}),a.jsx(o.button,{whileTap:{scale:.95},onClick:()=>b(!0),className:"w-10 h-10 bg-mint-500 rounded-xl flex items-center justify-center",children:a.jsx(f,{size:20,className:"text-white"})})]}),a.jsxs("div",{className:"flex bg-dark-800 rounded-xl p-1",children:[a.jsx("button",{onClick:()=>i("my"),className:"flex-1 py-2.5 rounded-lg text-sm font-medium transition-all "+("my"===s?"bg-purple-500 text-white":"text-dark-400"),children:"My Groups"}),a.jsx("button",{onClick:()=>i("discover"),className:"flex-1 py-2.5 rounded-lg text-sm font-medium transition-all "+("discover"===s?"bg-purple-500 text-white":"text-dark-400"),children:"Discover"})]})]}),a.jsxs("div",{className:"px-4 space-y-4",children:["my"===s&&x&&x.totalEarned>0&&a.jsxs("div",{className:"bg-gradient-to-r from-gold-500/10 to-orange-500/10 border border-gold-500/30 rounded-xl p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(Z,{size:18,className:"text-gold-400"}),a.jsx("span",{className:"font-bold text-white",children:"Admin Earnings"})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xl font-black text-gold-400",children:ft(x.totalEarned)}),a.jsx("p",{className:"text-xs text-dark-400",children:"SATZ Earned"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xl font-black text-white",children:x.totalMembers||0}),a.jsx("p",{className:"text-xs text-dark-400",children:"Members"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-xl font-black text-mint-400",children:x.totalPredictions||0}),a.jsx("p",{className:"text-xs text-dark-400",children:"Predictions"})]})]})]}),"discover"===s&&a.jsxs("div",{className:"relative",children:[a.jsx(M,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-dark-400"}),a.jsx("input",{type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"Search groups...",className:"w-full bg-dark-800 rounded-xl pl-10 pr-4 py-3 text-white placeholder-dark-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50"})]}),h?[...Array(3)].map((e,t)=>a.jsx("div",{className:"bg-dark-800 rounded-xl p-4 animate-pulse",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-dark-700 rounded-xl"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-dark-700 rounded w-32 mb-2"}),a.jsx("div",{className:"h-3 bg-dark-700 rounded w-20"})]})]})},t)):"my"===s?0===n.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-20 h-20 bg-purple-500/20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:a.jsx(z,{size:40,className:"text-purple-400"})}),a.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"No Groups Yet"}),a.jsx("p",{className:"text-dark-400 text-sm mb-6 max-w-xs mx-auto",children:"Create your first group and start earning 5% from all predictions!"}),a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>b(!0),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-medium inline-flex items-center gap-2",children:[a.jsx(f,{size:18}),"Create Group"]})]}):a.jsx("div",{className:"space-y-3",children:n.map(e=>a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center text-xl",children:e.emoji||"üë•"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-bold text-white truncate",children:e.name}),e.is_admin&&a.jsx(Z,{size:14,className:"text-gold-400 flex-shrink-0"}),e.is_private&&a.jsx(I,{size:12,className:"text-purple-400 flex-shrink-0"})]}),a.jsxs("p",{className:"text-xs text-dark-400",children:[e.member_count||0," members ‚Ä¢ ",e.active_quests||0," active predictions"]})]})]}),e.is_admin&&a.jsxs("div",{className:"flex gap-2 mb-3",children:[a.jsxs("div",{className:"flex-1 bg-dark-700 rounded-lg p-2 text-center",children:[a.jsx("p",{className:"text-sm font-bold text-gold-400",children:bt(e.admin_earnings||0)}),a.jsx("p",{className:"text-2xs text-dark-500",children:"Earned"})]}),a.jsxs("div",{className:"flex-1 bg-dark-700 rounded-lg p-2 text-center",children:[a.jsx("p",{className:"text-sm font-bold text-white",children:e.total_predictions||0}),a.jsx("p",{className:"text-2xs text-dark-500",children:"Predictions"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{to:`/groups/${e.id}`,className:"flex-1 py-2 bg-purple-500 text-white rounded-lg text-sm font-medium text-center",children:"Open"}),a.jsxs("button",{onClick:()=>(async e=>{const s=`https://t.me/MintIQBot?start=group_${e.invite_code}`;await It(s),v(e.id),Ce.hapticNotification("success"),t("Invite link copied!","success"),setTimeout(()=>v(null),2e3)})(e),className:"px-4 py-2 bg-dark-700 text-white rounded-lg text-sm flex items-center gap-1",children:[N===e.id?a.jsx($,{size:14}):a.jsx(L,{size:14}),N===e.id?"Copied":"Invite"]}),e.is_admin&&a.jsx(fe,{to:`/groups/${e.id}/settings`,className:"px-3 py-2 bg-dark-700 text-dark-400 rounded-lg",children:a.jsx(H,{size:16})})]})]},e.id))}):0===c.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(M,{size:40,className:"mx-auto mb-4 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No groups found"}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"Try a different search or create your own!"})]}):a.jsx("div",{className:"space-y-3",children:c.map(e=>a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 bg-mint-500/20 rounded-xl flex items-center justify-center text-xl",children:e.emoji||"üéØ"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-white truncate",children:e.name}),a.jsx("p",{className:"text-xs text-dark-400 truncate",children:e.description||"No description"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4 text-xs text-dark-400",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(z,{size:12})," ",e.member_count||0]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(r,{size:12})," ",e.total_predictions||0," predictions"]})]}),a.jsxs(o.button,{whileTap:{scale:.95},onClick:()=>(async e=>{Ce.hapticSelection();try{await xt.post(`/api/miniapp/groups/${e.id}/join`),t("Joined group!","success"),y()}catch(s){t(s.message||"Failed to join","error")}})(e),className:"px-4 py-2 bg-mint-500 text-white rounded-lg text-sm font-medium flex items-center gap-1",children:[a.jsx(K,{size:14}),"Join"]})]})]},e.id))}),"my"===s&&n.length>0&&a.jsxs(o.button,{whileTap:{scale:.98},onClick:()=>b(!0),className:"w-full py-4 bg-dark-800 border border-dashed border-purple-500/50 rounded-xl text-purple-400 font-medium flex items-center justify-center gap-2",children:[a.jsx(f,{size:18}),"Create Another Group"]})]}),a.jsx(hs,{isOpen:p,onClose:()=>b(!1),onCreated:e=>{l([e,...n]),i("my")}})]})}function ps(){const{groupId:e}=je(),t=me(),[s,i]=he.useState(null),[r,n]=he.useState([]),[l,c]=he.useState(!0),[d,x]=he.useState(!1);he.useEffect(()=>{m()},[e]);const m=async()=>{c(!0);try{const t=await xt.get(`/api/miniapp/groups/${e}`);i(t.group),n(t.members||[])}catch(t){console.error("Failed to fetch group:",t)}finally{c(!1)}},h=()=>{Ce.hapticImpact("light"),Ce.shareUrl(`https://t.me/MintIQBot?start=group_${s.invite_code}`,`üéØ Join my prediction group "${s.name}" on MintIQ!`)};if(l)return a.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full"})});if(!s)return a.jsxs("div",{className:"min-h-screen bg-dark-950 flex flex-col items-center justify-center p-4",children:[a.jsx(z,{size:48,className:"text-dark-600 mb-4"}),a.jsx("p",{className:"text-dark-400",children:"Group not found"}),a.jsx("button",{onClick:()=>t("/groups"),className:"mt-4 text-purple-400",children:"Go Back"})]});const u="admin"===s.your_role;return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"sticky top-0 bg-dark-950/95 backdrop-blur-sm z-10 px-4 py-3 flex items-center gap-3 border-b border-white/5",children:[a.jsx("button",{onClick:()=>t("/groups"),className:"p-2 -ml-2 text-dark-400 hover:text-white",children:a.jsx(B,{size:20})}),a.jsx("h1",{className:"text-lg font-bold text-white flex-1",children:s.name}),u&&a.jsx("button",{onClick:async()=>{if(window.confirm(`Delete "${s.name}"? This cannot be undone.`))try{await xt.delete(`/api/miniapp/groups/${e}`),Ce.hapticNotification("success"),t("/groups")}catch(a){alert(a.message||"Failed to delete")}},className:"p-2 text-red-400 hover:text-red-300",children:a.jsx(te,{size:18})})]}),a.jsx("div",{className:"p-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-14 h-14 bg-purple-500/20 rounded-full flex items-center justify-center",children:a.jsx(z,{size:28,className:"text-purple-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h2",{className:"text-xl font-bold text-white",children:s.name}),a.jsxs("p",{className:"text-dark-400 text-sm",children:[r.length||s.member_count||1," members"]})]}),u&&a.jsx(Z,{size:20,className:"text-gold-400"})]}),s.description&&a.jsx("p",{className:"text-dark-300 text-sm mb-4",children:s.description}),a.jsx("div",{className:"bg-dark-900 rounded-lg p-3 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-dark-400 mb-1",children:"Invite Code"}),a.jsx("code",{className:"text-lg text-purple-400 font-mono font-bold",children:s.invite_code})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:async()=>{(null==s?void 0:s.invite_code)&&(await navigator.clipboard.writeText(s.invite_code),x(!0),Ce.hapticNotification("success"),setTimeout(()=>x(!1),2e3))},className:"p-2 bg-dark-800 rounded-lg text-dark-400 hover:text-white",children:d?a.jsx($,{size:18,className:"text-green-400"}):a.jsx(L,{size:18})}),a.jsx("button",{onClick:h,className:"p-2 bg-purple-500 rounded-lg text-white",children:a.jsx(K,{size:18})})]})]})}),a.jsxs("button",{onClick:h,className:"w-full py-3 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-xl flex items-center justify-center gap-2",children:[a.jsx(K,{size:18})," Invite Friends"]})]})}),a.jsxs("div",{className:"px-4",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"Members"}),a.jsx("div",{className:"bg-dark-800 rounded-xl border border-white/5 divide-y divide-white/5",children:r.length>0?r.map(e=>{var t;return a.jsxs("div",{className:"flex items-center gap-3 p-4",children:[a.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-full flex items-center justify-center text-white font-bold",children:(null==(t=e.first_name)?void 0:t[0])||"?"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-white font-medium",children:[e.first_name," ",e.last_name||""]}),a.jsxs("p",{className:"text-xs text-dark-400",children:["@",e.username||"anonymous"]})]}),"admin"===e.role&&a.jsx(Z,{size:14,className:"text-gold-400"})]},e.user_id)}):a.jsx("div",{className:"p-4 text-center text-dark-400",children:a.jsx("p",{children:"No members yet"})})})]})]})}const bs=[{id:"earnings",label:"Earnings",icon:g,color:"gold"},{id:"predictions",label:"Wins",icon:r,color:"mint"},{id:"referrals",label:"Referrals",icon:z,color:"blue"}],fs=[{id:"daily",label:"Today"},{id:"weekly",label:"This Week"},{id:"monthly",label:"This Month"},{id:"all",label:"All Time"}];function gs(){var e,t,s,i,r,n,l,c,d,x,m,h;const{user:u}=ht(),[p,b]=he.useState("earnings"),[f,g]=he.useState("weekly"),[j,v]=he.useState([]),[y,w]=he.useState(null),[k,S]=he.useState(!0);he.useEffect(()=>{C()},[p,f]);const C=async()=>{S(!0);try{const e=await xt.get("/api/miniapp/leaderboard",{type:p,period:f,limit:50});v(e.leaderboard||e.users||[]),w(e.userRank||null)}catch(e){console.error("Leaderboard fetch error:",e),v([])}finally{S(!1)}},_=e=>{switch(p){case"earnings":return bt(e.total_earned||e.earnings||0);case"predictions":return e.predictions_won||e.wins||0;case"referrals":return e.referral_count||e.referrals||0;default:return 0}},T=()=>{switch(p){case"earnings":return"SATZ";case"predictions":return"wins";case"referrals":return"friends";default:return""}};return bs.find(e=>e.id===p),a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsxs("div",{className:"bg-gradient-to-b from-dark-800 to-dark-950 px-4 pt-4 pb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx(N,{size:24,className:"text-gold-400"}),a.jsx("h1",{className:"text-xl font-bold text-white",children:"Leaderboard"})]}),a.jsx("div",{className:"flex bg-dark-800 rounded-xl p-1 mb-4",children:bs.map(e=>a.jsxs("button",{onClick:()=>(e=>{Ce.hapticSelection(),b(e)})(e.id),className:"flex-1 py-2.5 rounded-lg text-sm font-medium transition-all flex items-center justify-center gap-1.5 "+(p===e.id?`bg-${e.color}-500 text-white`:"text-dark-400 hover:text-dark-300"),style:{backgroundColor:p===e.id?"gold"===e.color?"#F59E0B":"mint"===e.color?"#10B981":"#3B82F6":"transparent"},children:[a.jsx(e.icon,{size:14}),e.label]},e.id))}),a.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide -mx-4 px-4",children:fs.map(e=>a.jsx("button",{onClick:()=>{return t=e.id,Ce.hapticSelection(),void g(t);var t},className:"px-4 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all "+(f===e.id?"bg-white text-dark-900":"bg-dark-800 text-dark-400"),children:e.label},e.id))})]}),y&&a.jsx("div",{className:"px-4 -mt-2 mb-4",children:a.jsx("div",{className:"bg-gradient-to-r from-mint-500/10 to-cyan-500/10 border border-mint-500/30 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-mint-500/20 rounded-full flex items-center justify-center",children:a.jsxs("span",{className:"text-xl font-bold text-mint-400",children:["#",y.rank]})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-white",children:"Your Rank"}),a.jsxs("p",{className:"text-sm text-dark-400",children:[_(y)," ",T()]})]}),y.rank<=10&&a.jsx("div",{className:"bg-mint-500/20 px-3 py-1 rounded-full",children:a.jsx("span",{className:"text-xs font-bold text-mint-400",children:"Top 10!"})})]})})}),a.jsx("div",{className:"px-4 space-y-2",children:k?[...Array(10)].map((e,t)=>a.jsx("div",{className:"bg-dark-800 rounded-xl p-4 animate-pulse",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-full"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-dark-700 rounded w-24 mb-1"}),a.jsx("div",{className:"h-3 bg-dark-700 rounded w-16"})]}),a.jsx("div",{className:"h-5 bg-dark-700 rounded w-16"})]})},t)):0===j.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(N,{size:48,className:"mx-auto mb-4 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No data yet"}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"Be the first on the leaderboard!"})]}):a.jsxs(a.Fragment,{children:[j.length>=3&&a.jsxs("div",{className:"flex items-end justify-center gap-2 mb-6 pt-4",children:[a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex-1 text-center",children:[a.jsx("div",{className:"w-14 h-14 mx-auto bg-gray-400/20 rounded-full flex items-center justify-center mb-2 border-2 border-gray-400",children:a.jsx("span",{className:"text-lg font-bold text-gray-300",children:(null==(t=null==(e=j[1])?void 0:e.first_name)?void 0:t[0])||"2"})}),a.jsx("p",{className:"text-sm font-medium text-white truncate px-1",children:(null==(s=j[1])?void 0:s.first_name)||(null==(i=j[1])?void 0:i.username)||"Anonymous"}),a.jsx("p",{className:"text-xs text-gray-400",children:_(j[1])}),a.jsx("div",{className:"mt-2 bg-gray-400/20 rounded-t-lg h-16 flex items-center justify-center",children:a.jsx("span",{className:"text-2xl",children:"ü•à"})})]}),a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex-1 text-center",children:[a.jsx("div",{className:"w-16 h-16 mx-auto bg-gold-500/20 rounded-full flex items-center justify-center mb-2 border-2 border-gold-500 ring-4 ring-gold-500/20",children:a.jsx("span",{className:"text-xl font-bold text-gold-400",children:(null==(n=null==(r=j[0])?void 0:r.first_name)?void 0:n[0])||"1"})}),a.jsx("p",{className:"text-sm font-bold text-white truncate px-1",children:(null==(l=j[0])?void 0:l.first_name)||(null==(c=j[0])?void 0:c.username)||"Anonymous"}),a.jsx("p",{className:"text-xs text-gold-400 font-medium",children:_(j[0])}),a.jsx("div",{className:"mt-2 bg-gold-500/20 rounded-t-lg h-24 flex items-center justify-center",children:a.jsx("span",{className:"text-3xl",children:"ü•á"})})]}),a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"flex-1 text-center",children:[a.jsx("div",{className:"w-14 h-14 mx-auto bg-orange-600/20 rounded-full flex items-center justify-center mb-2 border-2 border-orange-600",children:a.jsx("span",{className:"text-lg font-bold text-orange-400",children:(null==(x=null==(d=j[2])?void 0:d.first_name)?void 0:x[0])||"3"})}),a.jsx("p",{className:"text-sm font-medium text-white truncate px-1",children:(null==(m=j[2])?void 0:m.first_name)||(null==(h=j[2])?void 0:h.username)||"Anonymous"}),a.jsx("p",{className:"text-xs text-orange-400",children:_(j[2])}),a.jsx("div",{className:"mt-2 bg-orange-600/20 rounded-t-lg h-12 flex items-center justify-center",children:a.jsx("span",{className:"text-2xl",children:"ü•â"})})]})]}),j.slice(3).map((e,t)=>{const s=t+4,i=e.id===(null==u?void 0:u.id)||e.telegram_id===(null==u?void 0:u.telegram_id);return a.jsxs(o.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.02*t},className:"bg-dark-800 rounded-xl p-3 flex items-center gap-3 border "+(i?"border-mint-500/50 bg-mint-500/5":"border-white/5"),children:[a.jsxs("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm "+(i?"bg-mint-500/20 text-mint-400":"bg-dark-700 text-dark-400"),children:["#",s]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"font-medium text-sm truncate "+(i?"text-mint-400":"text-white"),children:[e.first_name||e.username||"Anonymous",i&&a.jsx("span",{className:"text-xs ml-1",children:"(You)"})]}),e.status_tier&&a.jsx("p",{className:"text-xs text-dark-500 capitalize",children:e.status_tier})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-bold "+("earnings"===p?"text-gold-400":"predictions"===p?"text-mint-400":"text-blue-400"),children:_(e)}),a.jsx("p",{className:"text-xs text-dark-500",children:T()})]})]},e.id||t)})]})}),a.jsx("div",{className:"px-4 mt-6",children:a.jsxs("div",{className:"bg-dark-800/50 rounded-xl p-4 border border-white/5",children:[a.jsxs("h3",{className:"font-semibold text-white text-sm mb-2 flex items-center gap-2",children:[a.jsx(E,{size:14,className:"text-gold-400"}),"Climb the Ranks"]}),a.jsxs("p",{className:"text-xs text-dark-400",children:["earnings"===p&&"Win predictions and complete tasks to earn more SATZ and climb the leaderboard.","predictions"===p&&"Make accurate predictions to increase your win count and show off your skills.","referrals"===p&&"Invite more friends to join MintIQ and earn lifetime commissions."]})]})})]})}function js(){const[e,t]=he.useState(null),[s,i]=he.useState(!0),[r,n]=he.useState(null);he.useEffect(()=>{l()},[]);const l=async()=>{i(!0),n(null);try{const e=await xt.get("/api/miniapp/vault");t(e.vault)}catch(e){console.error("Failed to fetch vault:",e),n("Failed to load vault data")}finally{i(!1)}};if(s)return a.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full"})});if(r)return a.jsxs("div",{className:"min-h-screen bg-dark-950 flex flex-col items-center justify-center p-4",children:[a.jsx(D,{size:48,className:"text-dark-600 mb-4"}),a.jsx("p",{className:"text-dark-400 mb-4",children:r}),a.jsxs("button",{onClick:l,className:"px-6 py-2 bg-orange-500 text-white rounded-xl font-medium flex items-center gap-2",children:[a.jsx(se,{size:16})," Retry"]})]});const c=parseFloat((null==e?void 0:e.balance_btc)||0),d=(null==e?void 0:e.balance_satoshis)||0,x=(null==e?void 0:e.usd_value)||0,m=Math.min(100,c/1*100),h=(null==e?void 0:e.circulating_satz)||0,u=(null==e?void 0:e.satz_to_satoshi_rate)||0;return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-orange-500/20 to-orange-900/20 border border-orange-500/30 rounded-xl p-6",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(o.div,{animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"linear"},className:"w-20 h-20 rounded-full bg-orange-500/20 flex items-center justify-center",children:a.jsx(D,{size:48,className:"text-orange-500"})})}),a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"BTC Vault Balance"}),a.jsxs("h1",{className:"text-3xl font-bold text-orange-500",children:[(b=c,b&&0!==b?parseFloat(b).toFixed(8):"0.00000000")," BTC"]}),a.jsx("p",{className:"text-lg text-dark-300",children:(p=x,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p||0))}),a.jsxs("p",{className:"text-sm text-dark-500 mt-1",children:[d.toLocaleString()," satoshis"]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[a.jsx("span",{className:"text-dark-400",children:"Progress to 1 BTC"}),a.jsxs("span",{className:"text-orange-400",children:[m.toFixed(4),"%"]})]}),a.jsx("div",{className:"h-3 bg-dark-800 rounded-full overflow-hidden",children:a.jsx(o.div,{initial:{width:0},animate:{width:`${m}%`},className:"h-full bg-gradient-to-r from-orange-500 to-yellow-500 rounded-full"})})]}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-dark-400",children:[a.jsx(W,{size:14,className:"text-green-400"}),a.jsx("span",{children:"Secured & Verified"})]})]})}),a.jsxs("div",{className:"px-4 mb-4",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"Vault Statistics"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(ae,{size:20,className:"text-purple-400 mb-2"}),a.jsx("p",{className:"text-lg font-bold text-white",children:bt(h)}),a.jsx("p",{className:"text-xs text-dark-400",children:"Circulating SATZ"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(g,{size:20,className:"text-green-400 mb-2"}),a.jsx("p",{className:"text-lg font-bold text-white",children:u.toFixed(8)}),a.jsx("p",{className:"text-xs text-dark-400",children:"SATZ ‚Üí Satoshi Rate"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(I,{size:20,className:"text-orange-400 mb-2"}),a.jsx("p",{className:"text-lg font-bold text-white",children:bt((null==e?void 0:e.total_inflow)||0)}),a.jsx("p",{className:"text-xs text-dark-400",children:"Total Inflow (SATZ)"})]}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(D,{size:20,className:"text-red-400 mb-2"}),a.jsx("p",{className:"text-lg font-bold text-white",children:bt((null==e?void 0:e.total_outflow)||0)}),a.jsx("p",{className:"text-xs text-dark-400",children:"Total Outflow (SATZ)"})]})]})]}),a.jsxs("div",{className:"px-4",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"How It Works"}),a.jsxs("div",{className:"bg-dark-800 rounded-xl p-4 border border-white/5 space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs text-orange-400 font-bold",children:"1"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Earn SATZ"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Win predictions & complete tasks"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs text-orange-400 font-bold",children:"2"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Vault Fills"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Revenue funds the BTC vault"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-500/20 flex items-center justify-center text-xs text-orange-400 font-bold",children:"3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-white text-sm font-medium",children:"Redeem BTC"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Exchange SATZ for real Bitcoin"})]})]})]})]})]});var p,b}const Ns=[{id:"all",label:"All",icon:ie},{id:"frames",label:"Frames",icon:re},{id:"badges",label:"Badges",icon:X},{id:"effects",label:"Effects",icon:C}],vs={common:"text-gray-400 bg-gray-500/20",rare:"text-blue-400 bg-blue-500/20",epic:"text-purple-400 bg-purple-500/20",legendary:"text-gold-400 bg-gold-500/20"},ys=[{id:1,category:"frames",key:"frame_gold",name:"Gold Frame",price:5e3,rarity:"rare",icon:"ü™ô",description:"A shiny gold frame for your profile"},{id:2,category:"frames",key:"frame_diamond",name:"Diamond Frame",price:15e3,rarity:"epic",icon:"üíé",description:"Dazzling diamond frame"},{id:3,category:"frames",key:"frame_fire",name:"Fire Frame",price:1e4,rarity:"rare",icon:"üî•",description:"For hot predictors"},{id:4,category:"badges",key:"badge_early_adopter",name:"Early Adopter",price:2500,rarity:"common",icon:"‚≠ê",description:"Show you were here from the start"},{id:5,category:"badges",key:"badge_whale",name:"Whale Badge",price:25e3,rarity:"legendary",icon:"üêã",description:"For the big players"},{id:6,category:"badges",key:"badge_lucky",name:"Lucky Charm",price:7500,rarity:"rare",icon:"üçÄ",description:"+1% mystery box chance",effect:"+1% mystery box"},{id:7,category:"effects",key:"effect_confetti",name:"Confetti Burst",price:3e3,rarity:"common",icon:"üéä",description:"Celebrate wins with confetti"},{id:8,category:"effects",key:"effect_lightning",name:"Lightning Strike",price:8e3,rarity:"rare",icon:"‚ö°",description:"Epic win animation"}];function ws(){const{user:e,refreshUser:t}=ht(),{showToast:s,openModal:i}=lt(),[r,n]=he.useState("all"),[l,c]=he.useState(new Set),[d,x]=he.useState(!0),[m,h]=he.useState(null),u=(null==e?void 0:e.satz_balance)||0;he.useEffect(()=>{p()},[]);const p=async()=>{x(!0);try{const e=await xt.get("/api/miniapp/shop/items");if(e.success&&e.items){const t=new Set(e.items.filter(e=>e.owned).map(e=>e.id));c(t)}}catch(e){console.error("Failed to fetch shop items:",e)}finally{x(!1)}},b=ys.filter(e=>"all"===r||e.category===r);return d?a.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:a.jsx(R,{className:"w-8 h-8 animate-spin text-gold-400"})}):a.jsxs("div",{className:"pb-4",children:[a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card bg-gradient-to-r from-gold-600/20 to-gold-800/20 border-gold-500/30 p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-dark-400",children:"Your Balance"}),a.jsxs("p",{className:"text-2xl font-bold text-gradient-gold",children:[bt(u)," SATZ"]})]}),a.jsx("div",{className:"w-12 h-12 rounded-xl bg-gold-500/20 flex items-center justify-center",children:a.jsx(ie,{size:24,className:"text-gold-400"})})]})})}),a.jsx("div",{className:"px-4 mb-4",children:a.jsx("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide -mx-4 px-4",children:Ns.map(e=>{const t=e.icon;return a.jsxs("button",{onClick:()=>{Ce.hapticSelection(),n(e.id)},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-all "+(r===e.id?"bg-gold-500 text-dark-900":"bg-dark-800 text-dark-400"),children:[a.jsx(t,{size:16}),e.label]},e.id)})})}),a.jsx("div",{className:"px-4",children:a.jsx("div",{className:"grid grid-cols-2 gap-3",children:b.map((e,r)=>{const n=l.has(e.id);return a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*r},className:"card p-4 relative "+(n?"border-mint-500/30":""),children:[n&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("div",{className:"w-6 h-6 rounded-full bg-mint-500 flex items-center justify-center",children:a.jsx($,{size:14,className:"text-white"})})}),a.jsxs("div",{className:"text-center mb-3",children:[a.jsx("div",{className:"text-4xl mb-2",children:e.icon}),a.jsx("span",{className:`text-2xs font-medium px-2 py-0.5 rounded-full ${vs[e.rarity]}`,children:e.rarity})]}),a.jsx("h3",{className:"font-semibold text-white text-sm mb-1",children:e.name}),a.jsx("p",{className:"text-xs text-dark-400 mb-2 line-clamp-2",children:e.description}),e.effect&&a.jsxs("p",{className:"text-xs text-mint-400 mb-2",children:["‚ú® ",e.effect]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-bold text-gold-400",children:n?"Owned":bt(e.price)}),a.jsx(o.button,{whileTap:{scale:.95},onClick:()=>(e=>{l.has(e.id)?s("You already own this item!","info"):u<e.price?s("Insufficient SATZ balance","error"):i("confirm",{title:`Purchase ${e.name}?`,message:`This will cost ${bt(e.price)} SATZ. SATZ spent on cosmetics is permanently burned.`,confirmText:"Buy Now",confirmVariant:"gold",icon:a.jsx("div",{className:"w-16 h-16 rounded-full bg-gold-500/20 flex items-center justify-center text-3xl",children:e.icon}),onConfirm:async()=>{h(e.id),Ce.hapticImpact("medium");try{(await xt.post("/api/miniapp/shop/purchase",{itemId:e.id})).success&&(Ce.hapticNotification("success"),c(t=>new Set([...t,e.id])),s(`${e.name} purchased! üéâ`,"success"),t&&t())}catch(a){Ce.hapticNotification("error"),s(a.message||"Failed to complete purchase","error")}finally{h(null)}}})})(e),disabled:u<e.price||n||m===e.id,className:"px-3 py-1.5 rounded-lg text-xs font-medium "+(n?"bg-mint-500/20 text-mint-400":u>=e.price&&m!==e.id?"bg-gold-gradient text-dark-900":"bg-dark-700 text-dark-400"),children:m===e.id?a.jsx(R,{size:14,className:"animate-spin"}):n?"Owned":"Buy"})]})]},e.id)})})}),a.jsx("div",{className:"px-4 mt-6",children:a.jsxs("div",{className:"card p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(E,{size:16,className:"text-gold-400"}),a.jsx("span",{className:"text-sm font-medium text-white",children:"About Shop Items"})]}),a.jsx("p",{className:"text-xs text-dark-400",children:"Shop items are cosmetic customizations for your profile. Purchased SATZ is permanently burned, helping maintain token value. Some items have special effects!"})]})})]})}const ks=[{id:"booster_2x_1d",name:"2x Booster",description:"Double your earnings from predictions",multiplier:2,duration:"24 hours",durationHours:24,price:2500,icon:"‚ö°",color:"mint"},{id:"booster_3x_1d",name:"3x Booster",description:"Triple your earnings from predictions",multiplier:3,duration:"24 hours",durationHours:24,price:5e3,icon:"üöÄ",color:"gold",popular:!0},{id:"booster_5x_12h",name:"5x Mega Booster",description:"5x earnings for intense sessions",multiplier:5,duration:"12 hours",durationHours:12,price:7500,icon:"üíé",color:"purple"},{id:"booster_2x_7d",name:"2x Weekly",description:"Double earnings for a full week",multiplier:2,duration:"7 days",durationHours:168,price:15e3,icon:"üåü",color:"blue"}],Ss={mint:"from-mint-600 to-mint-800 border-mint-500/30",gold:"from-gold-600 to-gold-800 border-gold-500/30",purple:"from-purple-600 to-purple-800 border-purple-500/30",blue:"from-blue-600 to-blue-800 border-blue-500/30"};function Cs(){var e;const{user:t,refreshUser:s}=ht(),{showToast:i,openModal:r}=lt(),[n,l]=he.useState(null),[c,d]=he.useState(!0),[x,m]=he.useState(!1),[h,u]=he.useState(""),p=(null==t?void 0:t.satz_balance)||0;he.useEffect(()=>{b()},[]),he.useEffect(()=>{if(!n)return;const e=()=>{const e=new Date,t=new Date(n.expiresAt)-e;if(t<=0)return l(null),void u("");const s=Math.floor(t/36e5),a=Math.floor(t%36e5/6e4);if(s>24){const e=Math.floor(s/24);u(`${e}d ${s%24}h left`)}else u(s>0?`${s}h ${a}m left`:`${a}m left`)};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[n]);const b=async()=>{d(!0);try{const e=await xt.get("/api/miniapp/boosters/active");e.active&&e.booster?l(e.booster):l(null)}catch(e){console.error("Failed to fetch active booster:",e)}finally{d(!1)}};return c?a.jsx("div",{className:"min-h-screen bg-dark-950 flex items-center justify-center",children:a.jsx(R,{className:"w-8 h-8 animate-spin text-mint-400"})}):a.jsxs("div",{className:"pb-4",children:[n&&a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsx(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"card bg-gradient-to-r from-gold-600/30 to-gold-800/30 border-gold-500/30 p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-4xl",children:(null==(e=ks.find(e=>e.id===n.id))?void 0:e.icon)||"‚ö°"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-bold text-white",children:n.name}),a.jsx("span",{className:"badge-success",children:"Active"})]}),a.jsxs("p",{className:"text-sm text-dark-400",children:[n.multiplier,"x earnings ‚Ä¢ ",h||n.duration]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"text-2xl font-bold text-gold-400",children:[n.multiplier,"x"]})})]})})}),a.jsx("div",{className:"px-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-bold text-white",children:"Boosters"}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-2xs text-dark-400",children:"Balance"}),a.jsxs("p",{className:"font-bold text-gradient-gold",children:[bt(p)," SATZ"]})]})]})}),a.jsx("div",{className:"px-4 space-y-3",children:ks.map((e,t)=>a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:`card bg-gradient-to-r ${Ss[e.color]} p-4 relative overflow-hidden`,children:[e.popular&&a.jsx("div",{className:"absolute top-0 right-0 bg-gold-500 text-dark-900 text-2xs font-bold px-2 py-0.5 rounded-bl-lg",children:"POPULAR"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"text-4xl",children:e.icon}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-bold text-white",children:e.name}),a.jsx("p",{className:"text-sm text-white/70 mb-1",children:e.description}),a.jsxs("div",{className:"flex items-center gap-3 text-xs",children:[a.jsxs("span",{className:"flex items-center gap-1 text-white/60",children:[a.jsx(g,{size:12}),e.multiplier,"x earnings"]}),a.jsxs("span",{className:"flex items-center gap-1 text-white/60",children:[a.jsx(T,{size:12}),e.duration]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold text-white mb-1",children:bt(e.price)}),a.jsx(o.button,{whileTap:{scale:.95},onClick:()=>(e=>{p<e.price?i("Insufficient SATZ balance","error"):n?i("You already have an active booster","warning"):r("confirm",{title:`Activate ${e.name}?`,message:`${e.multiplier}x earnings for ${e.duration}. Cost: ${bt(e.price)} SATZ`,confirmText:"Activate",confirmVariant:"gold",icon:a.jsx("div",{className:"w-16 h-16 rounded-full bg-gold-500/20 flex items-center justify-center text-3xl",children:e.icon}),onConfirm:async()=>{m(!0),Ce.hapticImpact("medium");try{const t=await xt.post("/api/miniapp/boosters/activate",{boosterId:e.id});t.success&&(Ce.hapticNotification("success"),l(t.booster),i(`${e.name} activated! üöÄ`,"success"),s())}catch(t){Ce.hapticNotification("error"),i(t.message||"Failed to activate booster","error")}finally{m(!1)}}})})(e),disabled:p<e.price||n||x,className:"px-4 py-1.5 rounded-lg text-sm font-medium "+(p>=e.price&&!n&&!x?"bg-white text-dark-900":"bg-white/20 text-white/50"),children:x?a.jsx(R,{size:16,className:"animate-spin"}):n?"Active":"Activate"})]})]})]},e.id))}),a.jsxs("div",{className:"px-4 mt-6",children:[a.jsx("h3",{className:"text-lg font-bold text-white mb-3",children:"How Boosters Work"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"card p-4 flex gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-mint-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(S,{size:16,className:"text-mint-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"Multiplied Winnings"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Your prediction payouts are multiplied by the booster value"})]})]}),a.jsxs("div",{className:"card p-4 flex gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-gold-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(T,{size:16,className:"text-gold-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"Time Limited"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Boosters activate immediately and expire after the duration"})]})]}),a.jsxs("div",{className:"card p-4 flex gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center flex-shrink-0",children:a.jsx(E,{size:16,className:"text-purple-400"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-white text-sm",children:"Stack with Tier"}),a.jsx("p",{className:"text-xs text-dark-400",children:"Boosters multiply your tier bonus too!"})]})]})]})]})]})}function _s(){var e;const{user:t}=ht(),s=Ft((null==t?void 0:t.tier)||(null==t?void 0:t.status_tier)||"newcomer"),i=[{label:"Total Predictions",value:(null==t?void 0:t.predictions_made)||0,icon:r,color:"text-mint-400"},{label:"Predictions Won",value:(null==t?void 0:t.predictions_won)||0,icon:N,color:"text-gold-400"},{label:"Win Rate",value:`${parseFloat((null==t?void 0:t.win_rate)||0).toFixed(1)}%`,icon:Q,color:"text-green-400"},{label:"Current Streak",value:(null==t?void 0:t.current_streak)||0,icon:k,color:"text-orange-400"},{label:"Best Streak",value:(null==t?void 0:t.best_streak)||0,icon:X,color:"text-purple-400"},{label:"Win Streak",value:(null==t?void 0:t.current_win_streak)||0,icon:g,color:"text-blue-400"}],n=[{label:"Total Earned",value:bt((null==t?void 0:t.total_earned)||0),color:"text-green-400"},{label:"Total Spent",value:bt((null==t?void 0:t.total_spent)||0),color:"text-red-400"},{label:"Total Won",value:bt((null==t?void 0:t.total_won)||0),color:"text-gold-400"},{label:"Net Profit",value:bt(((null==t?void 0:t.total_earned)||0)-((null==t?void 0:t.total_spent)||0)),color:"text-mint-400"}],l=(null==t?void 0:t.tier_points)||0,c=[{name:"Newcomer",points:0,color:"#6b7280"},{name:"Beginner",points:100,color:"#22c55e"},{name:"Skilled",points:500,color:"#3b82f6"},{name:"Expert",points:2e3,color:"#a855f7"},{name:"Master",points:5e3,color:"#f59e0b"},{name:"Legend",points:1e4,color:"#ef4444"}],d=c.findIndex(e=>e.name.toLowerCase()===((null==t?void 0:t.tier)||(null==t?void 0:t.status_tier)||"newcomer").toLowerCase()),x=c[d+1],m=(null==(e=c[d])?void 0:e.points)||0,h=x?Math.min(100,(l-m)/(x.points-m)*100):100;return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-dark-800 rounded-xl p-4 border border-white/5",style:{borderColor:s.color+"50"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"Current Tier"}),a.jsx("h2",{className:"text-2xl font-bold",style:{color:s.color},children:s.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-2xl font-bold text-white",children:[s.multiplier,"x"]}),a.jsx("p",{className:"text-xs text-dark-400",children:"multiplier"})]})]}),x&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[a.jsxs("span",{className:"text-dark-400",children:["Progress to ",x.name]}),a.jsxs("span",{style:{color:x.color},children:[l," / ",x.points]})]}),a.jsx("div",{className:"h-2 bg-dark-700 rounded-full overflow-hidden",children:a.jsx(o.div,{initial:{width:0},animate:{width:`${h}%`},className:"h-full rounded-full",style:{backgroundColor:x.color}})})]})]})}),a.jsxs("div",{className:"px-4 mb-4",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"Performance"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:i.map((e,t)=>a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsx(e.icon,{size:20,className:`${e.color} mb-2`}),a.jsx("p",{className:"text-2xl font-bold text-white",children:e.value}),a.jsx("p",{className:"text-xs text-dark-400",children:e.label})]},e.label))})]}),a.jsxs("div",{className:"px-4",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"Earnings"}),a.jsx("div",{className:"bg-dark-800 rounded-xl border border-white/5 divide-y divide-white/5",children:n.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-4",children:[a.jsx("span",{className:"text-dark-400",children:e.label}),a.jsx("span",{className:`font-bold ${e.color}`,children:e.value})]},e.label))})]})]})}const Ts={};function zs(e,t){let s;try{s=e()}catch(a){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),i=null!=(t=s.getItem(e))?t:null;return i instanceof Promise?i.then(a):a(i)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const As=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>As(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>As(e)(s)}}},Ms=nt(((e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?("production"!==(Ts?"production":void 0)&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),((e,t)=>(s,a,i)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const l=new Set,c=new Set;let o;try{o=r.getStorage()}catch(b){}if(!o)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),s(...e)},a,i);const d=As(r.serialize),x=()=>{const e=r.partialize({...a()});let t;const s=d({state:e,version:r.version}).then(e=>o.setItem(r.name,e)).catch(e=>{t=e});if(t)throw t;return s},m=i.setState;i.setState=(e,t)=>{m(e,t),x()};const h=e((...e)=>{s(...e),x()},a,i);let u;const p=()=>{var e;if(!o)return;n=!1,l.forEach(e=>e(a()));const t=(null==(e=r.onRehydrateStorage)?void 0:e.call(r,a()))||void 0;return As(o.getItem.bind(o))(r.name).then(e=>{if(e)return r.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return e.state;if(r.migrate)return r.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(e=>{var t;return u=r.merge(e,null!=(t=a())?t:h),s(u,!0),x()}).then(()=>{null==t||t(u,void 0),n=!0,c.forEach(e=>e(u))}).catch(e=>{null==t||t(void 0,e)})};return i.persist={setOptions:e=>{r={...r,...e},e.getStorage&&(o=e.getStorage())},clearStorage:()=>{null==o||o.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>p(),hasHydrated:()=>n,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},p(),u||h})(e,t)):((e,t)=>(s,a,i)=>{let r={storage:zs(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const l=new Set,c=new Set;let o=r.storage;if(!o)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),s(...e)},a,i);const d=()=>{const e=r.partialize({...a()});return o.setItem(r.name,{state:e,version:r.version})},x=i.setState;i.setState=(e,t)=>{x(e,t),d()};const m=e((...e)=>{s(...e),d()},a,i);let h;i.getInitialState=()=>m;const u=()=>{var e,t;if(!o)return;n=!1,l.forEach(e=>{var t;return e(null!=(t=a())?t:m)});const i=(null==(t=r.onRehydrateStorage)?void 0:t.call(r,null!=(e=a())?e:m))||void 0;return As(o.getItem.bind(o))(r.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===r.version)return[!1,e.state];if(r.migrate)return[!0,r.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[i,n]=e;if(h=r.merge(n,null!=(t=a())?t:m),s(h,!0),i)return d()}).then(()=>{null==i||i(h,void 0),h=a(),n=!0,c.forEach(e=>e(h))}).catch(e=>{null==i||i(void 0,e)})};return i.persist={setOptions:e=>{r={...r,...e},e.storage&&(o=e.storage)},clearStorage:()=>{null==o||o.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>u(),hasHydrated:()=>n,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},r.skipHydration||u(),h||m})(e,t))((e,t)=>({isInitialized:!1,isAuthenticated:!1,token:null,error:null,initialize:async()=>{try{const s=Ce.initData;if(s){const t=await xt.authenticate(s);if(t.token)return xt.setToken(t.token),void e({isInitialized:!0,isAuthenticated:!0,token:t.token,error:null})}const a=t().token;if(a)return xt.setToken(a),void e({isInitialized:!0,isAuthenticated:!0});0,e({isInitialized:!0,isAuthenticated:!1})}catch(s){console.error("Auth initialization error:",s),e({isInitialized:!0,isAuthenticated:!1,error:s.message})}},setToken:t=>{xt.setToken(t),e({token:t,isAuthenticated:!!t})},logout:()=>{xt.clearToken(),e({isAuthenticated:!1,token:null})},clearError:()=>{e({error:null})}}),{name:"mintiq-auth",partialize:e=>({token:e.token})}));function Bs(){var e;const{user:t,updateUser:s}=ht(),{logout:i}=Ms(),{showToast:r,openModal:n}=lt(),[l,c]=he.useState((null==t?void 0:t.notifications_enabled)??!0),[d,x]=he.useState((null==t?void 0:t.win_broadcasts_enabled)??!0),m=[{title:"Notifications",items:[{icon:G,label:"Push Notifications",description:"Get notified about wins, streaks, and more",toggle:!0,value:l,onChange:async()=>{const e=!l;c(e),Ce.hapticImpact("light");try{await xt.updateSettings({notifications_enabled:e}),s({notifications_enabled:e}),r(e?"Notifications enabled":"Notifications disabled","success")}catch(t){c(!e),r("Failed to update settings","error")}}},{icon:ne,label:"Win Broadcasts",description:"Announce your big wins in chat",toggle:!0,value:d,onChange:async()=>{const e=!d;x(e),Ce.hapticImpact("light");try{await xt.updateSettings({win_broadcasts_enabled:e}),s({win_broadcasts_enabled:e})}catch(t){x(!e),r("Failed to update settings","error")}}}]},{title:"Support",items:[{icon:Y,label:"Help Center",description:"FAQs and guides",onClick:()=>Ce.openLink("https://mintiq.world/help")},{icon:ne,label:"Contact Support",description:"Get help from our team",onClick:()=>Ce.openTelegramLink("https://t.me/MintIQSupport")}]},{title:"Legal",items:[{icon:W,label:"Privacy Policy",onClick:()=>Ce.openLink("https://mintiq.world/privacy")},{icon:V,label:"Terms of Service",onClick:()=>Ce.openLink("https://mintiq.world/terms")}]}];return a.jsxs("div",{className:"pb-4",children:[a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-4 flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 rounded-full bg-dark-700 flex items-center justify-center text-2xl",children:(null==(e=null==t?void 0:t.first_name)?void 0:e[0])||"üë§"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h2",{className:"font-bold text-white",children:[null==t?void 0:t.first_name," ",null==t?void 0:t.last_name]}),a.jsxs("p",{className:"text-sm text-dark-400",children:["@",(null==t?void 0:t.username)||"user"]})]})]})}),m.map((e,t)=>a.jsxs("div",{className:"px-4 mb-4",children:[a.jsx("h3",{className:"text-sm text-dark-400 mb-2 px-1",children:e.title}),a.jsx("div",{className:"card divide-y divide-white/5",children:e.items.map((e,s)=>{const i=e.icon;return a.jsxs(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t+.05*s},onClick:e.toggle?void 0:e.onClick,className:"flex items-center gap-3 p-4 "+(e.onClick?"cursor-pointer hover:bg-white/5 active:bg-white/10":""),children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-dark-700 flex items-center justify-center",children:a.jsx(i,{size:20,className:"text-dark-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-white",children:e.label}),e.description&&a.jsx("p",{className:"text-sm text-dark-400",children:e.description})]}),e.toggle?a.jsx("button",{onClick:e.onChange,className:"w-12 h-7 rounded-full transition-colors "+(e.value?"bg-mint-500":"bg-dark-600"),children:a.jsx(o.div,{animate:{x:e.value?22:4},className:"w-5 h-5 rounded-full bg-white"})}):a.jsx(_,{size:20,className:"text-dark-400"})]},e.label)})})]},e.title)),a.jsxs("div",{className:"px-4 mb-4",children:[a.jsx("h3",{className:"text-sm text-dark-400 mb-2 px-1",children:"Account"}),a.jsxs("div",{className:"card divide-y divide-white/5",children:[a.jsxs("button",{onClick:()=>{n("confirm",{title:"Log Out?",message:"You will need to restart the app to log back in.",confirmText:"Log Out",confirmVariant:"danger",onConfirm:()=>{i(),Ce.close()}})},className:"w-full flex items-center gap-3 p-4 hover:bg-white/5",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-warning/20 flex items-center justify-center",children:a.jsx(J,{size:20,className:"text-warning"})}),a.jsx("span",{className:"font-medium text-warning",children:"Log Out"})]}),a.jsxs("button",{onClick:()=>{n("confirm",{title:"Delete Account?",message:"This action cannot be undone. All your data, SATZ balance, and history will be permanently deleted.",confirmText:"Delete Forever",confirmVariant:"danger",onConfirm:async()=>{r("Please contact support to delete your account","info")}})},className:"w-full flex items-center gap-3 p-4 hover:bg-white/5",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl bg-danger/20 flex items-center justify-center",children:a.jsx(te,{size:20,className:"text-danger"})}),a.jsx("span",{className:"font-medium text-danger",children:"Delete Account"})]})]})]}),a.jsxs("div",{className:"text-center py-4",children:[a.jsx("p",{className:"text-sm text-dark-500",children:"MintIQ v1.0.0"}),a.jsx("p",{className:"text-xs text-dark-600",children:"Made with ‚ù§Ô∏è for predictors"})]})]})}function Fs(){const[e]=ge(),t=e.get("task"),{tasks:s,isLoading:i,fetchTasks:r,startTask:n,verifyTask:l}=Qt(),{addBalance:c}=ht(),{showToast:o,showCelebration:d}=lt(),[x,m]=he.useState(null),[h,p]=he.useState({}),b=he.useRef({});he.useEffect(()=>{r()},[]),he.useEffect(()=>{t&&s.length>0&&!i&&setTimeout(()=>{const e=b.current[t];e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),Ce.hapticImpact("medium"))},300)},[t,s,i]);const f=s.filter(e=>!e.completed),g=s.filter(e=>e.completed);return a.jsxs("div",{className:"pb-4",children:[a.jsx("div",{className:"px-4 py-4 bg-dark-900",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-bold text-white",children:"Available Tasks"}),a.jsxs("p",{className:"text-sm text-dark-400",children:[f.length," tasks available"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-dark-400",children:"Completed"}),a.jsx("p",{className:"text-lg font-bold text-success",children:g.length})]})]})}),a.jsxs("div",{className:"px-4 py-2 space-y-3",children:[i?[...Array(3)].map((e,t)=>a.jsx("div",{className:"card p-4 animate-pulse",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-dark-700 rounded-xl"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-dark-700 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-dark-700 rounded w-1/2"})]})]})},t)):0===f.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-5xl mb-4",children:"‚úÖ"}),a.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"All caught up!"}),a.jsx("p",{className:"text-dark-400",children:"Check back later for new tasks."})]}):a.jsx(w,{children:f.map((e,s)=>a.jsx(Ps,{task:e,index:s,isProcessing:x===e.id,timer:h[e.id],onStart:()=>(async e=>{Ce.hapticImpact("light"),m(e.id);try{if(await n(e.id),"channel_join"===e.task_type)Ce.openTelegramLink(`https://t.me/${e.target_channel.replace("@","")}`);else if("website_visit"===e.task_type){Ce.openLink(e.target_url),p(t=>({...t,[e.id]:e.required_seconds||30}));const t=setInterval(()=>{p(s=>{const a=(s[e.id]||0)-1;return a<=0?(clearInterval(t),{...s,[e.id]:0}):{...s,[e.id]:a}})},1e3)}else"twitter_follow"===e.task_type&&Ce.openLink(e.target_url);setTimeout(()=>m(null),2e3)}catch(t){o(t.message||"Failed to start task","error"),m(null)}})(e),onVerify:()=>(async e=>{Ce.hapticImpact("medium"),m(e.id);try{const t=await l(e.id);t.success?(c(e.user_reward_satz),Ce.hapticNotification("success"),d("win",{amount:e.user_reward_satz}),o(`+${bt(e.user_reward_satz)} SATZ earned!`,"success")):o(t.message||"Verification failed. Please complete the task first.","warning")}catch(t){Ce.hapticNotification("error"),o(t.message||"Verification failed","error")}finally{m(null)}})(e),isHighlighted:String(e.id)===String(t),ref:t=>{b.current[e.id]=t}},e.id))}),g.length>0&&a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-sm font-medium text-dark-400 mb-3",children:"Completed"}),g.map(e=>a.jsx("div",{className:"card p-4 opacity-60 mb-2",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-success/20 flex items-center justify-center",children:a.jsx(u,{size:24,className:"text-success"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-white",children:e.name}),a.jsxs("p",{className:"text-sm text-dark-400",children:["+",bt(e.user_reward_satz)," SATZ earned"]})]})]})},e.id))]})]})]})}const Ps=he.forwardRef(function({task:e,index:t,isProcessing:s,timer:i,onStart:r,onVerify:l,isHighlighted:c},d){const x=0===i||void 0===i;return a.jsx(o.div,{ref:d,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{delay:.05*t},className:"card p-4 "+(c?"ring-2 ring-mint-500 bg-mint-500/10":""),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-mint-500/20 flex items-center justify-center text-2xl",children:(m=e.task_type,{channel_join:"üì¢",website_visit:"üåê",twitter_follow:"üê¶",bot_start:"ü§ñ",miniapp_launch:"üì±"}[m]||"üìã")}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-white mb-1",children:e.name}),a.jsx("p",{className:"text-sm text-dark-400 mb-2 line-clamp-2",children:e.description}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(n,{size:14,className:"text-gold-400"}),a.jsxs("span",{className:"text-gold-400 font-semibold",children:["+",bt(e.user_reward_satz)," SATZ"]})]})]}),a.jsx("div",{className:"flex flex-col gap-2",children:void 0!==i&&i>0?a.jsxs("div",{className:"flex items-center gap-1 text-warning",children:[a.jsx(T,{size:16}),a.jsxs("span",{className:"text-sm font-medium",children:[i,"s"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(o.button,{whileTap:{scale:.95},onClick:r,disabled:s,className:"btn-sm bg-dark-700 text-white",children:s?a.jsx(R,{size:16,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(le,{size:14}),"Start"]})}),a.jsx(o.button,{whileTap:{scale:.95},onClick:l,disabled:s||!x,className:"btn-sm bg-success text-white disabled:opacity-50",children:s?a.jsx(R,{size:16,className:"animate-spin"}):"Verify"})]})})]})});var m});function Is(){const{user:e,deductBalance:t}=ht(),{showToast:s}=lt(),[i,r]=he.useState(""),[n,l]=he.useState(""),[c,d]=he.useState(null),[h,u]=he.useState(!1),[p,b]=he.useState(!1),[f,g]=he.useState(1),j=(null==e?void 0:e.satz_balance)||0,N=Dt,v=j>=N;he.useEffect(()=>{y()},[]),he.useEffect(()=>{i&&parseInt(i)>=N&&w()},[i]);const y=async()=>{try{const e=await xt.getRedemptionInfo();d(e)}catch(e){console.error("Failed to fetch redemption info:",e),d({rate:1,minAmount:5e4,feePercent:2,estimatedTime:"24-72 hours"})}},w=async()=>{b(!0),await new Promise(e=>setTimeout(e,300)),b(!1)},k=e=>(null==c?void 0:c.rate)&&e?e:0,S=parseInt(i)||0,C=(e=>{const t=k(e);return t-Math.floor(t*((null==c?void 0:c.feePercent)||2)/100)})(S),_=C/1e8;return a.jsxs("div",{className:"pb-4",children:[a.jsx("div",{className:"px-4 pt-4 mb-4",children:a.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-dark-400",children:"Available Balance"}),a.jsxs("p",{className:"text-2xl font-bold text-gradient-gold",children:[bt(j)," SATZ"]})]}),a.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-medium "+(v?"bg-success/20 text-success":"bg-dark-700 text-dark-400"),children:v?"Eligible":"Need more SATZ"})]})})}),v?a.jsxs("div",{className:"px-4",children:[1===f&&a.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[a.jsxs("div",{className:"card p-4",children:[a.jsx("label",{className:"block text-sm text-dark-400 mb-2",children:"Amount to redeem"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",inputMode:"numeric",placeholder:`Min. ${bt(N)}`,value:i?bt(parseInt(i)):"",onChange:e=>(e=>{const t=e.replace(/\D/g,"");r(t)})(e.target.value.replace(/,/g,"")),className:"input text-2xl font-bold pr-20"}),a.jsx("button",{onClick:()=>{Ce.hapticImpact("light"),r(j.toString())},className:"absolute right-3 top-1/2 -translate-y-1/2 text-mint-400 text-sm font-medium",children:"MAX"})]})]}),S>=N&&a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"card bg-btc/10 border-btc/30 p-4",children:[a.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"You send"}),a.jsxs("p",{className:"text-xl font-bold text-white",children:[bt(S)," SATZ"]})]}),a.jsx(A,{className:"text-dark-400"}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-dark-400 mb-1",children:"You receive"}),a.jsxs("p",{className:"text-xl font-bold text-btc",children:["‚Çø ",_.toFixed(8)]})]})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Gross amount"}),a.jsxs("span",{className:"text-white",children:[k(S).toLocaleString()," satoshis"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-dark-400",children:["Network fee (",null==c?void 0:c.feePercent,"%)"]}),a.jsxs("span",{className:"text-danger",children:["-",(k(S)-C).toLocaleString()," satoshis"]})]}),a.jsx("div",{className:"h-px bg-white/10 my-2"}),a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{className:"text-white",children:"Net amount"}),a.jsxs("span",{className:"text-btc",children:[C.toLocaleString()," satoshis"]})]})]})]}),a.jsx("button",{onClick:()=>{const e=parseInt(i);!e||e<N?s(`Minimum redemption is ${bt(N)} SATZ`,"error"):e>j?s("Insufficient balance","error"):(Ce.hapticImpact("medium"),g(2))},disabled:S<N,className:"btn-primary w-full",children:"Continue"}),a.jsxs("div",{className:"flex items-start gap-2 p-3 bg-dark-800 rounded-xl",children:[a.jsx(x,{size:16,className:"text-dark-400 flex-shrink-0 mt-0.5"}),a.jsxs("p",{className:"text-xs text-dark-400",children:["Redemptions are processed within ",null==c?void 0:c.estimatedTime,". Redeemed SATZ is permanently burned."]})]})]}),2===f&&a.jsxs(o.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"space-y-4",children:[a.jsxs("div",{className:"card p-4",children:[a.jsx("label",{className:"block text-sm text-dark-400 mb-2",children:"BTC Address"}),a.jsx("input",{type:"text",placeholder:"bc1q... or 1... or 3...",value:n,onChange:e=>l(e.target.value.trim()),className:"input font-mono text-sm"}),n&&!Pt(n)&&a.jsx("p",{className:"text-danger text-sm mt-2",children:"Invalid BTC address format"})]}),a.jsxs("div",{className:"card p-4",children:[a.jsx("h4",{className:"font-medium text-white mb-3",children:"Redemption Summary"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Amount"}),a.jsxs("span",{className:"text-white",children:[bt(S)," SATZ"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"You receive"}),a.jsxs("span",{className:"text-btc font-medium",children:["‚Çø ",_.toFixed(8)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-dark-400",children:"Processing time"}),a.jsx("span",{className:"text-white",children:null==c?void 0:c.estimatedTime})]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>g(1),className:"btn-secondary flex-1",children:"Back"}),a.jsx("button",{onClick:async()=>{if(Pt(n)){u(!0),Ce.hapticImpact("medium");try{await xt.requestRedemption({amount:parseInt(i),btcAddress:n}),t(parseInt(i)),Ce.hapticNotification("success"),g(3)}catch(e){s(e.message||"Redemption failed","error")}finally{u(!1)}}else s("Please enter a valid BTC address","error")},disabled:h||!Pt(n),className:"btn-gold flex-1",children:h?a.jsx(R,{size:20,className:"animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(D,{size:18}),"Confirm Redemption"]})})]})]}),3===f&&a.jsxs(o.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"card p-6 text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-success/20 flex items-center justify-center mx-auto mb-4",children:a.jsx($,{size:32,className:"text-success"})}),a.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Redemption Submitted!"}),a.jsxs("p",{className:"text-dark-400 mb-4",children:["Your ",bt(S)," SATZ is being converted to ‚Çø ",_.toFixed(8)]}),a.jsxs("p",{className:"text-sm text-dark-500 mb-6",children:["Expected delivery: ",null==c?void 0:c.estimatedTime]}),a.jsx("button",{onClick:()=>{g(1),r(""),l("")},className:"btn-secondary",children:"Done"})]})]}):a.jsx("div",{className:"px-4",children:a.jsxs("div",{className:"card p-6 text-center",children:[a.jsx(m,{size:48,className:"mx-auto text-warning mb-4"}),a.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Not Eligible Yet"}),a.jsxs("p",{className:"text-dark-400 mb-4",children:["You need at least ",bt(N)," SATZ to redeem."]}),a.jsx("p",{className:"text-sm text-dark-500",children:"Keep earning through predictions, tasks, and referrals!"})]})})]})}const Es=e=>e>0?"text-green-400":"text-red-400";function $s(){const e=me(),[t,s]=he.useState([]),[i,l]=he.useState(!0),[c,d]=he.useState("all"),[x,m]=he.useState(!1);he.useEffect(()=>{h()},[c]);const h=async()=>{l(!0);try{const e=await xt.get(`/api/miniapp/user/transactions?limit=100&type=${c}`);s(e.transactions||[])}catch(e){console.error("Failed to fetch transactions:",e),s([])}finally{l(!1)}};return a.jsxs("div",{className:"min-h-screen bg-dark-950 pb-24",children:[a.jsx("div",{className:"bg-dark-900 border-b border-white/5 px-4 py-3 sticky top-0 z-10",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>e(-1),className:"p-2 -ml-2 text-dark-400 hover:text-white",children:a.jsx(B,{size:20})}),a.jsx("h1",{className:"text-lg font-bold text-white",children:"Transactions"})]}),a.jsx("button",{onClick:async()=>{m(!0),Ce.hapticImpact("light"),await h(),m(!1)},disabled:x,className:"p-2 text-dark-400 hover:text-white",children:a.jsx(se,{size:20,className:x?"animate-spin":""})})]})}),a.jsx("div",{className:"bg-dark-900 px-4 py-3 border-b border-white/5",children:a.jsx("div",{className:"flex bg-dark-800 rounded-xl p-1",children:[{id:"all",label:"All"},{id:"earned",label:"Earned"},{id:"spent",label:"Spent"}].map(e=>a.jsx("button",{onClick:()=>{Ce.hapticSelection(),d(e.id)},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-all "+(c===e.id?"bg-mint-500 text-white":"text-dark-400"),children:e.label},e.id))})}),a.jsx("div",{className:"p-4 space-y-3",children:i?[...Array(5)].map((e,t)=>a.jsx("div",{className:"bg-dark-800 rounded-xl p-4 animate-pulse",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-dark-700 rounded-full"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-dark-700 rounded w-1/2 mb-2"}),a.jsx("div",{className:"h-3 bg-dark-700 rounded w-1/3"})]}),a.jsx("div",{className:"h-5 bg-dark-700 rounded w-16"})]})},t)):0===t.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ae,{size:48,className:"mx-auto mb-4 text-dark-600"}),a.jsx("p",{className:"text-dark-400 font-medium",children:"No transactions"}),a.jsx("p",{className:"text-sm text-dark-500 mt-1",children:"earned"===c?"No earnings yet":"spent"===c?"No spending yet":"Your transaction history will appear here"})]}):t.map((e,t)=>{var s;const i=(l=e.type,{welcome_bonus:n,daily_login:ce,spin_reward:S,ad_reward:n,prediction_bet:r,prediction_win:N,referral_bonus:z,referral_commission:z,challenge_stake:S,challenge_win:N,friend_challenge_win:N,friend_challenge_stake:S,task_reward:n,community_bonus:z}[l]||ae);var l;const c=e.amount>0;return a.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.03*t},className:"bg-dark-800 rounded-xl p-4 border border-white/5",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center "+(d=e.amount,d>0?"bg-green-500/20":"bg-red-500/20"),children:a.jsx(i,{size:20,className:Es(e.amount)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-white capitalize",children:(null==(s=e.type)?void 0:s.replace(/_/g," "))||"Transaction"}),a.jsx("p",{className:"text-xs text-dark-400 truncate",children:e.description||Tt(e.created_at)})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:`font-bold ${Es(e.amount)}`,children:[c?"+":"",bt(e.amount)]}),a.jsx("p",{className:"text-xs text-dark-500",children:Tt(e.created_at)})]})]}),void 0!==e.balance_after&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-white/5 flex justify-between text-xs",children:[a.jsx("span",{className:"text-dark-500",children:"Balance after"}),a.jsxs("span",{className:"text-dark-400",children:[bt(e.balance_after)," SATZ"]})]})]},e.id||t);var d})})]})}function Ds(){return a.jsxs("div",{className:"fixed inset-0 bg-dark-950 flex flex-col items-center justify-center z-50",children:[a.jsx(o.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,ease:"easeOut"},className:"text-6xl mb-4",children:"ü™ô"}),a.jsx(o.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"text-3xl font-bold text-gradient mb-2",children:"MintIQ"}),a.jsx(o.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},className:"text-dark-400 text-sm",children:"Predict. Earn. Connect."}),a.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"mt-8",children:a.jsx("div",{className:"flex gap-1",children:[0,1,2].map(e=>a.jsx(o.div,{className:"w-2 h-2 bg-mint-500 rounded-full",animate:{y:[0,-8,0]},transition:{duration:.6,repeat:1/0,delay:.1*e}},e))})})]})}class Ls extends he.Component{constructor(e){super(e),s(this,"handleRetry",()=>{this.setState({hasError:!1,error:null}),window.location.reload()}),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t)}render(){return this.state.hasError?a.jsxs("div",{className:"min-h-screen bg-dark-950 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx("div",{className:"text-5xl mb-4",children:"üòµ"}),a.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Oops! Something went wrong"}),a.jsx("p",{className:"text-dark-400 mb-6 max-w-sm",children:"We're sorry, but something unexpected happened. Please try again."}),a.jsxs("button",{onClick:this.handleRetry,className:"btn-primary",children:[a.jsx(se,{size:18}),"Try Again"]}),!1]}):this.props.children}}function Rs(){const{isInitialized:e,isAuthenticated:t,initialize:s}=Ms(),{fetchUser:i}=ht();return he.useEffect(()=>{s()},[s]),he.useEffect(()=>{t&&i()},[t,i]),e?a.jsx(Ls,{children:a.jsx(w,{mode:"wait",children:a.jsxs(Ne,{children:[a.jsxs(ve,{path:"/",element:a.jsx(Ht,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(Gt,{})}),a.jsx(ve,{path:"predict",element:a.jsx(Jt,{})}),a.jsx(ve,{path:"predict/:questId",element:a.jsx(Kt,{})}),a.jsx(ve,{path:"earn",element:a.jsx(as,{})}),a.jsx(ve,{path:"earn/tasks",element:a.jsx(Fs,{})}),a.jsx(ve,{path:"premium",element:a.jsx(is,{})}),a.jsx(ve,{path:"wallet",element:a.jsx(ns,{})}),a.jsx(ve,{path:"wallet/transactions",element:a.jsx($s,{})}),a.jsx(ve,{path:"wallet/redeem",element:a.jsx(Is,{})}),a.jsx(ve,{path:"more",element:a.jsx(os,{})}),a.jsx(ve,{path:"friends",element:a.jsx(xs,{})}),a.jsx(ve,{path:"challenges",element:a.jsx(ms,{})}),a.jsx(ve,{path:"groups",element:a.jsx(us,{})}),a.jsx(ve,{path:"groups/:groupId",element:a.jsx(ps,{})}),a.jsx(ve,{path:"leaderboard",element:a.jsx(gs,{})}),a.jsx(ve,{path:"vault",element:a.jsx(js,{})}),a.jsx(ve,{path:"shop",element:a.jsx(ws,{})}),a.jsx(ve,{path:"boosters",element:a.jsx(Cs,{})}),a.jsx(ve,{path:"stats",element:a.jsx(_s,{})}),a.jsx(ve,{path:"settings",element:a.jsx(Bs,{})})]}),a.jsx(ve,{path:"*",element:a.jsx(ye,{to:"/",replace:!0})})]})})}):a.jsx(Ds,{})}if(null==(e=window.Telegram)?void 0:e.WebApp){const e=window.Telegram.WebApp;e.expand(),e.enableClosingConfirmation(),e.setHeaderColor("#0a0a0c"),e.setBackgroundColor("#0a0a0c"),e.ready(),document.body.classList.add("tg-webapp")}ke.createRoot(document.getElementById("root")).render(a.jsx(pe.StrictMode,{children:a.jsx(we,{children:a.jsx(Rs,{})})}));
